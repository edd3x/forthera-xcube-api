(this["webpackJsonpxcube-viewer"]=this["webpackJsonpxcube-viewer"]||[]).push([[0],{282:function(e){e.exports=JSON.parse('{"name":"default","server":{"id":"local","name":"Local Server","url":"http://localhost:8080"},"branding":{"appBarTitle":"xcube Viewer","windowTitle":"xcube Viewer","windowIcon":null,"compact":false,"themeName":"light","primaryColor":"blue","secondaryColor":"pink","organisationUrl":"https://xcube.readthedocs.io/","logoImage":"images/logo.png","logoWidth":32,"baseMapUrl":"https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}","defaultAgg":"mean","polygonFillOpacity":0.2,"mapProjection":"EPSG:3857","allowDownloads":true,"allowRefresh":true,"allowViewModePython":true,"allow3D":true}}')},564:function(e){e.exports=JSON.parse('{"languages":{"en":"English","de":"Deutsch","se":"Svenska"},"dictionary":[{"en":"OK","de":"OK","se":"OK"},{"en":"Cancel","de":"Abbrechen","se":"Avbryt"},{"en":"Save","de":"Speichern","se":"Spara"},{"en":"Select","de":"Ausw\xe4hlen","se":"V\xe4lj"},{"en":"Add","de":"Hinzuf\xfcgen","se":"L\xe4gg till"},{"en":"Edit","de":"Bearbeiten","se":"Redigera"},{"en":"Remove","de":"Entfernen","se":"Ta bort"},{"en":"Dataset","de":"Datensatz","se":"Dataset"},{"en":"Variable","de":"Variable","se":"Variabel"},{"en":"My places","de":"Meine Orte","se":"Mina platser"},{"en":"Loading places","de":"Lade Orte","se":"Laddar platser"},{"en":"Places","de":"Orte","se":"Platser"},{"en":"Place","de":"Ort","se":"Plats"},{"en":"Time","de":"Zeit","se":"Tid"},{"en":"Missing time axis","de":"Fehlende Zeitachse","se":"Saknar tidsaxel"},{"en":"Geometry type","de":"Geometry-Typ","se":"Geometri typ"},{"en":"Point","de":"Punkt","se":"Punkt"},{"en":"Polygon","de":"Polygon","se":"Polygon"},{"en":"Circle","de":"Kreis","se":"Cirkel"},{"en":"Multi","de":"Multi","se":"Multi"},{"en":"Something went wrong.","de":"Irgendetwas lief schief.","se":"N\xe5got gick fel."},{"en":"Time-Series","de":"Zeitserie","se":"Tidsserier"},{"en":"unknown units","de":"unbekannte Einheiten","se":"ok\xe4nda enheter"},{"en":"Values","de":"Werte","se":"V\xe4rden"},{"en":"Start","de":"Start","se":"Start"},{"en":"Stop","de":"Stopp","se":"Stopp"},{"en":"Please wait...","de":"Bitte warten...","se":"V\xe4nta ..."},{"en":"Loading data","de":"Lade Daten","se":"Laddar data"},{"en":"Connecting to server","de":"Verbindung zum Server wird hergestellt","se":"Ansluta till servern"},{"en":"Cannot reach server","de":"Kann Server nicht erreichen","se":"Kan inte n\xe5 servern"},{"en":"Language","de":"Sprache","se":"Spr\xe5k"},{"en":"Settings","de":"Einstellungen","se":"Inst\xe4llningar"},{"en":"General","de":"Allgemein","se":"Allm\xe4nhet"},{"en":"System Information","de":"Systeminformation","se":"Systeminformation"},{"en":"version","de":"Version","se":"Version"},{"en":"Server","de":"Server","se":"Server"},{"en":"Add Server","de":"Server hinzuf\xfcgen","se":"L\xe4gg till server"},{"en":"Edit Server","de":"Server bearbeiten","se":"Redigera server"},{"en":"Select Server","de":"Server ausw\xe4hlen","se":"V\xe4lj server"},{"en":"On","de":"An","se":"P\xe5"},{"en":"Off","de":"Aus","se":"Av"},{"en":"Time interval of the player","de":"Zeitintervall des Abspielers","se":"Spelarens tidsintervall"},{"en":"Show graph after adding a place","de":"Graph anzeigen, nachdem ein Ort hinzugef\xfcgt wurde","se":"Visa diagram efter att du har lagt till en plats"},{"en":"Show dots only, hide lines","de":"Nur Punkte anzeigen, Linien ausblenden","se":"Visa bara punkter, d\xf6lj linjer"},{"en":"Show error bars","de":"Fehlerbalken anzeigen","se":"Visa felstaplar"},{"en":"Show median instead of mean (disables error bars)","de":"Median statt Mittelwert anzeigen (deaktiviert Fehlerbalken)","se":"Visa median i st\xe4llet f\xf6r medelv\xe4rde (inaktiverar felf\xe4lt)"},{"en":"Minimal number of data points in a time series update","de":"Minimale Anzahl Datenpunkte in einer Zeitreihen-Aktualisierung","se":"Minimalt antal datapunkter i en tidsserieuppdatering"},{"en":"Map","de":"Karte","se":"Karta"},{"en":"Projection","de":"Projektion","se":"Projektion"},{"en":"Geographic","de":"Geografisch","se":"Geografiskt"},{"en":"Mercator","de":"Mercator","se":"Mercator"},{"en":"Image smoothing","de":"Bildgl\xe4ttung","se":"Bildutj\xe4mning"},{"en":"Show dataset boundaries","de":"Datensatzgrenzen anzeigen","se":"Visa dataupps\xe4ttningsgr\xe4nser"},{"en":"Base map","de":"Basiskarte","se":"Grundkarta"},{"en":"Hide small values","de":"Kleine Werte ausblenden","se":"D\xf6lja sm\xe5 v\xe4rden"},{"en":"Reverse","de":"Umkehren","se":"Omv\xe4nt"},{"en":"Opacity","de":"Opazit\xe4t","se":"Opacitet"},{"en":"Dataset information","de":"Informationen zum Datensatz","se":"Information om dataset"},{"en":"Variable information","de":"Informationen zur Variablen","se":"Information om variabeln"},{"en":"Place information","de":"Informationen zum Ort","se":"Platsinformation"},{"en":"Dimension names","de":"Namen der Dimensionen","se":"Dimensioner namn"},{"en":"Dimension data types","de":"Datentypen der Dimensionen","se":"Dimensionsdatatyper"},{"en":"Dimension lengths","de":"L\xe4nge der Dimensionen","se":"M\xe5ttl\xe4ngder"},{"en":"Time chunk size","de":"Zeitblockgr\xf6\xdfe","se":"Tidsblockstorlek"},{"en":"Geographical extent","de":"Geografische Ausdehnung","se":"Geografisk omfattning"},{"en":"Spatial reference system","de":"R\xe4umliches Bezugssystem","se":"Rumsligt referenssystem"},{"en":"Name","de":"Name","se":"Namn"},{"en":"Title","de":"Titel","se":"Titel"},{"en":"Units","de":"Einheiten","se":"Enheter"},{"en":"Data type","de":"Datentyp","se":"Datatyp"},{"en":"There is no information available for this location.","de":"Zu diesem Ort sind keine keine Informationen vorhanden.","se":"Det finns ingen information tillg\xe4nglig f\xf6r den h\xe4r platsen."},{"en":"Log out","de":"Abmelden","se":"Logga ut"},{"en":"Profile","de":"Profil","se":"Profil"},{"en":"User Profile","de":"Nutzerprofil","se":"Anv\xe4ndarprofil"},{"en":"User name","de":"Nutzername","se":"Anv\xe4ndarnamn"},{"en":"E-mail","de":"E-mail","se":"E-post"},{"en":"Nickname","de":"Spitzname","se":"Smeknamn"},{"en":"verified","de":"verifiziert","se":"verified"},{"en":"not verified","de":"nicht verifiziert","se":"inte verifierad"},{"en":"RGB","de":"RGB","se":"RGB"},{"en":"Imprint","de":"Impressum","se":"Avtryck"},{"en":"User Manual","de":"Benutzerhandbuch","se":"Anv\xe4ndarmanual"},{"en":"Show time-series diagram","de":"Zeitserien-Diagramm anzeigen","se":"Visa tidsseriediagram"},{"en":"Help","de":"Hilfe","se":"Hj\xe4lp"},{"en":"Export data","de":"Daten exportieren","se":"Exportera data"},{"en":"Export Settings","de":"Export-Einstellungen","se":"Exportera Inst\xe4llningar"},{"en":"Include time-series data","de":"Zeitseriendaten einschlie\xdfen","se":"Inkludera tidsseriedata"},{"en":"Include places data","de":"Ortsdaten einschlie\xdfen","se":"Inkludera platsdata"},{"en":"File name","de":"Dateiname","se":"Filnamn"},{"en":"Separator for time-series data","de":"Trennzeichen f\xfcr Zeitreihendaten","se":"Separator f\xf6r tidsseriedata"},{"en":"Combine place data in one file","de":"Ortsdaten in einer Datei zusammenfassen","se":"Kombinera platsdata i en fil"},{"en":"As ZIP archive","de":"Als ZIP-Archiv","se":"Som ett ZIP-arkiv"},{"en":"Download","de":"Herunterladen","se":"Ladda ner"},{"en":"Show selected place in map","de":"Ausgew\xe4hlten Ort in der Karte anzeigen","se":"Visa vald plats p\xe5 kartan"},{"en":"Open information panel","de":"Informationsfeld \xf6ffnen","se":"\xd6ppet informationsf\xe4lt"},{"en":"Select a place in map","de":"Ort in der Karte ausw\xe4hlen","se":"V\xe4lj plats p\xe5 kartan"},{"en":"Add a point location in map","de":"Punkt zur Karte hinzuf\xfcgen","se":"L\xe4gg till punkt p\xe5 kartan"},{"en":"Draw a polygon area in map","de":"Polygonale Fl\xe4che in der Karte zeichnen","se":"Rita en polygonal yta p\xe5 kartan"},{"en":"Draw a circular area in map","de":"Kreisf\xf6rmige Fl\xe4che in der Karte zeichnen","se":"Rita ett cirkul\xe4rt omr\xe5de p\xe5 kartan"},{"en":"Rename place","de":"Ort umbenennen","se":"Byt namn p\xe5 plats"},{"en":"Remove place","de":"Ort entfernen","se":"Ta bort plats"},{"en":"Rename place group","de":"Ortsgruppe umbenennen","se":"Byt namn p\xe5 platsgrupp"},{"en":"Remove places","de":"Orte entfernen","se":"Ta bort platser"},{"en":"Show RGB layer instead","de":"Stattdessen RGB-Layer anzeigen","se":"Visa RGB-lager ist\xe4llet"},{"en":"Auto-step through times in the dataset","de":"Zeiten im Datensatz automatisch durchlaufen","se":"K\xf6r automatiskt genom tider i dataposten"},{"en":"Select time in dataset","de":"Datensatz-Zeit ausw\xe4hlen","se":"V\xe4lj tid i dataset"},{"en":"Refresh","de":"Aktualisieren","se":"Att uppdatera"},{"en":"Accept and continue","de":"Akzeptieren und weiter","se":"Acceptera och forts\xe4tt"},{"en":"Leave","de":"Verlassen","se":"L\xe4mna"},{"en":"Import places","de":"Orte importieren","se":"Importera platser"},{"en":"Text/CSV","de":"Text/CSV","se":"Text/CSV"},{"en":"GeoJSON","de":"GeoJSON","se":"GeoJSON"},{"en":"WKT","de":"WKT","se":"WKT"},{"en":"Enter text or drag & drop a text file.","de":"Text eingeben oder Textdatei per Drag & Drop einf\xfcgen.","se":"Skriv in text eller dra och sl\xe4pp en textfil."},{"en":"From File","de":"Aus Datei","se":"Fr\xe5n fil"},{"en":"Clear","de":"L\xf6schen","se":"T\xf6mma"},{"en":"Options","de":"Optionen","se":"Alternativ"},{"en":"Time (UTC, ISO-format)","de":"Zeit (UTC, ISO-Format)","se":"Tid (UTC, ISO-format)"},{"en":"Group","de":"Gruppe","se":"Grupp"},{"en":"Label","de":"Label","se":"Etikett"},{"en":"Time property names","de":"Eigenschaftsnamen f\xfcr Zeit","se":"Gruppegendomsnamn"},{"en":"Group property names","de":"Eigenschaftsnamen f\xfcr Gruppe","se":"Gruppegendomsnamn"},{"en":"Label property names","de":"Eigenschaftsnamen f\xfcr Label","se":"Etikett egendomsnamn"},{"en":"Group prefix (used as fallback)","de":"Gruppen-Pr\xe4fix (als Fallback verwendet)","se":"Gruppprefix (anv\xe4nds som reserv)"},{"en":"Label prefix (used as fallback)","de":"Label-Pr\xe4fix (als Fallback verwendet)","se":"Etikettprefix (anv\xe4nds som reserv)"},{"en":"X/longitude column names","de":"Spaltennamen f\xfcr y/L\xe4ngengrad","se":"X/longitud kolumnnamn"},{"en":"Y/latitude column names","de":"Spaltennamen f\xfcr y/Breitengrad","se":"Y/latitud kolumnnamn"},{"en":"Geometry column names","de":"Spaltennamen f\xfcr Geometrie","se":"Geometrikolumnnamn"},{"en":"Time column names","de":"Spaltennamen f\xfcr Zeit","se":"Tidskolumnnamn"},{"en":"Group column names","de":"Spaltennamen f\xfcr Gruppe","se":"Gruppkolumnnamn"},{"en":"Label column names","de":"Spaltennamen f\xfcr Label","se":"Etikettkolumnnamn"},{"en":"Separator character","de":"Trennzeichen","se":"Skiljetecken"},{"en":"Comment character","de":"Kommentar-Zeichen","se":"Kommentar karakt\xe4r"},{"en":"Quote character","de":"Zitierzeichen","se":"Citat karakt\xe4r"},{"en":"Escape character","de":"Escape character","se":"Escape karakt\xe4r"},{"en":"Not-a-number token","de":"Token f\xfcr \'keine Zahl\'","se":"Not-a-number token"},{"en":"True token","de":"Token f\xfcr \'wahr\'","se":"Sann token"},{"en":"False token","de":"Token f\xfcr \'falsch\'","se":"Falsk token"},{"en":"Revoke consent","de":"Zustimmung widerrufen","se":"\xc5terkalla samtycke "},{"en":"Legal Agreement","de":"Rechtliches \xdcbereinkommen","se":"Laglig \xd6verenskommelse"},{"en":"Privacy Notice","de":"Datenschutzhinweis","se":"Sekretessmeddelande"},{"en":"legal/privacy-note.en.md","de":"legal/privacy-note.de.md","se":"legal/privacy-note.se.md"}]}')},568:function(e){e.exports=JSON.parse('[{"name":"OpenStreetMap","link":"https://openstreetmap.org","datasets":[{"name":"OSM Mapnik","endpoint":"https://a.tile.osm.org/{z}/{x}/{y}.png"},{"name":"OSM Humanitarian","endpoint":"https://a.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png"}],"overlays":[]},{"name":"ESRI","link":"https://services.arcgisonline.com/arcgis/rest/services","datasets":[{"name":"Dark Gray Base","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}"},{"name":"Light Gray Base","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}"},{"name":"World Hillshade","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Elevation/World_Hillshade/MapServer/tile/{z}/{y}/{x}"},{"name":"World Ocean Base","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Base/MapServer/tile/{z}/{y}/{x}"},{"name":"DeLorme World Base Map","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Specialty/DeLorme_World_Base_Map/MapServer/tile/{z}/{y}/{x}"},{"name":"World Street Map","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}"},{"name":"World Navigation Charts","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Specialty/World_Navigation_Charts/MapServer/tile/{z}/{y}/{x}"},{"name":"National Geographic","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}"},{"name":"World Imagery","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}"},{"name":"World Physical Map","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/World_Physical_Map/MapServer/tile/{z}/{y}/{x}"},{"name":"World Shaded Relief","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}"},{"name":"World Terrain","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}"},{"name":"World Topo Map","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}"}],"overlays":[{"name":"Dark Gray Reference","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Reference/MapServer/tile/{z}/{y}/{x}"},{"name":"Light Gray Reference","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}"},{"name":"World Ocean Reference","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Ocean/World_Ocean_Reference/MapServer/tile/{z}/{y}/{x}"},{"name":"World Boundaries & Places","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}"},{"name":"World Reference Overlay","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}"},{"name":"World Transportation","endpoint":"https://services.arcgisonline.com/arcgis/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}"}]},{"name":"CartoDB","link":"https://cartodb.com/basemaps/","datasets":[{"name":"Positron","endpoint":"https://a.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png"},{"name":"Dark Matter","endpoint":"https://a.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}.png"},{"name":"Positron (No Labels)","endpoint":"https://a.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png"},{"name":"Dark Matter (No Labels)","endpoint":"https://a.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}.png"}],"overlays":[{"name":"Positron Labels","endpoint":"https://a.basemaps.cartocdn.com/light_only_labels/{z}/{x}/{y}.png"},{"name":"Dark Matter Labels","endpoint":"https://a.basemaps.cartocdn.com/dark_only_labels/{z}/{x}/{y}.png"}]}]')},694:function(e,t,n){},697:function(e,t,n){},718:function(e,t){},728:function(e,t,n){},958:function(e,t,n){},959:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(99),o=n(43),c=n(432),s=n(563),l=n(631),u=(n(694),n(8)),d=n(125),p=n(4),m=n(3),f=function(){function e(t){Object(p.a)(this,e),this._languages=void 0,this._content=void 0,this._locale=void 0;var n=Object.getOwnPropertyNames(t.languages);if(n.findIndex((function(e){return"en"===e}))<0)throw new Error('Internal error: locale "en" must be included in supported languages');var a={};t.dictionary.forEach((function(e,t){n.forEach((function(n){if(!e[n])throw new Error("Internal error: invalid entry at index ".concat(t,' in "./resources/lang.json":')+' missing translation for locale: "'.concat(n,'": ').concat(e))}));var r=h(e.en);a[r]&&console.warn('Translation already defined for "'.concat(e.en,'".')),a[r]=e})),this._languages=t.languages,this._content=a,this._locale="en"}return Object(m.a)(e,[{key:"languages",get:function(){return this._languages}},{key:"locale",get:function(){return this._locale},set:function(e){var t=Object.getOwnPropertyNames(this._languages);if(t.findIndex((function(t){return t===e}))<0){var n=e.split("-")[0];if(t.findIndex((function(e){return e===n}))<0)return void console.error('No translation found for locale "'.concat(e,'", staying with "').concat(this._locale,'".'));console.warn('No translation found for locale "'.concat(e,'", falling back to "').concat(n,'".')),e=n}this._locale=e}},{key:"get",value:function(e,t){var n,a=h(e),r=this._content[a];return r?(n=r[this._locale])||(console.warn('missing translation of phrase "'.concat(e,'" for locale "').concat(this._locale,'"')),n=e):(console.warn('missing translation for phrase "'.concat(e,'"')),n=e),t&&Object.keys(t).forEach((function(e){n=n.replace("${"+e+"}","".concat(t[e]))})),n}}]),e}(),h=function(e){return e.toLowerCase()},b=new f(n(564));b.locale=(navigator.languages&&navigator.languages.length>0?navigator.languages[0]:navigator.language||navigator.userLanguage||navigator.browserLanguage||"en").split("-")[0];var v=b,g=n(9),j=n(10),O=n(159),x=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e,a){var r;return Object(p.a)(this,n),(r=t.call(this,a)).statusCode=void 0,r.statusCode=e,r}return Object(m.a)(n)}(Object(O.a)(Error));function y(e){return e?{headers:[["Authorization","Bearer ".concat(e)]]}:{}}function w(e,t){if(t.length>0){var n=t.map((function(e){return e.map(encodeURIComponent).join("=")})).join("&");return e.includes("?")?e.endsWith("&")?e+n:e+"&"+n:e+"?"+n}return e}function S(e,t){return function(e,t){return fetch(e,t).then((function(e){if(!e.ok)throw new x(e.status,e.statusText);return e})).catch((function(t){throw t instanceof TypeError?(console.error("Server did not respond for ".concat(e,". ")+"May be caused by timeout, refused connection, network error, etc.",t),new Error(v.get("Cannot reach server"))):(console.error(t),t)}))}(e,t).then((function(e){return e.json()}))}function T(e){var t=[],n={};return e.forEach((function(e){var a=e[0],r=e[1],i=[];e[2].forEach((function(e){var t=e[0],a=e[1];i.push(t),n[t]=a})),t.push({title:a,description:r,names:i})})),{groups:t,images:n}}var P=n(7),k=n(21);function E(e){return e.map(C)}function C(e){if(e.dimensions&&e.dimensions.length){var t=e.dimensions,n=t.findIndex((function(e){return"time"===e.name}));if(n>-1){var a=t[n],r=a.coordinates;if(r&&r.length&&"string"===typeof r[0]){var i=r,o=i.map((function(e){return new Date(e).getTime()}));return(t=Object(k.a)(t))[n]=Object(P.a)(Object(P.a)({},a),{},{coordinates:o,labels:i}),Object(P.a)(Object(P.a)({},e),{},{dimensions:t})}}}return e}var I=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n)}(Object(O.a)(Error));function _(e,t){!function(e,t){if(null===e)throw new I("assertion failed: ".concat(t," must not be null"))}(e,t),function(e,t){if("undefined"===typeof e)throw new I("assertion failed: ".concat(t," must not be undefined"))}(e,t)}function N(e,t){if(function(e,t){if(!Array.isArray(e))throw new I("assertion failed: ".concat(t," must be an array"))}(e,t),0===e.length)throw new I("assertion failed: ".concat(t," must be a non-empty array"))}function M(e,t){return t&&e.find((function(e){return e.id===t}))||null}function A(e,t){return t&&e.variables.find((function(e){return e.name===t}))||null}function R(e){_(e,"dataset"),N(e.dimensions,"dataset.dimensions");var t=e.dimensions.find((function(e){return"time"===e.name}));return t?(N(t.coordinates,"timeDimension.coordinates"),N(t.labels,"timeDimension.labels"),t):null}function L(e){var t=R(e);if(!t)return null;var n=t.coordinates;return[n[0],n[n.length-1]]}var D=n(320);function z(e){return(e||"")+Math.random().toString(16).substr(2)}var G=n(15),B=n(73),V=n(182),F=n(222),U=n(1055),W=n(1053),K=n(220),H=n(219),Z=n(255),Y=n(1052),q=n(221),X=n(1050),J=n(1047),Q=n(1049),$=n(282),ee=n(1044),te=n(218),ne=n(1045),ae=n(1046),re=n(1048),ie=n(565),oe=n(1051),ce=n(1054);var se=function(){var e=new URL(window.location.href),t=e.pathname.split("/"),n=t.length;return n>0?"index.html"===t[n-1]?new URL(t.slice(0,n-1).join("/"),window.location.origin):new URL(e.pathname,window.location.origin):new URL(window.location.origin)}(),le=se;function ue(e){for(var t=e,n=arguments.length,a=new Array(n>1?n-1:0),r=1;r<n;r++)a[r-1]=arguments[r];for(var i=0,o=a;i<o.length;i++){var c=o[i];""!==c&&(t.endsWith("/")?c.startsWith("/")?t+=c.substr(1):t+=c:c.startsWith("/")?t+=c:t+="/"+c)}return t}console.log("baseUrl = ",se.href);var de={amber:ee.a,blue:te.a,blueGrey:ne.a,brown:ae.a,cyan:J.a,deepOrange:re.a,deepPurple:Q.a,green:H.a,grey:ie.a,indigo:X.a,lightBlue:K.a,lightGreen:oe.a,lime:Y.a,orange:Z.a,pink:W.a,purple:q.a,red:F.a,teal:ce.a,yellow:U.a};function pe(e,t){var n=e[t],a=null;if("string"===typeof n?null!==(a=de[n]||null)||!n.startsWith("#")||7!==n.length&&9!==n.length||(a={main:n}):"object"===typeof n&&n.hasOwnProperty("main")&&(a=n),null===a)throw new Error("Value of branding.".concat(t," is invalid: ").concat(n));e[t]=a}function me(e,t){return pe(e=Object(P.a)({},e),"primaryColor"),pe(e,"secondaryColor"),function(e,t,n){var a=e[t];"string"===typeof a&&(e[t]=ue(le.href,n,a))}(e,"logoImage",t),e}var fe=new URLSearchParams(window.location.search),he=function(){function e(t,n,a,r){Object(p.a)(this,e),this.name=void 0,this.server=void 0,this.branding=void 0,this.authClient=void 0,this.name=t,this.server=n,this.branding=a,this.authClient=r}return Object(m.a)(e,null,[{key:"load",value:function(){var t=Object(V.a)(Object(B.a)().mark((function t(){var n,a,r,i,o,c,s;return Object(B.a)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=fe.get("configPath")||"config",t.next=3,this.loadRawConfig(n);case 3:return(a=t.sent)===$&&(n=""),r=a.name||"default",i=this.getAuthConfig(a),o=this.getServerConfig(a),c=0!==parseInt(fe.get("compact")||"0"),(s=me(Object(P.a)(Object(P.a)(Object(P.a)({},$.branding),a.branding),{},{compact:c||!!a.branding.compact}),n)).allow3D=!!parseInt(fe.get("allow3D")||"0")||s.allow3D,e._instance=new e(r,o,s,i),s.windowTitle&&this.changeWindowTitle(s.windowTitle),s.windowIcon&&this.changeWindowIcon(s.windowIcon),t.abrupt("return",e._instance);case 16:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"getAuthConfig",value:function(t){var n=t.authClient&&Object(P.a)({},t.authClient),a=e.getAuthClientFromEnv();return!n&&a.authority&&a.clientId&&(n={authority:a.authority,client_id:a.clientId}),n&&(a.authority&&(n=Object(P.a)(Object(P.a)({},n),{},{authority:a.authority})),a.clientId&&(n=Object(P.a)(Object(P.a)({},n),{},{client_id:a.clientId})),a.audience&&(n=Object(P.a)(Object(P.a)({},n),{},{extraQueryParams:Object(P.a)(Object(P.a)({},n.extraQueryParams),{},{audience:a.audience})}))),n}},{key:"getServerConfig",value:function(t){var n=Object(P.a)(Object(P.a)({},$.server),t.server),a=e.getApiServerFromEnv();return n.id=fe.get("serverId")||a.id||n.id,n.name=fe.get("serverName")||a.name||n.name,n.url=fe.get("serverUrl")||a.url||n.url,n}},{key:"loadRawConfig",value:function(){var e=Object(V.a)(Object(B.a)().mark((function e(t){var n,a,r,i,o;return Object(B.a)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=null,null,a=ue(le.href,t,"config.json"),e.prev=3,e.next=6,fetch(a);case 6:if(!(r=e.sent).ok){e.next=14;break}return e.next=10,r.json();case 10:n=e.sent,e.next=17;break;case 14:i=r.status,o=r.statusText,"HTTP status ".concat(i),o&&" (".concat(o,")");case 17:e.next=23;break;case 19:e.prev=19,e.t0=e.catch(3),n=null,"".concat(e.t0);case 23:return null===n&&(n=$),e.abrupt("return",n);case 25:case"end":return e.stop()}}),e,null,[[3,19]])})));return function(t){return e.apply(this,arguments)}}()},{key:"instance",get:function(){return e.assertConfigLoaded(),e._instance}},{key:"assertConfigLoaded",value:function(){if(!e._instance)throw new Error("internal error: configuration not available yet")}},{key:"changeWindowTitle",value:function(e){document.title=e}},{key:"changeWindowIcon",value:function(e){var t=document.querySelector('link[rel="icon"]');null!==t?t.href=e:((t=document.createElement("link")).rel="icon",t.href=e,document.head.appendChild(t))}},{key:"getAuthClientFromEnv",value:function(){return{authority:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_OAUTH2_AUTHORITY,clientId:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_OAUTH2_CLIENT_ID,audience:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_OAUTH2_AUDIENCE}}},{key:"getApiServerFromEnv",value:function(){return{id:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SERVER_ID,name:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SERVER_NAME,url:Object({NODE_ENV:"production",PUBLIC_URL:".",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_SERVER_URL}}}]),e}();he._instance=void 0;var be=[["red",F.a],["yellow",U.a],["pink",W.a],["lightBlue",K.a],["green",H.a],["orange",Z.a],["lime",Y.a],["purple",q.a],["indigo",X.a],["cyan",J.a],["deepPurple",Q.a]],ve=function(){var e={};return be.forEach((function(t){var n=Object(G.a)(t,2),a=n[0],r=n[1];e[a]=r})),e}(),ge=be.map((function(e){var t=Object(G.a)(e,2),n=t[0];t[1];return n}));function je(e){return ge[e%ge.length]}function Oe(e,t){var n=function(e){return"light"===e?800:400}(t);return ve[e][n]}var xe={Mapbox:{param:"access_token",token:"pk.eyJ1IjoiZm9ybWFuIiwiYSI6ImNrM2JranV0bDBtenczb2szZG84djh6bWUifQ.q0UKwf4CWt5fcQwIDwF8Bg"}};var ye="user-",we=ye+"drawing";function Se(e,t){return{type:"FeatureCollection",features:t,id:z(ye),title:e}}function Te(e,t){return{type:"Feature",geometry:(new d.a).writeGeometryObject(e),properties:t,id:z(ye)}}var Pe=Me(["label","title","name","id"]),ke=Me(["description","desc","abstract","comment"]),Ee=Me(["color"]),Ce=Me(["image","img","picture","pic"]);var Ie=Object(D.a)((function(e,t){var n={};return _e(n,e,t,"label",t.id+"",Pe),_e(n,e,t,"color",je(function(e){var t,n=e.id+"",a=0;if(0===n.length)return a;for(t=0;t<n.length;t++)a=(a<<5)-a+n.charCodeAt(t),a|=0;return a}(t)),Ee),_e(n,e,t,"image",null,Ce),_e(n,e,t,"description",null,ke),Object(P.a)({placeGroup:e,place:t},n)}));function _e(e,t,n,a,r,i){var o,c=t.propertyMapping&&t.propertyMapping[a];if(c){if(c.includes("${"))return void(e[a]=function(e,t){var n=t;if(e.properties){var a,r=Object(u.a)(Object.getOwnPropertyNames(e.properties));try{for(r.s();!(a=r.n()).done;){var i=a.value;if(!n.includes("${"))break;var o="${"+i+"}";n.includes(o)&&(n=n.replace(o,"".concat(e.properties[i])))}}catch(c){r.e(c)}finally{r.f()}}return n}(n,c));i.length>0&&i[0]!==c&&(i=[c].concat(Object(k.a)(i)))}n.properties&&(o=Ne(n.properties,i)),void 0===o&&(o=Ne(n,i)),e[a]=o||r}function Ne(e,t){var n,a=Object(u.a)(t);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r in e)return e[r]}}catch(i){a.e(i)}finally{a.f()}}function Me(e){var t,n=[],a=Object(u.a)(e);try{for(a.s();!(t=a.n()).done;){var r=t.value;n=n.concat(r.toLowerCase(),r.toUpperCase(),r[0].toUpperCase()+r.substr(1).toLowerCase())}}catch(i){a.e(i)}finally{a.f()}return n}function Ae(e,t){e.forEach((function(e){Re(e)&&e.features.forEach((function(n){t(e,n)}))}))}function Re(e){return!!e.features}function Le(e,t){if(!t||!Re(e))return null;var n=e.features.find((function(e){return e.id===t}));if(n)return n;var a=e.placeGroups;if(a)for(var r in a){var i=Le(a[r],t);if(i)return i}return null}function De(e,t){if(t){var n,a=Object(u.a)(e);try{for(a.s();!(n=a.n()).done;){var r=Le(n.value,t);if(null!==r)return r}}catch(i){a.e(i)}finally{a.f()}}return null}var ze=n(52),Ge=n(179),Be=n(166),Ve=n(175),Fe=n(150),Ue=n(130),We=n(126),Ke=n(274),He=n(0);function Ze(e){return Object(He.jsx)(a.Fragment,{children:e.children})}var Ye=n(363),qe=n(279),Xe=n(566),Je=n(433),Qe=n(141),$e=(n(696),n(697),"EPSG:4326"),et="EPSG:3857",tt=et,nt=a.createContext({mapObjects:{}}),at={width:"100%",height:"100%"},rt=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){var a;Object(p.a)(this,n),(a=t.call(this,e)).contextValue=void 0,a.clickEventsKey=null,a.handleClick=function(e){var t=a.props.onClick;t&&t(e)},a.handleDrop=function(e){if(a.props.onDropFiles){e.preventDefault();var t=[];if(e.dataTransfer.items)for(var n=0;n<e.dataTransfer.items.length;n++){var r=e.dataTransfer.items[n];if("file"===r.kind){var i=r.getAsFile();null!==i&&t.push(i)}}else if(e.dataTransfer.files)for(var o=0;o<e.dataTransfer.files.length;o++){var c=e.dataTransfer.files[o];null!==c&&t.push(c)}t.length&&a.props.onDropFiles(t)}},a.handleDragOver=function(e){a.props.onDropFiles&&e.preventDefault()},a.handleRef=function(e){a.contextValue.mapDiv=e},a.handleResize=function(){var e=a.contextValue.mapDiv,t=a.contextValue.map;if(e&&t){t.updateSize();var n=t.getView(),r=a.getMinZoom(e);r!==n.getMinZoom()&&n.setMinZoom(r)}},a.getMinZoom=function(e){var t=e.clientWidth,n=Math.LOG2E*Math.log(t/256);return n>=0?n:0};var r=e.id,i=e.mapObjects;return a.contextValue=i?{map:i[r]||void 0,mapObjects:i}:{mapObjects:{}},a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){var e=this.props.id,t=this.contextValue.mapDiv,n=null;if(this.props.isStale){var a=this.contextValue.mapObjects[e];a instanceof Je.a&&((n=a).setTarget(t),this.clickEventsKey&&n.un("click",this.clickEventsKey.listener))}if(!n){var r=this.getMinZoom(t),i=new Qe.a({projection:tt,center:[0,0],minZoom:r,zoom:r});n=new Je.a(Object(P.a)(Object(P.a)({view:i},this.getMapOptions()),{},{target:t}))}this.contextValue.map=n,this.contextValue.mapObjects[e]=n,this.clickEventsKey=n.on("click",this.handleClick),n.updateSize(),this.forceUpdate(),window.addEventListener("resize",this.handleResize);var o=this.props.onMapRef;o&&o(n)}},{key:"componentDidUpdate",value:function(e){var t=this.contextValue.map,n=this.contextValue.mapDiv,a=this.getMapOptions();t.setProperties(Object(P.a)({},a)),t.setTarget(n),t.updateSize()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize);var e=this.props.onMapRef;e&&e(null)}},{key:"render",value:function(){var e;return this.contextValue.map&&(e=Object(He.jsx)(nt.Provider,{value:this.contextValue,children:this.props.children})),Object(He.jsx)("div",{ref:this.handleRef,style:at,onDragOver:this.handleDragOver,onDrop:this.handleDrop,children:e})}},{key:"getMapOptions",value:function(){var e=Object(P.a)({},this.props);return delete e.children,delete e.onClick,delete e.onDropFiles,e}}]),n}(a.Component),it=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).context={},e.object=null,e}return Object(m.a)(n,[{key:"getMapObject",value:function(e){return this.context.mapObjects&&this.context.mapObjects[e]||null}},{key:"getOptions",value:function(){var e=Object(P.a)({},this.props);return delete e.id,e}},{key:"componentDidMount",value:function(){this._updateMapObject(this.addMapObject(this.context.map))}},{key:"componentDidUpdate",value:function(e){this._updateMapObject(this.updateMapObject(this.context.map,this.object,e))}},{key:"componentWillUnmount",value:function(){var e=this.context.map;this.removeMapObject(e,this.object),this.props.id&&delete this.context.mapObjects[this.props.id],this.object=null}},{key:"_updateMapObject",value:function(e){null!=e&&this.props.id&&(e.set("objectId",this.props.id),this.context.mapObjects[this.props.id]=e),this.object=e}},{key:"render",value:function(){return null}}]),n}(a.PureComponent);function ot(e,t,n){ct(e,t,n,"visible",!0),ct(e,t,n,"opacity",1),ct(e,t,n,"zIndex",void 0),ct(e,t,n,"minResolution",void 0),ct(e,t,n,"maxResolution",void 0)}function ct(e,t,n,a,r){var i=st(t[a],r),o=st(n[a],r);i!==o&&e.set(a,o)}function st(e,t){return void 0===e?t:e}it.contextType=nt;var lt;lt=function(){};var ut=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"addMapObject",value:function(e){var t=new Ye.a(this.props);return e.getLayers().push(t),t}},{key:"updateMapObject",value:function(e,t,n){var a=t.getSource(),r=this.props.source||null;if(a===r)return t;if(null!==r&&a!==r){var i=!0;if(a instanceof qe.a&&r instanceof qe.a){var o=a,c=r;if(function(e,t){if(e===t)return!0;if(null===e||null===t)return!1;if(lt("tile grid:",e,t),lt("min zoom:",e.getMinZoom(),t.getMinZoom()),lt("max zoom:",e.getMaxZoom(),t.getMaxZoom()),e.getMinZoom()!==t.getMinZoom()||e.getMaxZoom()!==t.getMaxZoom())return!1;var n=e.getExtent(),a=t.getExtent();lt("extent:",n,a);for(var r=0;r<n.length;r++)if(n[r]!==a[r])return!1;var i=e.getResolutions(),o=t.getResolutions();lt("resolutions:",i,o);var c=i.length;if(c!==o.length)return!1;for(var s=0;s<c;s++){var l=e.getResolution(s),u=t.getResolution(s);if(lt("resolution ".concat(s,":"),l,u),l!==u)return!1;var d=e.getOrigin(s),p=t.getOrigin(s);lt("origin ".concat(s,":"),d,p);for(var m=0;m<d.length;m++)if(d[m]!==p[m])return!1;var f=e.getTileSize(s),h=t.getTileSize(s);lt("tile size ".concat(s,":"),f,h);for(var b=0;b<d.length;b++)if("number"===typeof f&&(f=[f,f]),"number"===typeof h&&(h=[h,h]),f[0]!==h[0]||f[1]!==h[1])return!1;var v=e.getFullTileRange(s),g=t.getFullTileRange(s);if(lt("tile range ".concat(s,":"),v,g),v&&g){if(v.getWidth()!==g.getWidth()||v.getHeight()!==g.getHeight())return!1}else if(v||g)return!1}return!0}(o.getTileGrid(),c.getTileGrid())){lt("--\x3e Equal tile grids!");var s=o.getUrls(),l=c.getUrls();s===l||!l||null!==s&&s[0]===l[0]||(o.setUrls(l),i=!1);var u=o.getTileLoadFunction(),d=c.getTileLoadFunction();u!==d&&(o.setTileLoadFunction(d),i=!1);var p=o.getTileUrlFunction(),m=c.getTileUrlFunction();p!==m&&(o.setTileUrlFunction(m),i=!1)}else lt("--\x3e Tile grids are not equal!")}(null===a||void 0===a?void 0:a.getInterpolate())!==(null===r||void 0===r?void 0:r.getInterpolate())&&(i=!0),i?(t.setSource(r),lt("--\x3e Replaced source (expect flickering!)")):lt("--\x3e Updated source (check, is it still flickering?)")}return ot(t,n,this.props),t}},{key:"removeMapObject",value:function(e,t){e.getLayers().remove(t)}}]),n}(it);new Be.a({url:"https://a.tiles.mapbox.com/v3/mapbox.natural-earth-2/{z}/{x}/{y}.png",attributions:["&copy; <a href=&quot;https://www.naturalearthdata.com/&quot;>MapBox</a>","&copy; <a href=&quot;https://www.mapbox.com/&quot;>MapBox</a> and contributors"]}),new Be.a({url:"https://gis.ngdc.noaa.gov/arcgis/rest/services/web_mercator/gebco_2014_contours/MapServer/tile/{z}/{y}/{x}",attributions:["&copy; <a href=&quot;https://www.gebco.net/data_and_products/gridded_bathymetry_data/&quot;>GEBCO</a>","&copy; <a href=&quot;https://maps.ngdc.noaa.gov/&quot;>NOAHH</a> and contributors"]}),new Xe.a,new Be.a({url:"https://tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png",attributions:["&copy; <a href=&quot;https://www.openstreetmap.org/copyright&quot;>OpenStreetMap</a> contributors"]});var dt=n(200),pt=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"addMapObject",value:function(e){var t=new dt.a(this.props);return e.getLayers().push(t),t}},{key:"updateMapObject",value:function(e,t,n){return this.props.source!==n.source&&this.props.source&&t.setSource(this.props.source),ot(t,n,this.props),t}},{key:"removeMapObject",value:function(e,t){e.getLayers().remove(t)}}]),n}(it),mt=n(567),ft=n.n(mt);function ht(e,t){var n=e.length;if(0===n)return-1;if(1===n)return 0;var a=0,r=n-1;if(t<=e[a])return a;if(t>=e[r])return r;for(var i,o=Math.floor(n/2),c=0;c<n;c++){if(t<(i=e[o])){var s=[Math.floor((a+o)/2),o];o=s[0],r=s[1]}else{if(!(t>i))return o;var l=[o,Math.floor((o+r)/2)];a=l[0],o=l[1]}if(a===o||o===r)return Math.abs(e[a]-t)<=Math.abs(e[r]-t)?a:r}return-1}var bt=n(568),vt=n(6),gt=n(569);function jt(e){return 6e4*e.getTimezoneOffset()}function Ot(e){var t=new Date(e);return new Date(t.getTime()+jt(t))}function xt(e){return new Date(e).toISOString().substr(0,10)}function yt(e){return new Date(e).toISOString().substr(0,19).replace("T"," ")}var wt=31536e6;var St=function(e){return e.dataState.datasets||[]},Tt=function(e){return e.dataState.timeSeriesGroups},Pt=function(e){return e.dataState.userPlaceGroups},kt=function(e){return e.dataState.userServers||[]},Et=Object(ze.a)(St,Pt,(function(e,t){var n={},a=[];return e.forEach((function(e){e.placeGroups&&e.placeGroups.forEach((function(e){n[e.id]||(n[e.id]=e,a.push(e))}))})),[].concat(a,Object(k.a)(t))})),Ct=Object(ze.a)(Et,(function(e){var t=[];return e.forEach((function(e){var n=function(e){var t,n=null,a=e.features||[],r=Object(u.a)(a);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(i.properties){var o=i.properties.time;if("string"===typeof o){var c=Object(gt.a)(o).getTime();if(!Number.isNaN(c)){var s,l=Object(u.a)(Object.getOwnPropertyNames(i.properties));try{for(l.s();!(s=l.n()).done;){var d=s.value,p=i.properties[d],m=typeof p;if("boolean"===m?p=p?1:0:"number"!==m&&(p=Number.NaN),!Number.isNaN(p)){var f={time:c,countTot:1,mean:p};null===n&&(n={});var h=n[d];h?h.data.push(f):n[d]={source:{datasetId:e.id,datasetTitle:e.title,variableName:d,placeId:null,geometry:null,valueDataKey:"mean",errorDataKey:null},data:[f],dataProgress:1}}}}catch(b){l.e(b)}finally{l.f()}}}}}}catch(b){r.e(b)}finally{r.f()}return null===n?null:{placeGroup:e,timeSeries:n}}(e);null!==n&&t.push(n)})),t}));function It(e){return _t("localStorage",e)}function _t(e,t){try{var n=window[e],a="__storage_test__";return n.setItem(a,a),n.removeItem(a),new Nt(n,t)}catch(r){return null}}var Nt=function(){function e(t,n){Object(p.a)(this,e),this.nativeStorage=void 0,this.brandingName=void 0,this.nativeStorage=t,this.brandingName=n}return Object(m.a)(e,[{key:"getItem",value:function(e,t,n){var a=this.nativeStorage.getItem(this.makeKey(e));if(null!==a)try{return n?n(a):a}catch(r){console.error('Failed parsing user setting "'.concat(e,'": ').concat(r))}return t}},{key:"getObjectItem",value:function(e,t){return this.getItem(e,t,(function(e){return JSON.parse(e)}))}},{key:"getBooleanProperty",value:function(e,t,n){this.getProperty(e,t,n,(function(e){return"true"===e}))}},{key:"getIntProperty",value:function(e,t,n){this.getProperty(e,t,n,parseInt)}},{key:"getStringProperty",value:function(e,t,n){this.getProperty(e,t,n,(function(e){return e}))}},{key:"getObjectProperty",value:function(e,t,n){this.getProperty(e,t,n,(function(t){var a=JSON.parse(t),r=n[e],i=Object(P.a)(Object(P.a)({},r),a);return Object.getOwnPropertyNames(a).forEach((function(e){var t=r[e],n=a[e];Mt(t)&&Mt(n)&&(i[e]=Object(P.a)(Object(P.a)({},t),n))})),i}))}},{key:"getProperty",value:function(e,t,n,a){t[e]=this.getItem(e,n[e],a)}},{key:"setItem",value:function(e,t,n){if("undefined"===typeof t||null===t)this.nativeStorage.removeItem(this.makeKey(e));else{var a=n?n(t):t+"";this.nativeStorage.setItem(this.makeKey(e),a)}}},{key:"setObjectItem",value:function(e,t){this.setItem(e,t,(function(e){return JSON.stringify(e)}))}},{key:"setPrimitiveProperty",value:function(e,t){this.setItem(e,t[e])}},{key:"setObjectProperty",value:function(e,t){this.setObjectItem(e,t[e])}},{key:"makeKey",value:function(e){return"xcube.".concat(this.brandingName,".").concat(e)}}]),e}();function Mt(e){return Boolean(e)&&e.constructor===Object}function At(e){var t=It(he.instance.name);if(t)try{t.setPrimitiveProperty("locale",e),t.setPrimitiveProperty("privacyNoticeAccepted",e),t.setPrimitiveProperty("autoShowTimeSeries",e),t.setPrimitiveProperty("showTimeSeriesErrorBars",e),t.setPrimitiveProperty("showTimeSeriesPointsOnly",e),t.setPrimitiveProperty("showTimeSeriesMedian",e),t.setPrimitiveProperty("timeAnimationInterval",e),t.setPrimitiveProperty("timeChunkSize",e),t.setPrimitiveProperty("volumeCardOpen",e),t.setPrimitiveProperty("volumeRenderMode",e),t.setPrimitiveProperty("infoCardOpen",e),t.setObjectProperty("infoCardElementStates",e),t.setPrimitiveProperty("imageSmoothingEnabled",e),t.setPrimitiveProperty("mapProjection",e),t.setPrimitiveProperty("baseMapUrl",e),t.setPrimitiveProperty("userDrawnPlaceGroupName",e),t.setPrimitiveProperty("exportTimeSeries",e),t.setPrimitiveProperty("exportTimeSeriesSeparator",e),t.setPrimitiveProperty("exportPlaces",e),t.setPrimitiveProperty("exportPlacesAsCollection",e),t.setPrimitiveProperty("exportZipArchive",e),t.setPrimitiveProperty("exportFileName",e),t.setPrimitiveProperty("userPlacesFormatName",e),t.setObjectProperty("userPlacesFormatOptions",e)}catch(n){console.warn("failed to store user settings: ".concat(n))}}var Rt=n(367),Lt=n(101),Dt=["Point","LineString","Polygon","MultiPoint","MultiLineString","MultiPolygon","GeometryCollection"].map((function(e){return e.toLowerCase()}));function zt(e){if(""===(e=e.trim()))return"csv";if("{"===e[0])return"geojson";var t=e.substr(0,20).toLowerCase();return Dt.find((function(e){return t.startsWith(e)&&(t.length===e.length||"\n\t (".indexOf(t[e.length])>=0)}))?"wkt":"csv"}function Gt(e){return e.split(",").map((function(e){return e.trim().toLowerCase()})).filter((function(e){return""!==e}))}var Bt=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n)}(Object(O.a)(Error)),Vt={separator:",",comment:"#",quote:'"',escape:"\\",trim:!0,nanToken:"NaN",trueToken:"true",falseToken:"false"};function Ft(e,t){return new Ut(t).parse(e)}var Ut=function(){function e(t){Object(p.a)(this,e),this.options=void 0,this.options=Object(P.a)(Object(P.a)({},Vt),t),this.parseLine=this.parseLine.bind(this)}return Object(m.a)(e,[{key:"parse",value:function(e){return this.parseText(e).map(this.parseLine)}},{key:"parseText",value:function(e){var t=this.options,n=t.comment,a=t.trim;return e.split("\n").map((function(e,t){return a&&(e=e.trim()),[e,t]})).filter((function(e){var t=Object(G.a)(e,2),a=t[0];t[1];return""!==a.trim()&&!a.startsWith(n)}))}},{key:"parseLine",value:function(e){for(var t,n,a=Object(G.a)(e,2),r=a[0],i=a[1],o=this.options,c=o.separator,s=o.quote,l=o.escape,u=!1,d=[],p=0,m=0;m<r.length;m++){var f=r[m];f===l?m++:u?f===s&&(u=!1):f===s?u=!0:f===c&&(this.collectValue(r,p,m,d),p=m+1)}if(u)throw t="missing quote character [".concat(this.options.quote,"]"),n=p,new Bt("line ".concat(i+1,", column ").concat(n+1,": ").concat(t));return this.collectValue(r,p,m,d),d}},{key:"collectValue",value:function(e,t,n,a){var r=e.slice(t,n);a.push(this.parseToken(r))}},{key:"parseToken",value:function(e){var t=this.options;if(t.trim&&(e=e.trim()),""===e)return null;if(e.startsWith(t.quote))e=e.substring(1,e.length-1);else{if(e===t.trueToken)return!0;if(e===t.falseToken)return!1;if(e===t.nanToken)return Number.NaN;var n=Number(e);if(!Number.isNaN(n))return n}return function(e,t){var n=e.indexOf(t);if(n<0)return e;for(var a=0,r="";n<e.length;n++)e[n]===t&&(r+=e.substring(a,n)+e.substring(n+1,n+2),a=n+=2);return r+=e.substring(a,e.length),r}(e,t.escape)}}]),e}();var Wt={name:"Text/CSV",fileExt:".txt,.csv",checkError:function(e){if(""!==e.trim())try{Ft(e)}catch(t){return console.error(t),"".concat(t)}return null}},Kt=Object(P.a)(Object(P.a)({},Vt),{},{xNames:"longitude, lon, x",yNames:"latitude, lat, y",forceGeometry:!1,geometryNames:"geometry, geom",timeNames:"time, date, datetime, date-time",groupNames:"group, cruise, station, type",groupPrefix:"Group-",labelNames:"label, name, title, id",labelPrefix:"Place-"}),Ht=0,Zt=0;function Yt(e,t){var n,a=Gt(t),r=Object(u.a)(a);try{for(r.s();!(n=r.n()).done;){var i=e[n.value];if("number"===typeof i)return i}}catch(o){r.e(o)}finally{r.f()}return-1}var qt=n(129),Xt={name:"GeoJSON",fileExt:".json,.geojson",checkError:function(e){if(""!==e.trim())try{JSON.parse(e)}catch(t){return console.error(t),"".concat(t)}return null}},Jt={groupNames:"group, cruise, station, type",groupPrefix:"Group-",labelNames:"label, name, title, id",labelPrefix:"Place-",timeNames:"time, date, datetime, date-time"},Qt=0,$t=0;function en(e,t,n){if(""===n){var a,r=Object(u.a)(t);try{for(r.s();!(a=r.n()).done;){var i=a.value;if("string"===e[i])return e[i]}}catch(o){r.e(o)}finally{r.f()}}return n}var tn={name:"WKT",fileExt:".txt,.wkt",checkError:function(e){return null}},nn={group:"",groupPrefix:"Group-",label:"",labelPrefix:"Place-",time:yt((new Date).getTime())},an=0,rn=0;var on=[250,500,1e3,2500];function cn(){var e=he.instance.branding;return function(e){var t=It(he.instance.name);if(t){var n=Object(P.a)({},e);try{t.getStringProperty("locale",n,e),t.getBooleanProperty("privacyNoticeAccepted",n,e),t.getBooleanProperty("autoShowTimeSeries",n,e),t.getBooleanProperty("showTimeSeriesErrorBars",n,e),t.getBooleanProperty("showTimeSeriesPointsOnly",n,e),t.getBooleanProperty("showTimeSeriesMedian",n,e),t.getIntProperty("timeAnimationInterval",n,e),t.getIntProperty("timeChunkSize",n,e),t.getBooleanProperty("volumeCardOpen",n,e),t.getStringProperty("volumeRenderMode",n,e),t.getBooleanProperty("infoCardOpen",n,e),t.getObjectProperty("infoCardElementStates",n,e),t.getBooleanProperty("imageSmoothingEnabled",n,e),t.getStringProperty("mapProjection",n,e),t.getStringProperty("baseMapUrl",n,e),t.getStringProperty("userDrawnPlaceGroupName",n,e),t.getBooleanProperty("exportTimeSeries",n,e),t.getStringProperty("exportTimeSeriesSeparator",n,e),t.getBooleanProperty("exportPlaces",n,e),t.getBooleanProperty("exportPlacesAsCollection",n,e),t.getBooleanProperty("exportZipArchive",n,e),t.getStringProperty("exportFileName",n,e),t.getStringProperty("userPlacesFormatName",n,e),t.getObjectProperty("userPlacesFormatOptions",n,e)}catch(a){console.warn("Failed to load user settings: ".concat(a))}return n}return console.warn("User settings not found or access denied"),e}({selectedDatasetId:null,selectedVariableName:null,selectedPlaceGroupIds:[],selectedPlaceId:null,selectedUserPlaceId:null,selectedServerId:he.instance.server.id,selectedTime:null,selectedTimeRange:null,timeSeriesUpdateMode:"add",timeAnimationActive:!1,timeAnimationInterval:1e3,timeChunkSize:20,autoShowTimeSeries:!0,showTimeSeriesPointsOnly:!1,showTimeSeriesErrorBars:!0,showTimeSeriesMedian:"median"===e.defaultAgg,userDrawnPlaceGroupName:"",userPlacesFormatName:"csv",userPlacesFormatOptions:{csv:Object(P.a)({},Kt),geojson:Object(P.a)({},Jt),wkt:Object(P.a)({},nn)},flyTo:null,activities:{},locale:"en",dialogOpen:{},privacyNoticeAccepted:!1,mapInteraction:"Point",lastMapInteraction:"Point",showRgbLayer:!1,volumeCardOpen:!1,volumeRenderMode:"mip",volumeStates:{},infoCardOpen:!1,infoCardElementStates:{dataset:{visible:!0,viewMode:"text"},variable:{visible:!0,viewMode:"text"},place:{visible:!0,viewMode:"text"}},mapProjection:e.mapProjection||tt,imageSmoothingEnabled:!1,showDatasetBoundaries:!1,baseMapUrl:e.baseMapUrl||"http://a.tile.osm.org/{z}/{x}/{y}.png",exportTimeSeries:!0,exportTimeSeriesSeparator:"TAB",exportPlaces:!0,exportPlacesAsCollection:!0,exportZipArchive:!0,exportFileName:"export"})}var sn={},ln="_alpha",un="_r",dn=new Image;function pn(e){var t=e.baseName;return e.isReversed&&(t+=un),e.isAlpha&&(t+=ln),t}function mn(e,t,n){(function(e,t){return function(e,t){return new Promise((function(n,a){(t=t||new Image).onload=function(){n(t)},t.src="data:image/png;base64,".concat(e.imageData)}))}(e).then((function(n){var a=function(e,t,n){var a=document.createElement("canvas");a.width=n.width,a.height=n.height;var r=a.getContext("2d");if(null===r)return null;r.drawImage(n,0,0);var i=r.getImageData(0,0,a.width,a.height),o=i.data;if(e.isReversed){for(var c=new Uint8ClampedArray(o.length),s=0;s<o.length;s+=4){var l=o.length-s-4;c[l]=o[s],c[l+1]=o[s+1],c[l+2]=o[s+2],c[l+3]=o[s+3]}o=c}if(e.isAlpha)for(var u=512/o.length,d=0;d<o.length/2;d+=4)o[d+3]=u*d;if(t<1)for(var p=0;p<o.length;p+=4)o[p+3]*=t;return new ImageData(o,o.length/4,1)}(e,t,n);if(null!==a)return a;throw new Error("failed to retrieve 2d context")}))})(e,t).then((function(e){Promise.resolve(createImageBitmap(e)).then((function(e){var t=n.getContext("2d");if(null!==t){var a=t.createPattern(dn,"repeat");t.fillStyle=null!==a?a:"#ffffff",t.fillRect(0,0,n.width,n.height),t.drawImage(e,0,0,n.width,n.height)}}))}))}dn.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQBAMAAADt3eJSAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAGUExURcDAwP///ytph7QAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAUSURBVBjTYwABQSCglEENMxgYGAAynwRB8BEAgQAAAABJRU5ErkJggg==";var fn=function(e){return e.controlState.selectedDatasetId},hn=function(e){return e.controlState.selectedVariableName},bn=function(e){return e.controlState.selectedPlaceGroupIds},vn=function(e){return e.controlState.selectedPlaceId},gn=function(e){return e.controlState.selectedTime},jn=function(e){return e.controlState.timeAnimationActive},On=function(e){return e.controlState.imageSmoothingEnabled},xn=function(e){return e.controlState.infoCardElementStates},yn=function(e){return e.controlState.mapProjection},wn=Object(ze.a)(St,fn,M),Sn=Object(ze.a)(wn,(function(e){return e&&e.variables||[]})),Tn=Object(ze.a)(wn,hn,(function(e,t){return e&&t&&e.variables.find((function(e){return e.name===t}))||null})),Pn=Object(ze.a)(Tn,(function(e){return e&&e.units||"-"})),kn=Object(ze.a)(Tn,(function(e){return e?[e.colorBarMin,e.colorBarMax]:[0,1]})),En=Object(ze.a)(Tn,(function(e){return e&&e.colorBarName||"viridis"})),Cn=Object(ze.a)(En,(function(e){return e.dataState.colorBars}),(function(e,t){return function(e,t){var n=e,a=n.endsWith(ln);a&&(n=n.slice(0,n.length-ln.length));var r=n.endsWith(un);return r&&(n=n.slice(0,n.length-un.length)),{baseName:n,isAlpha:a,isReversed:r,imageData:t&&t.images[n]||null}}(e,t)})),In=Object(ze.a)(Tn,(function(e){return e&&"number"==typeof e.opacity?e.opacity:1})),_n=Object(ze.a)(wn,(function(e){return null!==e?L(e):null})),Nn=Object(ze.a)(wn,(function(e){return null!==e&&e.rgbSchema||null})),Mn=Object(ze.a)(wn,(function(e){return e&&e.placeGroups||[]})),An=Object(ze.a)(Mn,Pt,(function(e,t){return e.concat(t)}));function Rn(e,t){var n=[];return null!==t&&t.length>0&&e.forEach((function(e){t.indexOf(e.id)>-1&&n.push(e)})),n}var Ln=Object(ze.a)(Pt,bn,(function(e,t){var n={},a=new Set(t||[]);return e.forEach((function(e){n[e.id]=a.has(e.id)})),n})),Dn=Object(ze.a)(Mn,bn,Rn),zn=Object(ze.a)(An,bn,Rn),Gn=Object(ze.a)(zn,(function(e){return e.map((function(e){return e.title||e.id})).join(", ")})),Bn=Object(ze.a)(zn,(function(e){var t,n=e.map((function(e){return Re(e)?e.features:[]}));return(t=[]).concat.apply(t,Object(k.a)(n))})),Vn=Object(ze.a)(Bn,vn,(function(e,t){return e.find((function(e){return e.id===t}))||null})),Fn=Object(ze.a)(zn,vn,(function(e,t){return 0===e.length||null===t?null:function(e,t){var n,a=Object(u.a)(e);try{var r=function(){var e=n.value;if(Re(e)){var a=e.features.find((function(n){return t(e,n)}));if(a)return{v:Ie(e,a)}}};for(a.s();!(n=a.n()).done;){var i=r();if("object"===typeof i)return i.v}}catch(o){a.e(o)}finally{a.f()}return null}(e,(function(e,n){return n.id===t}))})),Un=Object(ze.a)(fn,hn,Vn,(function(e,t,n){if(e&&t){if(!n)return"".concat(e,"-").concat(t,"-all");if("Polygon"===n.geometry.type||"MultiPolygon"===n.geometry.type)return"".concat(e,"-").concat(t,"-").concat(n.id)}return null})),Wn=Object(ze.a)(Tt,fn,hn,vn,(function(e,t,n,a){if(!t||!n||!a)return!1;var r,i=Object(u.a)(e);try{for(i.s();!(r=i.n()).done;){var o,c=r.value,s=Object(u.a)(c.timeSeriesArray);try{for(s.s();!(o=s.n()).done;){var l=o.value.source;if(l.datasetId===t&&l.variableName===n&&l.placeId===a)return!1}}catch(d){s.e(d)}finally{s.f()}}}catch(d){i.e(d)}finally{i.f()}return!0})),Kn=Object(ze.a)(Tt,An,(function(e,t){var n={};return Ae(t,(function(t,a){var r,i=Object(u.a)(e);try{for(i.s();!(r=i.n()).done;){if(r.value.timeSeriesArray.find((function(e){return e.source.placeId===a.id}))){n[a.id]=Ie(t,a);break}}}catch(o){i.e(o)}finally{i.f()}})),n})),Hn=Object(ze.a)(zn,(function(e){var t=[];return Ae(e,(function(e,n){t.push(Ie(e,n).label)})),t})),Zn=Object(ze.a)(wn,hn,(function(e,t){return e&&A(e,t)||null})),Yn=Object(ze.a)(Zn,(function(e){return e.controlState.timeChunkSize}),(function(e,t){if(e&&e.timeChunkSize){var n=e.timeChunkSize;return n*Math.ceil(t/n)}return t})),qn=Object(ze.a)(wn,(function(e){return e&&R(e)||null})),Xn=Object(ze.a)(wn,(function(e){return e&&e.attributions||null})),Jn=Object(ze.a)(qn,(function(e){return null===e||0===e.coordinates.length?null:e.coordinates})),Qn=Object(ze.a)(gn,Jn,(function(e,t){return null===e||null===t?-1:ht(t,e)}));var $n=ft()((function(e){if(e)return function(t,n){e.getView().getInteracting()?e.once("moveend",(function(){t.getImage().src=n})):t.getImage().src=n}}),{serializer:function(e){var t=e[0];if(t){var n=t.getTarget();return"string"===typeof n?n:n&&n.id||"map"}return""}});function ea(e,t,n,a,r,i,o,c,s,l,u,d){if(null!==c){var p;if(o){var m=ht(o.coordinates,c);m>-1&&(p=o.labels[m])}p||(p=new Date(c).toISOString()),r=[].concat(Object(k.a)(r),[["time",p]])}var f=w(t,r);"number"===typeof a&&(a+=3);var h=function(e,t){if(e!==et){var n="number"===typeof t?t+1:20;return new Ke.a({tileSize:[256,256],origin:[-180,90],extent:[-180,-90,180,90],resolutions:Array.from({length:n},(function(e,t){return 180/256/Math.pow(2,t)}))})}}(l,a),b=function(e,t,n,a,r,i,o,c,s){return new Be.a({url:e,projection:t,tileGrid:n,attributions:a||void 0,transition:r?0:250,imageSmoothing:i,tileLoadFunction:o,maxZoom:s})}(f,l,h,u,s,d,function(){var e=sn.map;return $n(e)}(),0,a);return Object(He.jsx)(ut,{id:e,source:b,zIndex:10,opacity:i})}var ta=Object(ze.a)(wn,yn,(function(e){return e.controlState.showDatasetBoundaries}),(function(e,t,n){if(!e||!n)return null;var a=e.geometry;if(!a){if(!e.bbox)return console.warn("Dataset ".concat(e.id," has no bbox!")),null;var r=Object(G.a)(e.bbox,4),i=r[0],o=r[1],c=r[2],s=r[3];a={type:"Polygon",coordinates:[[[i,o],[c,o],[c,s],[i,s],[i,o]]]}}var l=new Ge.a({features:new d.a({dataProjection:$e,featureProjection:t}).readFeatures({type:"Feature",geometry:a})}),u=new We.c({stroke:new Ue.a({color:"orange",width:3,lineDash:[2,4]})});return Object(He.jsx)(pt,{id:"".concat(e.id,".bbox"),source:l,style:u,zIndex:11,opacity:.5})})),na=Object(ze.a)(kt,(function(e){return e.controlState.selectedServerId}),(function(e,t){if(0===e.length)throw new Error("internal error: no servers configured");var n=e.find((function(e){return e.id===t}));if(!n)throw new Error('internal error: server with ID "'.concat(t,'" not found'));return n})),aa=Object(ze.a)(na,fn,Zn,qn,gn,jn,yn,kn,En,In,Xn,On,(function(e,t,n,a,r,i,o,c,s,l,u,d){if(!n)return null;var p=[["crs",o],["vmin","".concat(c[0])],["vmax","".concat(c[1])],["cbar",s]];return ea("variable",ia(e.url,t,n.name),n.tileLevelMin,n.tileLevelMax,p,l,a,r,i,o,u,d)})),ra=Object(ze.a)(na,fn,(function(e){return e.controlState.showRgbLayer}),Nn,In,qn,gn,jn,yn,Xn,On,(function(e,t,n,a,r,i,o,c,s,l,u){if(!n||!a)return null;var d=[["crs",s]];return ea("rgb",ia(e.url,t,"rgb"),a.tileLevelMin,a.tileLevelMax,d,r,i,o,c,s,l,u)}));function ia(e,t,n){return e+"/tiles/"+encodeURIComponent(t)+"/"+encodeURIComponent(n)+"/{z}/{y}/{x}"}function oa(){return new Ue.a({color:[200,0,0,.75],width:1.25})}function ca(){return new Fe.a({color:[255,0,0,he.instance.branding.polygonFillOpacity||.25]})}var sa=Object(ze.a)(Dn,yn,(function(e,t){if(0===e.length)return null;var n=[];return e.forEach((function(e,a){Re(e)&&n.push(Object(He.jsx)(pt,{id:"placeGroup.".concat(e.id),style:new We.c({image:new Ve.a({fill:ca(),stroke:oa(),radius:6}),stroke:oa(),fill:ca()}),zIndex:100,source:new Ge.a({features:new d.a({dataProjection:$e,featureProjection:t}).readFeatures(e)})},a))})),Object(He.jsx)(Ze,{children:n})})),la=Object(ze.a)(xn,(function(e){var t=[];return Object.getOwnPropertyNames(e).forEach((function(n){e[n].visible&&t.push(n)})),t})),ua=Object(ze.a)(xn,(function(e){var t={};return Object.getOwnPropertyNames(e).forEach((function(n){t[n]=e[n].viewMode||"text"})),t})),da=Object(ze.a)((function(e){return e.controlState.activities}),(function(e){return Object.keys(e).map((function(t){return e[t]}))})),pa=Object(ze.a)((function(e){return e.controlState.baseMapUrl}),(function(e){var t,n=function(e){var t,n=Object(u.a)(bt);try{for(n.s();!(t=n.n()).done;){var a=t.value,r=a.datasets.find((function(t){return t.endpoint===e}));if(r)return{group:a,dataset:r}}}catch(i){n.e(i)}finally{n.f()}return null}(e);if(n){var a=(t=n.group.name,xe[t]),r=new Be.a({url:n.dataset.endpoint+(a?"?".concat(a.param,"=").concat(a.token):""),attributions:["&copy; <a href=&quot;".concat(n.group.link,"&quot;>").concat(n.group.name,"</a>")]});return Object(He.jsx)(ut,{id:n.group.name+"-"+n.dataset.name,source:r,zIndex:0})}if(e){var i=new Be.a({url:e});return Object(He.jsx)(ut,{id:e,source:i,zIndex:0})}return null}));var ma=n(570),fa=n.n(ma),ha="POST_MESSAGE";function ba(e,t){return{type:ha,messageType:e,messageText:t.message||t+""}}var va="HIDE_MESSAGE";var ga=n(29);var ja=n(703),Oa="UPDATE_SERVER_INFO";function xa(){return function(e,t){var n,a=na(t());e(kr(Oa,v.get("Connecting to server"))),(n=a.url,S("".concat(n,"/"))).then((function(t){e(function(e){return{type:Oa,serverInfo:e}}(t))})).catch((function(t){e(ba("error",t))})).then((function(){e(Cr(Oa))}))}}var ya="UPDATE_RESOURCES";function wa(){return function(e,t){var n=na(t());e(kr(ya,v.get("Updating resources"))),function(e,t){var n=w("".concat(e,"/maintenance/update"),[]),a=y(t);try{return S(n,a).then((function(){return!0})).catch((function(e){return console.error(e),!1}))}catch(r){return console.error(r),Promise.resolve(!1)}}(n.url,t().userAuthState.accessToken).then((function(e){e&&window.location.reload()})).finally((function(){return e(Cr(ya))}))}}var Sa="UPDATE_DATASETS";function Ta(){return function(e,t){var n,a,r=na(t());e(kr(Sa,v.get("Loading data"))),(n=r.url,a=t().userAuthState.accessToken,S(w("".concat(n,"/datasets"),[["details","1"]]),y(a)).then((function(e){return e.datasets})).then(E)).then((function(n){if(e(Pa(n)),n.length>0){var a=t().controlState.selectedDatasetId||n[0].id;e(Qa(a,n,!0))}})).catch((function(t){e(ba("error",t)),e(Pa([]))})).then((function(){e(Cr(Sa))}))}}function Pa(e){return{type:Sa,datasets:e}}var ka="UPDATE_DATASET_PLACE_GROUP";var Ea="ADD_DRAWN_USER_PLACE";var Ca="ADD_IMPORTED_USER_PLACES";function Ia(e){return function(t,n){var a,r=n().controlState.userPlacesFormatName;try{if("csv"===r){var i=function(e){return e.controlState.userPlacesFormatOptions.csv}(n());a=function(e,t){var n=Ft(e,t);if(n.length<2)throw new Error(v.get("Missing header line in CSV"));var a,r=Object(u.a)(n[0]);try{for(r.s();!(a=r.n()).done;){var i=a.value;if("string"!==typeof i||""===i)throw new Error(v.get("Invalid header line in CSV"))}}catch(I){r.e(I)}finally{r.f()}var o,c=n[0].map((function(e){return e})),s=c.map((function(e){return e.toLowerCase()})),l=c.length,d=Object(u.a)(n);try{for(d.s();!(o=d.n()).done;)if(o.value.length!==l)throw new Error(v.get("All rows must have same length"))}catch(I){d.e(I)}finally{d.f()}var p=function(e){for(var t={},n=0;n<e.length;n++)t[e[n].toLowerCase()]=n;return t}(s),m=Yt(p,t.groupNames),f=Yt(p,t.labelNames),h=Yt(p,t.timeNames),b=Yt(p,t.xNames),g=Yt(p,t.yNames),j=Yt(p,t.geometryNames);if(t.forceGeometry||b<0||g<0||b===g){if(j<0)throw new Error(v.get("No geometry column(s) found"))}else j=-1;var O=t.groupPrefix.trim();""===O&&(O=Kt.groupPrefix);var x=t.labelPrefix.trim();""===x&&(x=Kt.labelPrefix);var y="";if(-1===m){var w=++Ht;y="".concat(O).concat(w)}for(var S=new Rt.a,T={},P=1,k=0,E=je(0),C=function(){var t=n[P],a="";h>=0&&(a="".concat(t[h])),m>=0&&(y="".concat(t[m]));var r=T[y];r||(r=Se(y,[]),T[y]=r,E=je(k),k++);var i=null;if(j>=0){if("string"===typeof t[j])try{i=S.readGeometry(e)}catch(p){}}else{var o=t[b],s=t[g];"number"===typeof o&&Number.isFinite(o)&&"number"===typeof s&&Number.isFinite(s)&&(i=new Lt.a([o,s]))}if(null===i)throw new Error(v.get("Invalid geometry in data row ".concat(P)));var l,u={};if(t.forEach((function(e,t){if(t!==b&&t!==g&&t!==j){var n=c[t];u[n]=e}})),f>=0)l="".concat(t[f]);else{var d=++Zt;l="".concat(x).concat(d)}""!==a&&(u.time=a),u.color||(u.color=E),u.label||(u.label=l),u.source||(u.source="CSV"),r.features.push(Te(i,u))};P<n.length;P++)C();return Object.getOwnPropertyNames(T).map((function(e){return T[e]}))}(e,i)}else if("geojson"===r){var o=function(e){return e.controlState.userPlacesFormatOptions.geojson}(n());a=function(e,t){var n=Gt(t.groupNames||""),a=t.groupPrefix.trim();""===a&&(a=Jt.groupPrefix);var r=Gt(t.labelNames||""),i=t.labelPrefix.trim();""===i&&(i=Jt.labelPrefix);var o,c=Gt(t.timeNames||""),s=new d.a;try{o=s.readFeatures(e)}catch(m){try{var l=s.readGeometry(e);o=[new qt.a(l)]}catch(m){throw new Error(v.get("Invalid GeoJSON"))}}var u={},p=0;return o.forEach((function(e){var t=e.getProperties(),o=e.getGeometry();if(o){var s="",l="",d="",m=je(0);if(Boolean(t)){var f={};Object.getOwnPropertyNames(t).forEach((function(e){f[e.toLowerCase()]=t[e]})),s=en(f,c,s),d=en(f,r,d),l=en(f,n,l)}if(""===l){var h=++Qt;l="".concat(a,"-").concat(h)}if(""===d){var b=++$t;d="".concat(i,"-").concat(b)}var v=u[l];v||(v=Se(l,[]),u[l]=v,m=je(p),p++);var g=Object(P.a)({},t);""!==s&&(g.time=s),g.color||(g.color=m),g.label||(g.label=d),g.source||(g.source="GeoJSON"),v.features.push(Te(o,g))}})),Object.getOwnPropertyNames(u).map((function(e){return u[e]}))}(e,o)}else if("wkt"===r){var c=function(e){return e.controlState.userPlacesFormatOptions.wkt}(n());a=function(e,t){var n=t.groupPrefix.trim();""===n&&(n=nn.groupPrefix);var a=t.group.trim();if(""===a){var r=++an;a="".concat(n).concat(r)}var i=t.labelPrefix.trim();""===i&&(i=nn.labelPrefix);var o=t.label.trim();if(""===o){var c=++rn;o="".concat(i).concat(c)}var s=t.time.trim();try{var l=(new Rt.a).readGeometry(e),u={color:je(Math.floor(1e3*Math.random())),label:o,source:"WKT"};return""!==s&&(u=Object(P.a)({time:s},u)),[Se(a,[Te(l,u)])]}catch(d){throw new Error(v.get("Invalid Geometry WKT"))}}(e,c)}else a=[]}catch(l){t(ba("error",l)),t(Mr("addUserPlacesFromText")),a=[]}if(a.length>0){if(t(function(e,t,n){return{type:Ca,placeGroups:e,mapProjection:t,selected:n}}(a,yn(n()),!0)),1===a.length&&1===a[0].features.length)t(or(a[0].features[0].id,Bn(n()),!0)),n().controlState.autoShowTimeSeries&&t(Ra());var s=0;a.forEach((function(e){s+=e.features?e.features.length:0})),t(ba("info",v.get("Imported ".concat(s," place(s) in ").concat(a.length," groups(s), 1 selected"))))}else t(ba("warning",v.get("No places imported")))}}var _a="RENAME_USER_PLACE_GROUP";var Na="RENAME_USER_PLACE";var Ma="REMOVE_USER_PLACE";var Aa="REMOVE_USER_PLACE_GROUP";function Ra(){return function(e,t){var n=na(t()),a=wn(t()),r=qn(t()),i=Zn(t()),o=vn(t()),c=Vn(t()),s=t().controlState.timeSeriesUpdateMode,l=t().controlState.showTimeSeriesMedian,u=t().controlState.showTimeSeriesErrorBars,d=Yn(t()),p=Et(t());if(a&&i&&o&&r){var m=r.labels,f=m.length,h=f-1,b=h-(d=d>0?d:f)+1,v=function(){var e=b>=0?m[b]:null,r=m[h];return function(e,t,n,a,r,i,o,c,s,l){var u,d=null,p=[];c?(p.push(["aggMethods","median"]),u="median"):s?(p.push(["aggMethods","mean,std"]),u="mean",d="std"):(p.push(["aggMethods","mean"]),u="mean"),i&&p.push(["startDate",i]),o&&p.push(["endDate",o]);var m=encodeURIComponent(t.id),f=encodeURIComponent(n.name);return S(w("".concat(e,"/timeseries/").concat(m,"/").concat(f),p),Object(P.a)(Object(P.a)({},y(l)),{},{method:"post",body:JSON.stringify(r)})).then((function(e){if(!(e=e.result)||0===e.length)return null;var i=e.map((function(e){return Object(P.a)(Object(P.a)({},e),{},{time:new Date(e.time).getTime()})}));return{source:{datasetId:t.id,datasetTitle:t.title,variableName:n.name,variableUnits:n.units||void 0,placeId:a,geometry:r,valueDataKey:u,errorDataKey:d},data:i,color:"green"}}))}(n.url,a,i,c.id,c.geometry,e,r,l,u,t().userAuthState.accessToken)};v().then((function t(n){if(null!==n&&La(p,c.id)){var a=b>0,r=a?(f-b)/f:1;e(function(e,t,n){return{type:Da,timeSeries:e,updateMode:t,dataMode:n}}(Object(P.a)(Object(P.a)({},n),{},{dataProgress:r}),s,h===f-1?"new":"append")),a&&La(p,c.id)&&(b-=d,h-=d,v().then(t))}else e(ba("info","No data found here"))})).catch((function(t){e(ba("error",t))}))}}}function La(e,t){return null!==De(e,t)}var Da="UPDATE_TIME_SERIES";var za="ADD_PLACE_GROUP_TIME_SERIES";var Ga="REMOVE_TIME_SERIES";var Ba="REMOVE_TIME_SERIES_GROUP";var Va="REMOVE_ALL_TIME_SERIES";var Fa="CONFIGURE_SERVERS";function Ua(e,t){return{type:Fa,servers:e,selectedServerId:t}}function Wa(){return function(e){e(xa()),e(Ta()),e((function(e,t){var n,a=na(t());(n=a.url,S("".concat(n,"/colorbars")).then(T)).then((function(t){e(function(e){return{type:Ka,colorBars:e}}(t))})).catch((function(t){e(ba("error",t))}))}))}}var Ka="UPDATE_COLOR_BARS";var Ha="UPDATE_VARIABLE_COLOR_BAR";var Za="UPDATE_VARIABLE_VOLUME";var Ya=Object(m.a)((function e(){Object(p.a)(this,e)})),qa=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this)).fileName=void 0,a.zipArchive=void 0,a.fileName=e,a.zipArchive=new fa.a,a}return Object(m.a)(n,[{key:"write",value:function(e,t){this.zipArchive.file(e,t)}},{key:"close",value:function(){var e=this;this.zipArchive.generateAsync({type:"blob"}).then((function(t){return ja(t,e.fileName)}))}}]),n}(Ya),Xa=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"write",value:function(e,t){var n=new Blob([t],{type:"text/plain;charset=utf-8"});ja(n,e)}},{key:"close",value:function(){}}]),n}(Ya);var Ja="SELECT_DATASET";function Qa(e,t,n){return function(a){a(function(e,t){return{type:Ja,selectedDatasetId:e,datasets:t}}(e,t)),e&&n&&a($a(e))}}function $a(e){return function(t,n){var a=M(St(n()),e);a&&a.bbox&&t(ar(a.bbox))}}var er=["Point","LineString","LinearRing","Polygon","MultiPoint","MultiLineString","MultiPolygon","Circle"];function tr(e){return function(t,n){var a=De(zn(n()),e);a&&(a.bbox&&4===a.bbox.length?t(ar(a.bbox)):a.geometry&&er.includes(a.geometry.type)&&t(ar((new d.a).readGeometry(a.geometry))))}}var nr="FLY_TO";function ar(e){return function(t){t(function(e,t){return{type:nr,mapId:e,location:t}}("map",e)),function(e,t){if(sn[e]){var n=sn[e],a=t;if(null!==a){var r,i=n.getView().getProjection();Array.isArray(a)?(r=Object(ga.q)(a,$e,i),n.getView().fit(r,{size:n.getSize()})):"Point"===(r=a.transform($e,i)).getType()?n.getView().setCenter(r.getFirstCoordinate()):n.getView().fit(r,{size:n.getSize()})}}}("map",e)}}var rr="SELECT_PLACE_GROUPS";var ir="SELECT_PLACE";function or(e,t,n){return function(a){a(function(e,t){return{type:ir,placeId:e,places:t}}(e,t)),n&&e&&a(tr(e))}}var cr="SET_RGB_LAYER_VISIBILITY";var sr="SELECT_VARIABLE";var lr="SELECT_TIME";function ur(e){return{type:lr,selectedTime:e}}var dr="INC_SELECTED_TIME";var pr="SELECT_TIME_RANGE";function mr(e){return{type:pr,selectedTimeRange:e}}var fr="SELECT_TIME_SERIES_UPDATE_MODE";var hr="UPDATE_TIME_ANIMATION";var br="SET_MAP_INTERACTION";function vr(e){return{type:br,mapInteraction:e}}var gr="SHOW_VOLUME_CARD";function jr(e){return{type:gr,volumeCardOpen:e}}var Or="SET_VOLUME_RENDER_MODE";var xr="UPDATE_VOLUME_STATE";var yr="SHOW_INFO_CARD";function wr(e){return{type:yr,infoCardOpen:e}}var Sr="SET_VISIBLE_INFO_CARD_ELEMENTS";var Tr="UPDATE_INFO_CARD_ELEMENT_VIEW_MODE";var Pr="ADD_ACTIVITY";function kr(e,t){return{type:Pr,id:e,message:t}}var Er="REMOVE_ACTIVITY";function Cr(e){return{type:Er,id:e}}var Ir="CHANGE_LOCALE";function _r(e){return{type:Ir,locale:e}}var Nr="OPEN_DIALOG";function Mr(e){return{type:Nr,dialogId:e}}var Ar="CLOSE_DIALOG";function Rr(e){return{type:Ar,dialogId:e}}var Lr="UPDATE_SETTINGS";function Dr(e){return{type:Lr,settings:e}}var zr=n(633),Gr=n(1070),Br=n(1071),Vr=n(1092),Fr=n(1072),Ur=n(1102),Wr=n(1103),Kr=n(292),Hr=n(1096),Zr=n(634),Yr=n(1086),qr=n(1059),Xr=n(1101),Jr=n(1104),Qr=n(582),$r=n.n(Qr),ei=n(353),ti=n.n(ei),ni=n(352),ai=n.n(ni),ri=n(44),ii=n.n(ri),oi=n(342),ci=n(1085),si=n(1087),li=n(1100),ui=n(1064),di=n(1099),pi=n(1098),mi=n(1065),fi=n(430),hi=n.n(fi),bi=n(1058),vi=n(1083),gi=n(1094),ji=n(1084),Oi=n(1057),xi=n(638),yi=function(e){var t=e.userInfo;return Object(He.jsxs)(vi.a,{container:!0,justifyContent:"center",spacing:1,children:[Object(He.jsx)(vi.a,{item:!0,children:Object(He.jsx)("img",{src:t.picture,width:84,alt:v.get("User Profile")})}),Object(He.jsx)(vi.a,{item:!0,children:Object(He.jsx)(xi.a,{elevation:3,children:Object(He.jsxs)(gi.a,{children:[Object(He.jsx)(ji.a,{children:Object(He.jsx)(Oi.a,{primary:t.name,secondary:v.get("User name")})}),Object(He.jsx)(bi.a,{light:!0}),Object(He.jsx)(ji.a,{children:Object(He.jsx)(Oi.a,{primary:"".concat(t.email," (").concat(t.email_verified?v.get("verified"):v.get("not verified"),")"),secondary:v.get("E-mail")})}),Object(He.jsx)(bi.a,{light:!0}),Object(He.jsx)(ji.a,{children:Object(He.jsx)(Oi.a,{primary:t.nickname,secondary:v.get("Nickname")})})]})})})]})},wi=function(e){var t=e.classes,n=e.updateAccessToken,r=Object(oi.useAuth)(),i=a.useState(null),o=Object(G.a)(i,2),c=o[0],s=o[1],l=a.useState(!1),u=Object(G.a)(l,2),d=u[0],p=u[1];a.useEffect((function(){r.user&&r.user.access_token?n(r.user.access_token):n(null)}),[r.user,n]);var m=function(){p(!1)},f=function(){s(null)};if(r.user){var h,b=r.user.profile,g=Object(He.jsx)(hi.a,{});if(b)if(b.picture)h=Object(He.jsx)(ci.a,{className:t.imageAvatar,src:b.picture,alt:b.name});else{var j=b.given_name||b.name||b.nickname,O=b.family_name,x=null;j&&O?x=j[0]+O[0]:j?x=j[0]:O&&(x=O[0]),null!==x&&(g=x.toUpperCase()),h=Object(He.jsx)(ci.a,{className:t.letterAvatar,children:g})}else h=Object(He.jsx)(ci.a,{className:t.letterAvatar,children:"?"});return Object(He.jsxs)(a.Fragment,{children:[Object(He.jsx)(Hr.a,{onClick:function(e){s(e.currentTarget)},"aria-controls":"user-menu","aria-haspopup":"true",size:"small",className:t.iconButton,children:h}),Object(He.jsxs)(Zr.a,{id:"user-menu",anchorEl:c,keepMounted:!0,open:Boolean(c),onClose:f,children:[Object(He.jsx)(Yr.a,{onClick:function(){f(),p(!0)},children:v.get("Profile")}),Object(He.jsx)(Yr.a,{onClick:function(){f(),r.signoutRedirect().then((function(){})).catch((function(e){console.error(e)}))},children:v.get("Log out")})]}),Object(He.jsxs)(ui.a,{open:d,keepMounted:!0,onClose:m,"aria-labelledby":"alert-dialog-slide-title","aria-describedby":"alert-dialog-slide-description",children:[Object(He.jsx)(mi.a,{id:"alert-dialog-slide-title",children:v.get("User Profile")}),Object(He.jsx)(pi.a,{children:Object(He.jsx)(yi,{userInfo:r.user.profile})}),Object(He.jsx)(di.a,{children:Object(He.jsx)(si.a,{onClick:m,color:"primary",children:"OK"})})]})]})}var y=Object(He.jsx)(Hr.a,{onClick:r.isLoading?void 0:function(){r.signinRedirect().then((function(){})).catch((function(e){console.error(e)}))},size:"small",children:Object(He.jsx)(hi.a,{})});return r.isLoading&&(y=Object(He.jsxs)("div",{className:t.signInWrapper,children:[y,Object(He.jsx)(li.a,{size:24,className:t.signInProgress})]})),y},Si=Object(Xr.a)((function(e){return Object(qr.a)({imageAvatar:{width:32,height:32,color:"#fff",backgroundColor:re.a[300]},letterAvatar:{width:32,height:32,color:"#fff",backgroundColor:re.a[300]},signInWrapper:{margin:e.spacing(1),position:"relative"},signInProgress:{color:re.a[300],position:"absolute",top:"50%",left:"50%",zIndex:1,marginTop:-12,marginLeft:-12},iconButton:{padding:0}})}))((function(e){return he.instance.authClient?Object(He.jsx)(wi,Object(P.a)({},e)):null})),Ti="UPDATE_ACCESS_TOKEN";var Pi={updateAccessToken:function(e){return function(t,n){var a=n().userAuthState.accessToken;a!==e&&(t(function(e){return{type:Ti,accessToken:e}}(e)),null!==e&&null!==a||t(Ta()))}}},ki=Object(o.b)((function(e){return{}}),Pi)(Si),Ei=n(1073),Ci=n(1076),Ii=n(158),_i=n.n(Ii),Ni=n(1066),Mi=Object(Ci.a)((function(e){return Object(qr.a)({dialog:{backgroundColor:e.palette.grey[600]},appBar:{position:"relative"},title:{marginLeft:e.spacing(2),flex:1},text:{marginTop:e.spacing(4),marginLeft:e.spacing(40),marginRight:e.spacing(40)}})})),Ai=r.a.forwardRef((function(e,t){return Object(He.jsx)(Ni.a,Object(P.a)({direction:"up",ref:t},e))})),Ri=function(e){var t=e.title,n=e.href,r=e.open,i=e.onClose,o=Object(a.useState)(""),c=Object(G.a)(o,2),s=c[0],l=c[1];Object(a.useEffect)((function(){fetch(n).then((function(e){return e.text()})).then((function(e){return l(e)}))}));var u=Mi();return Object(He.jsxs)(ui.a,{fullScreen:!0,open:r,onClose:i,TransitionComponent:Ai,children:[Object(He.jsx)(Ur.a,{className:u.appBar,children:Object(He.jsxs)(Wr.a,{children:[Object(He.jsx)(Hr.a,{edge:"start",color:"inherit",onClick:i,"aria-label":"close",size:"large",children:Object(He.jsx)(_i.a,{})}),Object(He.jsx)(Kr.a,{variant:"h6",className:u.title,children:t})]})}),Object(He.jsx)(pi.a,{className:u.dialog,children:Object(He.jsx)("div",{className:u.text,children:Object(He.jsx)(Ei.a,{children:s,linkTarget:"_blank"})})})]})},Li={openDialog:Mr,updateResources:wa},Di=Object(o.b)((function(e){return{locale:e.controlState.locale,appName:he.instance.branding.appBarTitle,allowRefresh:he.instance.branding.allowRefresh}}),Li)(Object(Xr.a)((function(e){return Object(qr.a)({toolbar:{backgroundColor:he.instance.branding.headerBackgroundColor,paddingRight:e.spacing(1)},appBar:{zIndex:e.zIndex.drawer+1,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},logoAnchor:{display:"flex",alignItems:"center"},logo:{marginLeft:e.spacing(1)},title:Object(P.a)({flexGrow:1,marginLeft:e.spacing(1)},he.instance.branding.headerTitleStyle),imageAvatar:{width:24,height:24,color:"#fff",backgroundColor:re.a[300]},letterAvatar:{width:24,height:24,color:"#fff",backgroundColor:re.a[300]},signInWrapper:{margin:e.spacing(1),position:"relative"},signInProgress:{color:re.a[300],position:"absolute",top:"50%",left:"50%",zIndex:1,marginTop:-12,marginLeft:-12},iconButton:Object(P.a)({marginLeft:e.spacing(2)},he.instance.branding.headerIconStyle)})}))((function(e){var t=e.classes,n=e.appName,r=e.openDialog,i=e.allowRefresh,o=e.updateResources,c=a.useState(null),s=Object(G.a)(c,2),l=s[0],u=s[1],d=a.useState(!1),p=Object(G.a)(d,2),m=p[0],f=p[1],h=a.useState(!1),b=Object(G.a)(h,2),g=b[0],j=b[1],O=function(){u(null)};return Object(He.jsxs)(Ur.a,{position:"absolute",className:ii()(t.appBar),children:[Object(He.jsxs)(Wr.a,{disableGutters:!0,className:t.toolbar,variant:"dense",children:[Object(He.jsx)("a",{href:he.instance.branding.organisationUrl||"",target:"_blank",rel:"noreferrer",className:t.logoAnchor,children:Object(He.jsx)("img",{src:he.instance.branding.logoImage,width:he.instance.branding.logoWidth,alt:"xcube logo",className:t.logo})}),Object(He.jsx)(Kr.a,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:t.title,children:n}),Object(He.jsx)(ki,{}),i&&Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Refresh"),children:Object(He.jsx)(Hr.a,{onClick:o,size:"small",className:t.iconButton,children:Object(He.jsx)(ai.a,{})})}),Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Help"),children:Object(He.jsx)(Hr.a,{onClick:function(e){u(e.currentTarget)},size:"small",className:t.iconButton,children:Object(He.jsx)($r.a,{})})}),Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Settings"),children:Object(He.jsx)(Hr.a,{onClick:function(){r("settings")},size:"small",className:t.iconButton,children:Object(He.jsx)(ti.a,{})})})]}),Object(He.jsxs)(Zr.a,{id:"simple-menu",anchorEl:l,keepMounted:!0,open:Boolean(l),onClose:O,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:[Object(He.jsx)(Yr.a,{onClick:function(){O(),j(!0)},children:v.get("User Manual")}),Object(He.jsx)(Yr.a,{onClick:function(){O(),f(!0)},children:v.get("Imprint")})]}),Object(He.jsx)(Ri,{title:v.get("User Manual"),href:"manual.md",open:g,onClose:function(){j(!1)}}),Object(He.jsx)(Ri,{title:v.get("Imprint"),href:"imprint.md",open:m,onClose:function(){f(!1)}})]})}))),zi=Object(Xr.a)((function(e){return Object(qr.a)({form:{display:"flex",flexWrap:"wrap",paddingTop:e.spacing(1),paddingLeft:e.spacing(1),paddingRight:e.spacing(1),flexGrow:0}})}))((function(e){var t=e.classes,n=e.children;return Object(He.jsx)("form",{className:t.form,autoComplete:"off",children:n})})),Gi=n(1107),Bi=n(364),Vi=n(1077),Fi=n(1105),Ui=n(1106),Wi=Object(Xr.a)((function(e){return Object(qr.a)({formControl:{marginRight:e.spacing(1)}})}))((function(e){var t=e.classes,n=e.label,a=e.control,r=e.actions;return Object(He.jsx)(Fi.a,{variant:"standard",className:t.formControl,children:Object(He.jsxs)(Ui.a,{children:[n,a,r]})})})),Ki=Object(Xr.a)((function(e){return Object(qr.a)({formControl:{marginRight:e.spacing(2),marginBottom:e.spacing(1),minWidth:120},selectEmpty:{}})}))((function(e){var t=e.classes,n=e.selectedDatasetId,a=e.datasets,r=e.selectDataset;n=n||"",a=a||[];var i=Object(He.jsx)(Bi.a,{shrink:!0,htmlFor:"dataset-select",children:v.get("Dataset")}),o=Object(He.jsx)(Vi.a,{variant:"standard",value:n,onChange:function(e){var t=e.target.value||null;r(t,a,!0)},input:Object(He.jsx)(Gi.a,{name:"dataset",id:"dataset-select"}),displayEmpty:!0,name:"dataset",className:t.selectEmpty,children:a.map((function(e){return Object(He.jsx)(Yr.a,{value:e.id,selected:e.id===n,children:e.title},e.id)}))});return Object(He.jsx)(Wi,{label:i,control:o})})),Hi={selectDataset:Qa},Zi=Object(o.b)((function(e){return{locale:e.controlState.locale,selectedDatasetId:e.controlState.selectedDatasetId,datasets:e.dataState.datasets}}),Hi)(Ki),Yi=n(583),qi=n.n(Yi),Xi=Object(Xr.a)((function(e){return Object(qr.a)({formControl:{marginRight:e.spacing(2),marginBottom:e.spacing(1),minWidth:120},selectEmpty:{},button:{margin:e.spacing(.1)}})}))((function(e){var t=e.classes,n=e.canAddTimeSeries,a=e.selectedVariableName,r=e.variables,i=e.selectVariable,o=e.addTimeSeries;a=a||"",r=r||[];var c=Object(He.jsx)(Bi.a,{shrink:!0,htmlFor:"variable-select",children:v.get("Variable")}),s=Object(He.jsx)(Vi.a,{variant:"standard",className:t.selectEmpty,value:a,onChange:function(e){i(e.target.value||null)},input:Object(He.jsx)(Gi.a,{name:"variable",id:"variable-select"}),displayEmpty:!0,name:"variable",children:r.map((function(e){return Object(He.jsx)(Yr.a,{value:e.name,selected:e.name===a,children:e.title||e.name},e.name)}))}),l=Object(He.jsx)(Hr.a,{className:t.button,disabled:!n,onClick:function(){o()},size:"large",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Show time-series diagram"),children:Object(He.jsx)(qi.a,{})})});return Object(He.jsx)(Wi,{label:c,control:s,actions:l})})),Ji={selectVariable:function(e){return{type:sr,selectedVariableName:e}},addTimeSeries:Ra},Qi=Object(o.b)((function(e){return{locale:e.controlState.locale,selectedVariableName:e.controlState.selectedVariableName,canAddTimeSeries:Wn(e),variables:Sn(e)}}),Ji)(Xi),$i=n(1109),eo=n(1110),to=Object(Xr.a)((function(e){return Object(qr.a)({})}))((function(e){var t=e.showRgbLayer,n=e.rgbSchema,a=e.setRgbLayerVisibility;return Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Show RGB layer instead"),children:Object(He.jsx)($i.a,{label:v.get("RGB"),control:Object(He.jsx)(eo.a,{color:"primary",checked:null!==n&&t,disabled:null===n,onChange:function(e){a(e.target.checked)}})})})})),no={setRgbLayerVisibility:function(e){return{type:cr,showRgbLayer:e}}},ao=Object(o.b)((function(e){return{locale:e.controlState.locale,rgbSchema:Nn(e),showRgbLayer:e.controlState.showRgbLayer}}),no)(to),ro=n(1081),io=n(236),oo=n.n(io),co=n(237),so=n.n(co),lo=function(e){var t=e.itemValue,n=e.setItemValue,r=e.validateItemValue,i=e.editMode,o=e.setEditMode,c=e.labelText,s=e.select,l=e.actions,u=a.useRef(null),d=a.useState(""),p=Object(G.a)(d,2),m=p[0],f=p[1];a.useEffect((function(){i&&f(t)}),[i,t,f]),a.useEffect((function(){if(i){var e=u.current;null!==e&&(e.focus(),e.select())}}),[i]);var h=Object(He.jsx)(Bi.a,{shrink:!0,htmlFor:"place-select",children:c});if(!i)return Object(He.jsx)(Wi,{label:h,control:s,actions:l});var b=!r||r(m),v=Object(He.jsx)(Gi.a,{value:m,error:!b,inputRef:u,onBlur:function(){return o(!1)},onKeyUp:function(e){"Escape"===e.code?o(!1):"Enter"===e.code&&b&&(o(!1),n(m))},onChange:function(e){f(e.currentTarget.value)}});return Object(He.jsx)(Wi,{label:h,control:v})},uo=function(e){var t=e.className,n=e.disabled,a=e.onClick,r=e.icon,i=e.tooltipText,o=i?Object(He.jsx)(Jr.a,{arrow:!0,title:i,children:r}):r;return Object(He.jsx)(Hr.a,{className:t,disabled:n,onClick:a,size:"small",children:o})},po=Object(Xr.a)((function(e){return Object(qr.a)({select:{minWidth:"5em"}})}))((function(e){var t=e.classes,n=e.placeGroups,r=e.selectPlaceGroups,i=e.renameUserPlaceGroup,o=e.removeUserPlaceGroup,c=e.selectedPlaceGroupIds,s=e.selectedPlaceGroupsTitle,l=a.useState(!1),u=Object(G.a)(l,2),d=u[0],p=u[1];if(c=c||[],0===(n=n||[]).length)return null;var m,f=1===c.length?c[0]:null,h=Object(He.jsx)(Vi.a,{variant:"standard",multiple:!0,displayEmpty:!0,onChange:function(e){r(e.target.value||null)},input:Object(He.jsx)(Gi.a,{name:"place-groups",id:"place-groups-select"}),value:c,renderValue:function(){return s},name:"place-groups",className:t.select,children:n.map((function(e){return Object(He.jsxs)(Yr.a,{value:e.id,children:[Object(He.jsx)(ro.a,{checked:c.indexOf(e.id)>-1}),Object(He.jsx)(Oi.a,{primary:e.title})]},e.id)}))}),b=!1;if(null!==f&&f.startsWith(ye)&&(b=Boolean(n.find((function(e){return e.id===f&&e.features&&e.features.length>=0})))),b){m=[Object(He.jsx)(uo,{onClick:function(){p(!0)},tooltipText:v.get("Rename place group"),icon:Object(He.jsx)(oo.a,{})},"editPlaceGroup"),Object(He.jsx)(uo,{onClick:function(){o(f)},tooltipText:v.get("Remove places"),icon:Object(He.jsx)(so.a,{})},"removePlaceGroup")]}return Object(He.jsx)(lo,{itemValue:s,setItemValue:function(e){i(f,e)},validateItemValue:function(e){return e.trim().length>0},editMode:d,setEditMode:p,labelText:v.get("Places"),select:h,actions:m})})),mo={selectPlaceGroups:function(e){return function(t,n){var a=na(n());t(function(e){return{type:rr,selectedPlaceGroupIds:e}}(e));var r=wn(n()),i=Dn(n());if(null!==r&&i.length>0){var o,c=Object(u.a)(i);try{var s=function(){var e=o.value;if(!Re(e)){var i=r.id,c=e.id,s="".concat(ka,"-").concat(i,"-").concat(c);t(kr(s,v.get("Loading places"))),function(e,t,n,a){var r=y(a),i=encodeURIComponent(t),o=encodeURIComponent(n);return S("".concat(e,"/datasets/").concat(i,"/places/").concat(o),r)}(a.url,i,c,n().userAuthState.accessToken).then((function(e){t(function(e,t){return{type:ka,datasetId:e,placeGroup:t}}(r.id,e))})).catch((function(e){t(ba("error",e))})).finally((function(){t(Cr(s))}))}};for(c.s();!(o=c.n()).done;)s()}catch(l){c.e(l)}finally{c.f()}}}},renameUserPlaceGroup:function(e,t){return{type:_a,placeGroupId:e,newName:t}},removeUserPlaceGroup:function(e){return{type:Aa,placeGroupId:e}}},fo=Object(o.b)((function(e){return{locale:e.controlState.locale,selectedPlaceGroupIds:e.controlState.selectedPlaceGroupIds,placeGroups:An(e),selectedPlaceGroupsTitle:Gn(e)}}),mo)(po),ho=Object(Xr.a)((function(e){return Object(qr.a)({select:{minWidth:"5em"}})}))((function(e){var t=e.classes,n=e.selectPlace,r=e.placeLabels,i=e.selectedPlaceId,o=e.selectedPlaceGroupIds,c=e.renameUserPlace,s=e.removeUserPlace,l=e.places,u=a.useState(!1),d=Object(G.a)(u,2),p=d[0],m=d[1];l=l||[],r=r||[],i=i||"";var f,h=1===(o=o||[]).length?o[0]:null,b=l.findIndex((function(e){return e.id===i})),g=b>=0?r[b]:"",j=Object(He.jsx)(Vi.a,{variant:"standard",value:i,onChange:function(e){n(e.target.value||null,l,!0)},input:Object(He.jsx)(Gi.a,{name:"place",id:"place-select"}),displayEmpty:!0,name:"place",className:t.select,disabled:0===l.length,children:l.map((function(e,t){return Object(He.jsx)(Yr.a,{value:e.id,selected:e.id===i,children:r[t]},e.id)}))}),O=null!==h&&h.startsWith(ye)&&""!==i;if(!p&&O){f=[Object(He.jsx)(uo,{onClick:function(){m(!0)},tooltipText:v.get("Rename place"),icon:Object(He.jsx)(oo.a,{})},"editButton"),Object(He.jsx)(uo,{onClick:function(){s(h,i,l)},tooltipText:v.get("Remove place"),icon:Object(He.jsx)(so.a,{})},"removeButton")]}return Object(He.jsx)(lo,{itemValue:g,setItemValue:function(e){c(h,i,e)},validateItemValue:function(e){return e.trim().length>0},editMode:p,setEditMode:m,labelText:v.get("Place"),select:j,actions:f})})),bo={selectPlace:or,renameUserPlace:function(e,t,n){return function(a){a(function(e,t,n){return{type:Na,placeGroupId:e,placeId:t,newName:n}}(e,t,n)),function(e,t,n){sn[e]}(e)}},removeUserPlace:function(e,t,n){return{type:Ma,placeGroupId:e,placeId:t,places:n}},openDialog:Mr},vo=Object(o.b)((function(e){return{locale:e.controlState.locale,datasets:e.dataState.datasets,userPlaceGroups:e.dataState.userPlaceGroups,selectedPlaceGroupIds:e.controlState.selectedPlaceGroupIds,selectedPlaceId:e.controlState.selectedPlaceId,places:Bn(e),placeLabels:Hn(e)}}),bo)(ho),go=n(585),jo=n.n(go),Oo=n(586),xo=n.n(Oo),yo=n(584),wo=n.n(yo),So=n(587),To=n.n(So),Po=n(588),ko=n.n(Po),Eo=n(1111),Co=n(1089),Io=Object(Ci.a)((function(e){return{formControl:{marginTop:e.spacing(1),marginLeft:e.spacing(1),marginRight:e.spacing(2)}}}));var _o={setMapInteraction:vr},No=Object(o.b)((function(e){return{mapInteraction:e.controlState.mapInteraction}}),_o)((function(e){var t=e.mapInteraction,n=e.setMapInteraction,a=Io();return Object(He.jsx)(Fi.a,{variant:"standard",className:a.formControl,children:Object(He.jsxs)(Co.a,{size:"small",value:t,exclusive:!0,onChange:function(e,t){n(null!==t?t:"Select")},children:[Object(He.jsx)(Eo.a,{value:"Select",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Select a place in map"),children:Object(He.jsx)(wo.a,{})})},0),Object(He.jsx)(Eo.a,{value:"Point",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Add a point location in map"),children:Object(He.jsx)(jo.a,{})})},1),Object(He.jsx)(Eo.a,{value:"Polygon",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Draw a polygon area in map"),children:Object(He.jsx)(xo.a,{})})},2),Object(He.jsx)(Eo.a,{value:"Circle",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Draw a circular area in map"),children:Object(He.jsx)(To.a,{})})},3),Object(He.jsx)(Eo.a,{value:"Geometry",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Import places"),children:Object(He.jsx)(ko.a,{})})},4)]})})})),Mo=n(1112),Ao=n(635),Ro=n(632),Lo=n(1074),Do=Object(Xr.a)((function(e){return Object(qr.a)({dateTimePicker:{marginTop:e.spacing(2)}})}))((function(e){var t,n,a=e.classes,r=e.hasTimeDimension,i=e.selectedTime,o=e.selectedTimeRange,c=e.selectTime,s=Object(He.jsx)(Bi.a,{shrink:!0,htmlFor:"time-select",children:"".concat(v.get("Time")," (UTC)")}),l="number"===typeof i?Ot(i):null;Array.isArray(o)&&(t=Ot(o[0]),n=Ot(o[1]));var u=Object(He.jsx)(Ao.a,{dateAdapter:Ro.a,children:Object(He.jsx)(Lo.a,{disabled:!r,variant:"inline",emptyLabel:r?void 0:v.get("Missing time axis"),className:a.dateTimePicker,inputFormat:"yyyy-MM-dd hh:mm:ss",id:"time-select",value:l,minDateTime:t,maxDateTime:n,onChange:function(e){var t;c(null!==e?(t=e).getTime()-jt(t):null)},ampm:!1,renderInput:function(e){return Object(He.jsx)(Mo.a,Object(P.a)(Object(P.a)({},e),{},{variant:"standard",size:"small"}))}})});return Object(He.jsx)(Wi,{label:s,control:u})})),zo={selectTime:ur},Go=Object(o.b)((function(e){return{locale:e.controlState.locale,hasTimeDimension:!!qn(e),selectedTime:e.controlState.selectedTime,selectedTimeRange:e.controlState.selectedTimeRange}}),zo)(Do),Bo=n(1078),Vo=Object(Xr.a)((function(e){return Object(qr.a)({box:{marginTop:e.spacing(1),marginLeft:e.spacing(5),marginRight:e.spacing(5),minWidth:200},label:{color:"grey",fontSize:"1em"}})}))((function(e){var t=e.classes,n=e.hasTimeDimension,r=e.selectedTime,i=e.selectTime,o=e.selectedTimeRange,c=Object(a.useState)(r),s=Object(G.a)(c,2),l=s[0],u=s[1];if(Object(a.useEffect)((function(){u(r||(o?o[0]:0))}),[r,o]),!n)return null;var d=Array.isArray(o);d||(o=[Date.now()-2*wt,Date.now()]);var p=[{value:o[0],label:xt(o[0])},{value:o[1],label:xt(o[1])}];return Object(He.jsx)(Ui.a,{className:t.box,children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Select time in dataset"),children:Object(He.jsx)(Bo.a,{disabled:!d,min:o[0],max:o[1],value:l||0,valueLabelDisplay:"off",valueLabelFormat:function(e){return yt(e)},marks:p,onChange:function(e,t){"number"===typeof t&&u(t)},onChangeCommitted:function(e,t){i&&"number"===typeof t&&i(t)},size:"small"})})})})),Fo={selectTime:ur,selectTimeRange:mr},Uo=Object(o.b)((function(e){return{locale:e.controlState.locale,hasTimeDimension:!!qn(e),selectedTime:e.controlState.selectedTime,selectedTimeRange:e.controlState.selectedTimeRange}}),Fo)(Vo),Wo=n(592),Ko=n.n(Wo),Ho=n(593),Zo=n.n(Ho),Yo=n(591),qo=n.n(Yo),Xo=n(594),Jo=n.n(Xo),Qo=n(589),$o=n.n(Qo),ec=n(590),tc=n.n(ec),nc=Object(Xr.a)((function(e){return Object(qr.a)({formControl:{marginTop:e.spacing(1.5),marginRight:e.spacing(1)}})}))((function(e){var t=e.classes,n=e.timeAnimationActive,r=e.timeAnimationInterval,i=e.updateTimeAnimation,o=e.selectedTime,c=e.selectedTimeRange,s=e.selectTime,l=e.incSelectedTime,u=Object(a.useRef)(null);Object(a.useEffect)((function(){return p(),f}));var d=function(){l(1)},p=function(){n?m():f()},m=function(){f(),u.current=window.setInterval(d,r)},f=function(){null!==u.current&&(window.clearInterval(u.current),u.current=null)},h="number"===typeof o,b=v.get(n?"Stop":"Start"),g=n?Object(He.jsx)($o.a,{}):Object(He.jsx)(tc.a,{}),j=Object(He.jsx)(Hr.a,{disabled:!h,"aria-label":b,onClick:function(){i(!n,r)},size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Auto-step through times in the dataset"),children:g})}),O=Object(He.jsx)(Hr.a,{disabled:!h||n,onClick:function(){s(c?c[0]:null)},size:"small",children:Object(He.jsx)(qo.a,{})}),x=Object(He.jsx)(Hr.a,{disabled:!h||n,onClick:function(){l(-1)},size:"small",children:Object(He.jsx)(Ko.a,{})}),y=Object(He.jsx)(Hr.a,{disabled:!h||n,onClick:function(){l(1)},size:"small",children:Object(He.jsx)(Zo.a,{})}),w=Object(He.jsx)(Hr.a,{disabled:!h||n,onClick:function(){s(c?c[1]:null)},size:"small",children:Object(He.jsx)(Jo.a,{})});return Object(He.jsx)(Fi.a,{variant:"standard",className:t.formControl,children:Object(He.jsxs)(Ui.a,{children:[O,x,j,y,w]})})})),ac={selectTime:ur,incSelectedTime:function(e){return{type:dr,increment:e}},updateTimeAnimation:function(e,t){return{type:hr,timeAnimationActive:e,timeAnimationInterval:t}}},rc=Object(o.b)((function(e){return{locale:e.controlState.locale,selectedTime:e.controlState.selectedTime,selectedTimeRange:e.controlState.selectedTimeRange,timeAnimationActive:e.controlState.timeAnimationActive,timeAnimationInterval:e.controlState.timeAnimationInterval}}),ac)(nc),ic=n(595),oc=n.n(ic),cc=n(238),sc=n.n(cc),lc=n(355),uc=n.n(lc),dc=n(596),pc=n.n(dc),mc=Object(Xr.a)((function(e){return Object(qr.a)({formControl:{marginTop:e.spacing(2),marginRight:e.spacing(1),marginLeft:"auto"}})}))((function(e){var t=e.classes,n=e.visible,a=e.flyToSelectedObject,r=e.volumeCardOpen,i=e.showVolumeCard,o=e.infoCardOpen,c=e.showInfoCard,s=e.timeSeriesGroups,l=e.openDialog,u=e.allowRefresh,d=e.updateResources,p=e.compact;if(!n)return null;var m,f=s.length>0;he.instance.branding.allowDownloads&&(m=Object(He.jsx)(Hr.a,{disabled:!f,onClick:function(){return l("export")},size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Export data"),children:Object(He.jsx)(oc.a,{})})}));var h,b,g=Object(He.jsx)(Hr.a,{onClick:a,size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Show selected place in map"),children:Object(He.jsx)(pc.a,{})})}),j=he.instance.branding.allow3D&&Object(He.jsx)(Hr.a,{onClick:function(){return i(!0)},disabled:r,size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:"Open volume panel (experimental!)",children:Object(He.jsx)(uc.a,{})})}),O=Object(He.jsx)(Hr.a,{onClick:function(){return c(!0)},disabled:o,size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Open information panel"),children:Object(He.jsx)(sc.a,{})})});return p&&(u&&(h=Object(He.jsx)(Hr.a,{onClick:d,size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Refresh"),children:Object(He.jsx)(ai.a,{})})})),b=Object(He.jsx)(Hr.a,{onClick:function(){return l("settings")},size:"small",children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Settings"),children:Object(He.jsx)(ti.a,{})})})),Object(He.jsx)(Fi.a,{variant:"standard",className:t.formControl,children:Object(He.jsxs)(Ui.a,{children:[h,m,g,j,O,b]})})})),fc={showVolumeCard:jr,showInfoCard:wr,flyToSelectedObject:function(){return function(e,t){var n=vn(t()),a=fn(t());n?e(tr(n)):a&&e($a(a))}},openDialog:Mr,updateResources:wa},hc=Object(o.b)((function(e){return{locale:e.controlState.locale,visible:!(!e.controlState.selectedDatasetId&&!e.controlState.selectedPlaceId),volumeCardOpen:e.controlState.volumeCardOpen,infoCardOpen:e.controlState.infoCardOpen,timeSeriesGroups:e.dataState.timeSeriesGroups,compact:he.instance.branding.compact,allowRefresh:he.instance.branding.allowRefresh}}),fc)(mc),bc=Object(o.b)((function(e){return{locale:e.controlState.locale,show:e.dataState.datasets.length>0}}),{})((function(e){return e.show?Object(He.jsxs)(zi,{children:[Object(He.jsx)(Zi,{}),Object(He.jsx)(Qi,{}),Object(He.jsx)(ao,{}),Object(He.jsx)(fo,{}),Object(He.jsx)(vo,{}),Object(He.jsx)(No,{}),Object(He.jsx)(Go,{}),Object(He.jsx)(rc,{}),Object(He.jsx)(Uo,{}),Object(He.jsx)(hc,{})]}):null})),vc=n(276),gc=n(91),jc=(n(728),function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).state={error:null},a}return Object(m.a)(n,[{key:"componentDidCatch",value:function(e,t){console.error(e),t.componentStack&&console.error(t.componentStack)}},{key:"render",value:function(){if(!this.props.children)throw new Error("An ErrorBoundary requires at least one child");return this.state.error?Object(He.jsxs)("div",{children:[Object(He.jsx)("h2",{className:"errorBoundary-header",children:v.get("Something went wrong.")}),Object(He.jsxs)("details",{className:"errorBoundary-details",style:{whiteSpace:"pre-wrap"},children:[this.state.error.toString(),Object(He.jsx)("br",{})]})]}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return{error:e}}}]),n}(a.Component)),Oc=n(156),xc=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){var e;Object(p.a)(this,n);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(e=t.call.apply(t,[this].concat(r))).divRef=null,e.handleDivRef=function(t){e.divRef=t},e}return Object(m.a)(n,[{key:"addMapObject",value:function(e){var t=new Oc.a({element:this.divRef});return e.addControl(t),t}},{key:"updateMapObject",value:function(e,t,n){return t}},{key:"removeMapObject",value:function(e,t){var n,a=Object(u.a)(e.getControls().getArray());try{for(a.s();!(n=a.n()).done;){if(n.value===t){e.removeControl(t);break}}}catch(r){a.e(r)}finally{a.f()}}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.style,a=e.className,r=(a?a+" ":"")+"ol-unselectable ol-control";return Object(He.jsx)("div",{style:n,className:r,ref:this.handleDivRef,children:t})}}]),n}(it),yc=n(323),wc=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"addMapObject",value:function(e){var t=new yc.a(this.getOptions());return e.addControl(t),t}},{key:"updateMapObject",value:function(e,t,n){return t.setProperties(this.getOptions()),t}},{key:"removeMapObject",value:function(e,t){e.removeControl(t)}}]),n}(it),Sc=n(27),Tc=n(24),Pc=n(324),kc=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"addMapObject",value:function(e){var t=new Pc.a(this.getOptions()),n=!!this.props.active;return t.setActive(n),e.addInteraction(t),n&&this.listen(t,this.props),t}},{key:"updateMapObject",value:function(e,t,n){t.setProperties(this.getOptions());var a=!!this.props.active;return t.setActive(a),this.unlisten(t,n),a&&this.listen(t,this.props),t}},{key:"removeMapObject",value:function(e,t){this.unlisten(t,this.props),e.removeInteraction(t)}},{key:"getOptions",value:function(){var e=Object(Sc.a)(Object(Tc.a)(n.prototype),"getOptions",this).call(this);delete e.layerId,delete e.active,delete e.onDrawStart,delete e.onDrawEnd;var t=this.props.layerId;if(t&&!e.source){var a=this.getMapObject(t);a&&(e.source=a.getSource())}return e}},{key:"listen",value:function(e,t){var n=t.onDrawStart,a=t.onDrawEnd;n&&e.on("drawstart",n),a&&e.on("drawend",a)}},{key:"unlisten",value:function(e,t){var n=t.onDrawStart,a=t.onDrawEnd;n&&e.un("drawstart",n),a&&e.un("drawend",a)}}]),n}(it),Ec=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(){return Object(p.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"addMapObject",value:function(e){return this.updateView(e)}},{key:"removeMapObject",value:function(e,t){}},{key:"updateMapObject",value:function(e,t){return this.updateView(e)}},{key:"updateView",value:function(e){var t=this.props.projection,n=e.getView().getProjection();if("string"===typeof t&&n&&(n=n.getCode()),t&&t!==n){var a=e.getView(),r=new Qe.a(Object(P.a)(Object(P.a)({},this.props),{},{center:Object(ga.p)(a.getCenter()||[0,0],n,t),minZoom:a.getMinZoom(),zoom:a.getZoom()}));e.getLayers().forEach((function(e){e instanceof dt.a&&e.getSource().forEachFeature((function(e){var a;null===(a=e.getGeometry())||void 0===a||a.transform(n,t)}))})),e.setView(r)}else e.getView().setProperties(this.props);return e.getView()}}]),n}(it),Cc=n(275),Ic=n(597),_c=n.n(Ic);function Nc(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"circle";if(e.getGeometry()instanceof Lt.a)e.setStyle(function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"circle";return new We.c({image:Mc(e,t,n,a,r)})}(7,t,"white",1,a));else{n="number"===typeof n?n:.25;var r=_c()(t);r=Array.isArray(r)?[r[0],r[1],r[2],n]:[255,255,255,n],e.setStyle(function(e,t,n){var a=new Fe.a({color:e}),r=new Ue.a({color:t,width:n});return new We.c({fill:a,stroke:r})}(r,t,2))}}function Mc(e,t,n,a,r){var i=new Fe.a({color:t}),o=new Ue.a({color:n,width:a});switch(r){case"square":return new Cc.a({fill:i,stroke:o,radius:e,points:4,angle:Math.PI/4,rotation:0});case"diamond":return new Cc.a({fill:i,stroke:o,radius:e,points:4,angle:Math.PI/4,rotation:Math.PI/4});default:return new Ve.a({fill:i,stroke:o,radius:e})}}var Ac=function(e){var t=e.placeGroup,n=e.mapProjection,r=e.visible,i=a.useRef(new Ge.a);return a.useEffect((function(){var e=i.current,a=t.features;if(0===a.length)e.clear();else{var r=e.getFeatures(),o=new Set(r.map((function(e){return e.getId()}))),c=new Set(a.map((function(e){return e.id}))),s=a.filter((function(e){return!o.has(e.id)}));r.filter((function(e){return!c.has(e.getId()+"")})).forEach((function(t){return e.removeFeature(t)})),s.forEach((function(t){var a=(new d.a).readFeature(t,{dataProjection:"EPSG:4326",featureProjection:n});a.getId()!==t.id&&a.setId(t.id);var r=(t.properties||{}).color||"red",i=Boolean((t.properties||{}).source)?"diamond":"circle";Nc(a,r,he.instance.branding.polygonFillOpacity,i),e.addFeature(a)}))}}),[t,n]),Object(He.jsx)(pt,{id:t.id,opacity:t.id===we?1:.8,visible:r,zIndex:500,source:i.current})},Rc="selection",Lc=new Ge.a,Dc={zIndex:1e3,right:272,top:10},zc=new Ue.a({color:[255,200,0,1],width:3}),Gc=new Fe.a({color:[255,200,0,.05]}),Bc=new We.c({stroke:zc,fill:Gc,image:new Ve.a({radius:10,stroke:zc,fill:Gc})}),Vc=Object(Xr.a)((function(e){return Object(qr.a)({})}),{withTheme:!0})((function(e){var t=e.theme,n=e.mapId,r=e.mapInteraction,i=e.mapProjection,o=e.baseMapLayer,c=e.rgbLayer,s=e.variableLayer,l=e.datasetBoundaryLayer,p=e.placeGroupLayers,m=e.colorBarLegend,f=e.userDrawnPlaceGroupName,h=e.addDrawnUserPlace,b=e.importUserPlacesFromText,g=e.userPlaceGroups,j=e.userPlaceGroupsVisibility,O=e.selectPlace,x=e.selectedPlaceId,y=e.places,w=e.imageSmoothing,S=e.onMapRef,T=Object(a.useState)(null),P=Object(G.a)(T,2),k=P[0],E=P[1],C=Object(a.useState)(x||null),I=Object(G.a)(C,2),_=I[0],N=I[1];Object(a.useEffect)((function(){if(k){var e=x||null;if(e!==_&&sn[Rc]){var t=sn[Rc].getSource();if(t.clear(),e){var n=function(e,t){var n,a=Object(u.a)(e.getLayers().getArray());try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r instanceof dt.a){var i,o=null===(i=r.getSource())||void 0===i?void 0:i.getFeatureById(t);if(o)return o}}}catch(c){a.e(c)}finally{a.f()}return null}(k,e);if(n){var a=n.clone();a.setId("select-"+n.getId()),a.setStyle(void 0),t.addFeature(a)}}N(e)}}}),[k,x,_]),Object(a.useEffect)((function(){k&&k.getLayers().forEach((function(e){e instanceof Ye.a?e.getSource().changed():e.changed()}))}),[k,w]);var M=function(e){if(null!==k&&h&&"Select"!==r){var n=e.feature,a=n.getGeometry();if(!a)return;var i=z(ye+r.toLowerCase()+"-"),o=k.getView().getProjection();if(a instanceof vc.a){var c=Object(gc.b)(a);n.setGeometry(c)}a=n.clone().getGeometry().transform(o,$e);var s=(new d.a).writeGeometryObject(a);n.setId(i);var l=0;if(Boolean(sn[we])){var u,p=sn[we],m=null===p||void 0===p||null===(u=p.getSource())||void 0===u?void 0:u.getFeatures();m&&(l=m.length)}var b=function(e,t){var n=v.get(t),a=e.find((function(e){return e.id===we}));if(Boolean(a))for(var r=function(){var e="".concat(n," ").concat(i);if(!!!a.features.find((function(t){return!!Boolean(t.properties)&&t.properties.label===e})))return{v:e}},i=1;;i++){var o=r();if("object"===typeof o)return o.v}return"".concat(n," 1")}(g,r),j=je(l);Nc(n,Oe(j,t.palette.mode),he.instance.branding.polygonFillOpacity),h(f,i,{label:b,color:j},s,!0)}return!0};var A=null;m&&(A=Object(He.jsx)(xc,{id:"legend",style:Dc,children:m})),null!==c&&(s=c);return Object(He.jsx)(jc,{children:Object(He.jsxs)(rt,{id:n,onClick:function(e){return function(e){if("Select"===r){var t=null,n=e.map.getFeaturesAtPixel(e.pixel);if(n){var a,i=Object(u.a)(n);try{for(i.s();!(a=i.n()).done;){var o=a.value;if("function"===typeof o.getId){t=o.getId()+"";break}}}catch(c){i.e(c)}finally{i.f()}}O&&O(t,y,!1)}}(e)},onMapRef:function(e){S&&S(e),E(e)},mapObjects:sn,isStale:!0,onDropFiles:function(e){b&&e.forEach((function(e){var t=new FileReader;t.onloadend=function(){"string"===typeof t.result&&b(t.result)},t.readAsText(e,"UTF-8")}))},children:[Object(He.jsx)(Ec,{id:"view",projection:i}),Object(He.jsxs)(Ze,{children:[o,s,l,Object(He.jsx)(He.Fragment,{children:g.map((function(e){return Object(He.jsx)(Ac,{placeGroup:e,mapProjection:i,visible:j[e.id]},e.id)}))}),Object(He.jsx)(pt,{id:Rc,opacity:.7,zIndex:510,style:Bc,source:Lc})]}),p,Object(He.jsx)(kc,{id:"drawPoint",layerId:we,active:"Point"===r,type:"Point",wrapX:!0,stopClick:!0,onDrawEnd:M}),Object(He.jsx)(kc,{id:"drawPolygon",layerId:we,active:"Polygon"===r,type:"Polygon",wrapX:!0,stopClick:!0,onDrawEnd:M}),Object(He.jsx)(kc,{id:"drawCircle",layerId:we,active:"Circle"===r,type:"Circle",wrapX:!0,stopClick:!0,onDrawEnd:M}),A,Object(He.jsx)(wc,{bar:!1})]})})}));var Fc=n(1097);function Uc(e){var t=e[0],n=e[e.length-1],a=Math.min(10,Math.max(2,Math.round(-Math.log10(n-t))));return e.map((function(e){return function(e,t){var n=Math.round(e);return Math.abs(n-e)<1e-8?n+"":e.toFixed(t)}(e,a)}))}function Wc(e,t){return Uc(function(e,t,n){for(var a=(t-e)/(n-1),r=new Array(n),i=0;i<n;i++)r[i]=e+i*a;return r}(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:5))}var Kc=function(e){var t=e.colorBar,n=e.opacity,r=e.width,i=e.height,o=e.onOpenEditor,c=Object(a.useRef)(null);return Object(a.useEffect)((function(){var e=c.current;null!==e&&mn(t,n,e)}),[t,n]),Object(He.jsx)(He.Fragment,{children:Boolean(t.imageData)?Object(He.jsx)("canvas",{ref:c,width:r||240,height:i||24,onClick:o}):Object(He.jsx)("div",{children:v.get("Unknown color bar")+": ".concat(t.baseName)})})},Hc=Object(Ci.a)((function(e){return{title:{fontSize:"x-small",fontWeight:"bold",width:"100%",display:"flex",flexWrap:"nowrap",justifyContent:"center",paddingBottom:e.spacing(.5)},label:{fontSize:"x-small",fontWeight:"bold",width:"100%",display:"flex",flexWrap:"nowrap",justifyContent:"space-between"},container:{paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5),paddingBottom:e.spacing(.5),paddingTop:e.spacing(.5),color:"black"},sliderBox:{marginTop:e.spacing(1),marginLeft:e.spacing(5),marginRight:e.spacing(5),minWidth:320,width:"calc(100% - ".concat(e.spacing(12),"px)")},colorBarBox:{marginTop:e.spacing(.6),marginLeft:e.spacing(1),marginRight:e.spacing(1),marginBottom:e.spacing(1)},colorBarGroupTitle:{marginTop:e.spacing(.4),color:e.palette.grey[400]},colorBarGroupItemBox:{marginTop:e.spacing(.2)},colorBarMinMaxEditor:{marginTop:e.spacing(2),marginBottom:e.spacing(2)},minMaxBox:{display:"flex",justifyContent:"center"},minTextField:{maxWidth:"8em",paddingRight:2},maxTextField:{maxWidth:"8em",paddingLeft:2}}}));function Zc(e){var t=e.minValue,n=e.maxValue,r=e.count;return Object(He.jsx)(a.Fragment,{children:Wc(t,n,r).map((function(e,t){return Object(He.jsx)("span",{children:e},t)}))})}function Yc(e){return[e[0]+"",e[1]+""]}var qc={updateVariableColorBar:function(e,t,n){return function(a,r){var i=r().controlState.selectedDatasetId,o=r().controlState.selectedVariableName;i&&o&&a(function(e,t,n,a,r){return{type:Ha,datasetId:e,variableName:t,colorBarMinMax:n,colorBarName:a,opacity:r}}(i,o,e,t,n))}}},Xc=Object(o.b)((function(e){return{variableName:hn(e),variableUnits:Pn(e),variableColorBarMinMax:kn(e),variableColorBarName:En(e),variableColorBar:Cn(e),variableOpacity:In(e),colorBars:e.dataState.colorBars}}),qc)((function(e){var t=e.variableName,n=e.variableUnits,r=e.variableColorBarMinMax,i=e.variableColorBarName,o=e.variableColorBar,c=e.variableOpacity,s=e.updateVariableColorBar,l=e.colorBars,d=e.width,p=e.height,m=e.numTicks,f=Hc(),h=a.useState(null),b=Object(G.a)(h,2),g=b[0],j=b[1],O=a.useState(null),x=Object(G.a)(O,2),y=x[0],w=x[1],S=a.useState(r),T=Object(G.a)(S,2),k=T[0],E=T[1],C=a.useState(r),I=Object(G.a)(C,2),_=I[0],N=I[1],M=a.useState(Yc(r)),A=Object(G.a)(M,2),R=A[0],L=A[1],D=a.useState([!1,!1]),z=Object(G.a)(D,2),B=z[0],V=z[1];a.useEffect((function(){L(Yc(r))}),[r]);var F=Boolean(g),U=Boolean(y);if(!t||!l)return null;var W,K,H="".concat(t," (").concat(n||"-",")");if(F){for(var Z,Y=Object(G.a)(_,2),q=Y[0],X=Y[1],J=q<X?X-q:1,Q=Math.floor(Math.log10(J)),$=J*Math.pow(10,-Q),ee=null,te=0,ne=[.25,.2,.15,.125,.1];te<ne.length;te++){var ae=$/ne[te],re=Math.floor(ae);if(Math.abs(re-ae)<1e-10){ee=re;break}}null!==ee&&ee>=2?Z=Math.max(2,Math.round(ee/2)):(Z=4,ee=8);var ie=q<X?J/ee:.5,oe=q-Z*ie,ce=X+Z*ie,se=(ce-oe)/(ee+2*Z),le=[oe,q,X,ce],ue=Uc(le).map((function(e,t){return{value:le[t],label:e}}));W=Object(He.jsxs)("div",{className:f.colorBarMinMaxEditor,children:[Object(He.jsx)("span",{style:{paddingLeft:14},children:H}),Object(He.jsx)(Ui.a,{className:f.sliderBox,children:Object(He.jsx)(Bo.a,{min:oe,max:ce,value:k,marks:ue,step:se,onChange:function(e,t){Array.isArray(t)&&E([t[0],t[1]])},onChangeCommitted:function(e,t){Array.isArray(t)&&s([t[0],t[1]],i,c)},valueLabelDisplay:"auto",size:"small"})}),Object(He.jsxs)(Ui.a,{component:"form",className:f.minMaxBox,children:[Object(He.jsx)(Mo.a,{className:f.minTextField,label:"Minimum",variant:"filled",size:"small",value:R[0],error:B[0],onChange:function(e){return function(e){var t=e.target.value;L([t,R[1]]);var n=Number.parseFloat(t),a=!1;if(!Number.isNaN(n)&&n<k[1]){if(n!==k[0]){var r=[n,k[1]];E(r),N(r),s(r,i,c)}}else a=!0;V([a,B[1]])}(e)}}),Object(He.jsx)(Mo.a,{className:f.maxTextField,label:"Maximum",variant:"filled",size:"small",value:R[1],error:B[1],onChange:function(e){return function(e){var t=e.target.value;L([R[0],t]);var n=Number.parseFloat(t),a=!1;if(!Number.isNaN(n)&&n>k[0]){if(n!==k[1]){var r=[k[0],n];E(r),N(r),s(r,i,c)}}else a=!0;V([B[0],a])}(e)}})]})]})}if(U){var de,pe=0,me=[],fe=Object(u.a)(l.groups);try{for(fe.s();!(de=fe.n()).done;){var he=de.value;if(he.names&&0!==he.names.length){me.push(Object(He.jsx)(Jr.a,{arrow:!0,title:he.description,placement:"left",children:Object(He.jsx)(Ui.a,{className:f.colorBarGroupTitle,children:he.title})},pe++));var be,ve=Object(u.a)(he.names);try{var ge=function(){var e=be.value;me.push(Object(He.jsx)(Ui.a,{className:f.colorBarGroupItemBox,border:1,borderColor:e===o.baseName?"orange":"black",width:240,height:20,children:Object(He.jsx)(Jr.a,{arrow:!0,title:e,placement:"left",children:Object(He.jsx)("img",{src:"data:image/png;base64,".concat(l.images[e]),alt:"Color Bar",width:"100%",height:"100%",onClick:function(){var t;t=e,i=pn(Object(P.a)(Object(P.a)({},o),{},{baseName:t})),s(r,i,c)}})})},pe++))};for(ve.s();!(be=ve.n()).done;)ge()}catch(je){ve.e(je)}finally{ve.f()}}}}catch(je){fe.e(je)}finally{fe.f()}K=Object(He.jsxs)(Ui.a,{className:f.colorBarBox,children:[Object(He.jsxs)(Ui.a,{component:"span",children:[Object(He.jsx)(ro.a,{color:"primary",checked:o.isAlpha,onChange:function(e){var t=e.currentTarget.checked;i=pn(Object(P.a)(Object(P.a)({},o),{},{isAlpha:t})),s(r,i,c)},size:"small",style:{paddingLeft:0,paddingRight:2,paddingTop:4,paddingBottom:4}}),Object(He.jsx)(Ui.a,{component:"span",children:v.get("Hide small values")}),Object(He.jsx)(ro.a,{color:"primary",checked:o.isReversed,onChange:function(e){var t=e.currentTarget.checked;i=pn(Object(P.a)(Object(P.a)({},o),{},{isReversed:t})),s(r,i,c)},size:"small",style:{paddingLeft:10,paddingRight:2,paddingTop:4,paddingBottom:4}}),Object(He.jsx)(Ui.a,{component:"span",children:v.get("Reverse")})]}),Object(He.jsxs)(Ui.a,{component:"div",style:{display:"flex",alignItems:"center"},children:[Object(He.jsx)("span",{children:v.get("Opacity")}),Object(He.jsx)(Bo.a,{min:0,max:1,value:c,step:.01,style:{flexGrow:1,marginLeft:10,marginRight:10},onChange:function(e,t){s(r,i,t)},size:"small"})]}),me]})}return Object(He.jsxs)("div",{className:"ol-control "+f.container,children:[Object(He.jsx)("div",{className:f.title,children:Object(He.jsx)("span",{children:H})}),Object(He.jsx)(Kc,{colorBar:o,opacity:c,width:d,height:p,onOpenEditor:function(e){w(e.currentTarget)}}),Object(He.jsx)("div",{className:f.label,onClick:function(e){j(e.currentTarget),E(r),N(r)},children:Object(He.jsx)(Zc,{minValue:r[0],maxValue:r[1],count:m||5})}),Object(He.jsx)(Fc.a,{anchorEl:g,open:F,onClose:function(){j(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"center"},children:W}),Object(He.jsx)(Fc.a,{anchorEl:y,open:U,onClose:function(){w(null)},anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"},children:K})]})})),Jc={addDrawnUserPlace:function(e,t,n,a,r){return function(i,o){i(function(e,t,n,a,r){return{type:Ea,placeGroupTitle:e,id:t,properties:n,geometry:a,selected:r}}(e,t,n,a,r)),o().controlState.autoShowTimeSeries&&o().controlState.selectedPlaceId===t&&i(Ra())}},importUserPlacesFromText:Ia,selectPlace:or},Qc=Object(o.b)((function(e,t){return{locale:e.controlState.locale,variableLayer:aa(e),rgbLayer:ra(e),datasetBoundaryLayer:ta(e),placeGroupLayers:sa(e),colorBarLegend:Object(He.jsx)(Xc,{}),userDrawnPlaceGroupName:e.controlState.userDrawnPlaceGroupName,userPlaceGroups:Pt(e),userPlaceGroupsVisibility:Ln(e),mapId:"map",mapInteraction:e.controlState.mapInteraction,mapProjection:yn(e),selectedPlaceId:e.controlState.selectedPlaceId,places:Bn(e),baseMapLayer:pa(e),imageSmoothing:On(e),onMapRef:t.onMapRef}}),Jc)(Vc),$c=n(607),es=n.n($c),ts=n(239),ns=n(599),as=n(603),rs=n(606),is=n(1129),os=n(1068),cs=n(614),ss=n(615),ls=n(1069),us=n(290),ds=n(280),ps=n(598),ms=n.n(ps),fs=function(e){var t=e.className,n=e.timeSeriesGroupId,r=e.placeGroupTimeSeries,i=e.addPlaceGroupTimeSeries,o=a.useState(null),c=Object(G.a)(o,2),s=c[0],l=c[1],u=[];r.forEach((function(e){Object.getOwnPropertyNames(e.timeSeries).forEach((function(t){var a="".concat(e.placeGroup.title," / ").concat(t);u.push(Object(He.jsx)(Yr.a,{onClick:function(){return a=e.timeSeries[t],l(null),void i(n,a);var a},children:a},a))}))}));var d=Boolean(s);return Object(He.jsxs)(He.Fragment,{children:[Object(He.jsx)(Hr.a,{size:"small",className:t,"aria-label":"Add","aria-controls":d?"basic-menu":void 0,"aria-haspopup":"true","aria-expanded":d?"true":void 0,onClick:function(e){l(e.currentTarget)},disabled:0===u.length,children:Object(He.jsx)(ms.a,{})}),Object(He.jsx)(Zr.a,{id:"basic-menu",anchorEl:s,open:d,onClose:function(){l(null)},MenuListProps:{"aria-labelledby":"basic-button"},children:u})]})},hs=function(e){return Object(qr.a)({chartContainer:{userSelect:"none",marginTop:e.spacing(1),width:"99%",height:"32vh",display:"flex",flexDirection:"column",alignItems:"flex-stretch"},responsiveContainer:{flexGrow:1},actionButton:{zIndex:1e3,opacity:.8},toolTipContainer:{backgroundColor:"black",opacity:.8,color:"white",border:"2px solid black",borderRadius:e.spacing(2),padding:e.spacing(1.5)},toolTipValue:{fontWeight:"bold"},toolTipLabel:{fontWeight:"bold",paddingBottom:e.spacing(1)},chartTitle:{fontSize:"inherit",fontWeight:"normal"},legendContainer:{display:"flex",justifyContent:"center",columnGap:12,flexWrap:"wrap"},legendItem:{display:"flex",alignItems:"center"},legendCloseIcon:{marginLeft:4,cursor:"pointer",display:"flex",alignItems:"center"}})},bs=["dataMin","dataMax"],vs=["auto","auto"],gs=Object(Xr.a)(hs,{withTheme:!0})((function(e){var t,n,r=e.classes,i=e.timeSeriesGroup,o=e.selectTimeSeries,c=e.selectedTime,s=e.selectTime,l=e.selectedTimeRange,u=e.selectTimeRange,d=e.places,p=e.selectPlace,m=e.placeInfos,f=e.dataTimeRange,h=e.theme,b=e.showErrorBars,g=e.showPointsOnly,j=e.removeTimeSeries,O=e.removeTimeSeriesGroup,x=e.placeGroupTimeSeries,y=e.addPlaceGroupTimeSeries,w=e.completed,S=Object(a.useState)({}),T=Object(G.a)(S,2),k=T[0],E=T[1],C=function(){E({})},I=h.palette.mode,_=h.palette.primary.light,N=h.palette.primary.main,M=h.palette.text.primary,A=!1,R=null,L=null;if(l){A=!((t=l)===(n=f||null)||null!==t&&null!=n&&t[0]===n[0]&&t[1]===n[1]);var D=Object(G.a)(l,2);R=D[0],L=D[1]}var z=function(){var e=k.firstTime,t=k.secondTime;if(e!==t&&void 0!==e&&void 0!==t){var n=e,a=t;if(n>a){var r=[a,n];n=r[0],a=r[1]}C(),u&&u([n,a])}else C()},B=function(){C(),u&&u(f||null)},V=null,F=i.timeSeriesArray.map((function(e,t){var n,a=e.source,r=a.valueDataKey,c=a.variableName;if(null===a.placeId){c="".concat(a.datasetTitle,"/").concat(c);var s=null;x.forEach((function(e){if(null===s&&e.placeGroup.id===a.datasetId){var t=e.placeGroup.features;t.length>0&&t[0].properties&&(s=t[0].properties.color||null)}})),n=s||"red"}else if(m){var l=m[a.placeId];if(l){var u=l.place,f=l.label,h=l.color;if("Point"===u.geometry.type){var v=u.geometry.coordinates[0],j=u.geometry.coordinates[1];c+=" (".concat(f,": ").concat(j.toFixed(5),",").concat(v.toFixed(5),")")}else c+=" (".concat(f,")");n=h}}var O=[];e.data.forEach((function(e){if(null!==e[r]){var t=!0,n=!0;null!==R&&(t=e.time>=R),null!==L&&(n=e.time<=L),t&&n&&O.push(e)}})),null===V&&(V=r);var y,w,S,T=Oe(n,I);r&&b&&a.errorDataKey&&(y=Object(He.jsx)(ts.a,{dataKey:a.errorDataKey,width:4,strokeWidth:1,stroke:T})),null===e.source.placeId?(w=0,S={radius:5,strokeWidth:1.5,symbol:"diamond"}):(w=g?0:e.dataProgress,S={radius:3,strokeWidth:2,symbol:"circle"});var k=Object(He.jsx)(Os,Object(P.a)(Object(P.a)({},S),{},{stroke:T,fill:"white"})),E=Object(He.jsx)(Os,Object(P.a)(Object(P.a)({},S),{},{stroke:"white",fill:T}));return Object(He.jsx)(ns.a,{type:"monotone",name:c,unit:a.variableUnits,data:O,dataKey:r,dot:k,activeDot:E,stroke:T,strokeOpacity:w,isAnimationActive:!1,onClick:function(){return n=i.id,a=t,r=e,o&&o(n,a,r),void p(r.source.placeId,d,!0);var n,a,r},children:y},t)})),U=null;null!==c&&(U=Object(He.jsx)(as.a,{isFront:!0,x:c,stroke:N,strokeWidth:3,strokeOpacity:.5}));var W=k.firstTime,K=k.secondTime,H=null;void 0!==W&&void 0!==K&&(H=Object(He.jsx)(rs.a,{x1:W,x2:K,strokeOpacity:.3,fill:_,fillOpacity:.3}));var Z=[];if(A){var Y=Object(He.jsx)(Hr.a,{className:r.actionButton,"aria-label":"Zoom Out",onClick:function(){B()},size:"large",children:Object(He.jsx)(es.a,{})},"zoomOutButton");Z.push(Y)}var q,X=w.reduce((function(e,t){return e+t}),0)/w.length,J=X>0&&X<100,Q=Object(He.jsx)(fs,{className:r.actionButton,timeSeriesGroupId:i.id,placeGroupTimeSeries:x,addPlaceGroupTimeSeries:y},"addTimeSeries");Z.push(Q),q=J?Object(He.jsx)(li.a,{size:24,className:r.actionButton,color:"secondary"},"loadingTimeSeriesGroup"):Object(He.jsx)(Hr.a,{className:r.actionButton,"aria-label":"Close",onClick:function(){O&&O(i.id)},size:"small",children:Object(He.jsx)(_i.a,{})},"removeTimeSeriesGroup"),Z.push(q);var $=v.get("Time-Series"),ee=i.variableUnits||v.get("unknown units"),te="".concat($," (").concat(ee,")");return Object(He.jsxs)("div",{className:r.chartContainer,children:[Object(He.jsxs)(Ui.a,{display:"flex",flexDirection:"row",alignItems:"center",justifyContent:"space-between",children:[Object(He.jsx)(Kr.a,{className:r.chartTitle,children:te}),Object(He.jsx)(Ui.a,{display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",children:Z})]}),Object(He.jsx)(is.a,{width:"99%",className:r.responsiveContainer,children:Object(He.jsxs)(os.a,{onMouseDown:function(e){var t=e&&e.activeLabel;E({firstTime:t})},onMouseMove:function(e){if(void 0!==k.firstTime){var t=e&&e.activeLabel;E(Object(P.a)(Object(P.a)({},k),{},{secondTime:t}))}},onMouseUp:function(){z()},onMouseEnter:function(){C()},onMouseLeave:function(){C()},onClick:function(e){e&&s&&null!==e.activeLabel&&Number.isFinite(e.activeLabel)&&s(e.activeLabel),C()},syncId:"anyId",style:{color:M,fontSize:"0.8em"},children:[Object(He.jsx)(cs.a,{dataKey:"time",type:"number",tickCount:6,domain:l||bs,tickFormatter:function(e){return"number"===typeof e&&Number.isFinite(e)?xt(e):null},stroke:M,allowDuplicatedCategory:!1}),Object(He.jsx)(ss.a,{dataKey:V||"mean",type:"number",domain:vs,stroke:M}),Object(He.jsx)(ls.a,{strokeDasharray:"3 3"}),Object(He.jsx)(us.a,{content:Object(He.jsx)(js,{})}),Object(He.jsx)(ds.a,{content:Object(He.jsx)(xs,{removeTimeSeries:function(e){j(i.id,e)}})}),F,H,U]})})]})})),js=Object(Xr.a)(hs)((function(e){var t=e.classes,n=e.active,a=e.label,r=e.payload;if(!n)return null;if("number"!==typeof a)return null;if(!r||0===r.length)return null;var i=r.map((function(e,n){var a=e.name,r=e.value,i=e.color,o=e.unit,c=e.dataKey;if("number"!==typeof r)return null;var s=r.toFixed(3);"#00000000"===i&&(i="#FAFFDD");var l=-1!==a.indexOf(":")?null:" (".concat(c,")");return o?l=null!==l?"".concat(o," ").concat(l):o:null===l&&(l=""),Object(He.jsxs)("div",{children:[Object(He.jsxs)("span",{children:[a,":\xa0"]}),Object(He.jsx)("span",{className:t.toolTipValue,style:{color:i},children:s}),Object(He.jsxs)("span",{children:["\xa0",l]})]},n)}));return i?Object(He.jsxs)("div",{className:t.toolTipContainer,children:[Object(He.jsx)("span",{className:t.toolTipLabel,children:"".concat(yt(a)," UTC")}),i]}):null})),Os=function(e){var t,n=e.cx,a=e.cy,r=e.radius,i=e.stroke,o=e.fill,c=e.strokeWidth,s=e.symbol,l=1024,u=r+.5*c,d=2*u,p=Math.floor(100*c/d+.5)+"%";if("diamond"===s){var m=512,f=512,h=l*(r/d);t=Object(He.jsx)("polygon",{points:"".concat(m-h,",").concat(f," ").concat(m,",").concat(f-h," ").concat(m+h,",").concat(f," ").concat(m,",").concat(f+h),strokeWidth:p,stroke:i,fill:o})}else{var b=Math.floor(100*r/d+.5)+"%";t=Object(He.jsx)("circle",{cx:"50%",cy:"50%",r:b,strokeWidth:p,stroke:i,fill:o})}return"number"===typeof n&&"number"===typeof a?Object(He.jsx)("svg",{x:n-u,y:a-u,width:d,height:d,viewBox:"0 0 ".concat(l," ").concat(l),children:t}):null},xs=Object(Xr.a)(hs)((function(e){var t=e.payload,n=e.removeTimeSeries,a=e.classes;return t&&0!==t.length?Object(He.jsx)("div",{className:a.legendContainer,children:t.map((function(e,t){return Object(He.jsxs)("div",{className:a.legendItem,style:{color:e.color},children:[Object(He.jsx)("span",{children:e.value}),n&&Object(He.jsx)("span",{className:a.legendCloseIcon,onMouseUp:function(){return n(t)},children:Object(He.jsx)(so.a,{fontSize:"small"})})]},e.value)}))}):null})),ys=Object(Xr.a)((function(e){return Object(qr.a)({box:{marginTop:e.spacing(1),marginLeft:e.spacing(5),marginRight:e.spacing(5),width:"calc(100% - ".concat(e.spacing(18),")"),height:"5em",display:"flex",alignItems:"flex-end"}})}))((function(e){var t=e.classes,n=e.dataTimeRange,r=e.selectedTimeRange,i=e.selectTimeRange,o=Object(a.useState)(r),c=Object(G.a)(o,2),s=c[0],l=c[1];Object(a.useEffect)((function(){l(r)}),[r]);var u=Array.isArray(n);u||(n=[Date.now()-2*wt,Date.now()]);var d=[{value:n[0],label:xt(n[0])},{value:n[1],label:xt(n[1])}];return Object(He.jsx)(Ui.a,{className:t.box,children:Object(He.jsx)(Bo.a,{disabled:!u,min:n[0],max:n[1],value:s,marks:d,onChange:function(e,t){Array.isArray(t)&&l([t[0],t[1]])},onChangeCommitted:function(e,t){i&&Array.isArray(t)&&i([t[0],t[1]])},size:"small",valueLabelDisplay:"on",valueLabelFormat:function(e){return yt(e)}})})})),ws=Object(Xr.a)((function(e){return Object(qr.a)({chartContainer:{display:"flex",flexDirection:"column",flexWrap:"wrap",flexFlow:"flex-start",alignItems:"center"},noChartsCard:{width:"20em"},noChartsTitle:{fontSize:14}})}),{withTheme:!0})((function(e){var t=e.classes,n=e.locale,a=e.timeSeriesGroups,r=e.selectedTime,i=e.selectedTimeRange,o=e.dataTimeRange,c=e.selectTime,s=e.selectTimeRange,l=e.removeTimeSeries,u=e.removeTimeSeriesGroup,d=e.showPointsOnly,p=e.showErrorBars,m=e.placeInfos,f=e.places,h=e.selectPlace,b=e.placeGroupTimeSeries,v=e.addPlaceGroupTimeSeries,g=a.map((function(e){var t=e.timeSeriesArray.map((function(e){return e.dataProgress?100*e.dataProgress:0}));return Object(He.jsx)(gs,{locale:n,timeSeriesGroup:e,selectedTime:r,selectedTimeRange:i,dataTimeRange:o,selectTime:c,selectTimeRange:s,removeTimeSeries:l,removeTimeSeriesGroup:u,completed:t,showPointsOnly:d,showErrorBars:p,placeInfos:m,places:f,selectPlace:h,placeGroupTimeSeries:b,addPlaceGroupTimeSeries:v},e.id)}));return 0===g.length?null:Object(He.jsxs)("div",{className:t.chartContainer,children:[Object(He.jsx)(ys,{selectedTimeRange:i,dataTimeRange:o,selectTimeRange:s}),g]})})),Ss={selectTime:ur,selectTimeRange:mr,removeTimeSeries:function(e,t){return{type:Ga,groupId:e,index:t}},removeTimeSeriesGroup:function(e){return{type:Ba,id:e}},selectPlace:or,addPlaceGroupTimeSeries:function(e,t){return{type:za,timeSeriesGroupId:e,timeSeries:t}}},Ts=Object(o.b)((function(e){return{locale:e.controlState.locale,timeSeriesGroups:e.dataState.timeSeriesGroups,selectedTime:e.controlState.selectedTime,selectedTimeRange:e.controlState.selectedTimeRange,dataTimeRange:_n(e),showPointsOnly:e.controlState.showTimeSeriesPointsOnly,showErrorBars:e.controlState.showTimeSeriesErrorBars,placeInfos:Kn(e),places:Bn(e),placeGroupTimeSeries:Ct(e)}}),Ss)(ws),Ps=n(1114),ks=n(1115),Es=n(1116),Cs=n(53),Is=n(28),_s={type:"change"},Ns={type:"start"},Ms={type:"end"},As=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e,a){var r;Object(p.a)(this,n),(r=t.call(this)).object=e,r.domElement=a,r.domElement.style.touchAction="none",r.enabled=!0,r.target=new Is.C,r.minDistance=0,r.maxDistance=1/0,r.minZoom=0,r.maxZoom=1/0,r.minPolarAngle=0,r.maxPolarAngle=Math.PI,r.minAzimuthAngle=-1/0,r.maxAzimuthAngle=1/0,r.enableDamping=!1,r.dampingFactor=.05,r.enableZoom=!0,r.zoomSpeed=1,r.enableRotate=!0,r.rotateSpeed=1,r.enablePan=!0,r.panSpeed=1,r.screenSpacePanning=!0,r.keyPanSpeed=7,r.autoRotate=!1,r.autoRotateSpeed=2,r.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},r.mouseButtons={LEFT:Is.l.ROTATE,MIDDLE:Is.l.DOLLY,RIGHT:Is.l.PAN},r.touches={ONE:Is.x.ROTATE,TWO:Is.x.DOLLY_PAN},r.target0=r.target.clone(),r.position0=r.object.position.clone(),r.zoom0=r.object.zoom,r._domElementKeyEvents=null,r.getPolarAngle=function(){return l.phi},r.getAzimuthalAngle=function(){return l.theta},r.getDistance=function(){return this.object.position.distanceTo(this.target)},r.listenToKeyEvents=function(e){e.addEventListener("keydown",Z),this._domElementKeyEvents=e},r.saveState=function(){i.target0.copy(i.target),i.position0.copy(i.object.position),i.zoom0=i.object.zoom},r.reset=function(){i.target.copy(i.target0),i.object.position.copy(i.position0),i.object.zoom=i.zoom0,i.object.updateProjectionMatrix(),i.dispatchEvent(_s),i.update(),c=o.NONE},r.update=function(){var t=new Is.C,n=(new Is.s).setFromUnitVectors(e.up,new Is.C(0,1,0)),a=n.clone().invert(),r=new Is.C,p=new Is.s,h=2*Math.PI;return function(){var e=i.object.position;t.copy(e).sub(i.target),t.applyQuaternion(n),l.setFromVector3(t),i.autoRotate&&c===o.NONE&&k(2*Math.PI/60/60*i.autoRotateSpeed),i.enableDamping?(l.theta+=u.theta*i.dampingFactor,l.phi+=u.phi*i.dampingFactor):(l.theta+=u.theta,l.phi+=u.phi);var b=i.minAzimuthAngle,v=i.maxAzimuthAngle;return isFinite(b)&&isFinite(v)&&(b<-Math.PI?b+=h:b>Math.PI&&(b-=h),v<-Math.PI?v+=h:v>Math.PI&&(v-=h),l.theta=b<=v?Math.max(b,Math.min(v,l.theta)):l.theta>(b+v)/2?Math.max(b,l.theta):Math.min(v,l.theta)),l.phi=Math.max(i.minPolarAngle,Math.min(i.maxPolarAngle,l.phi)),l.makeSafe(),l.radius*=d,l.radius=Math.max(i.minDistance,Math.min(i.maxDistance,l.radius)),!0===i.enableDamping?i.target.addScaledVector(m,i.dampingFactor):i.target.add(m),t.setFromSpherical(l),t.applyQuaternion(a),e.copy(i.target).add(t),i.object.lookAt(i.target),!0===i.enableDamping?(u.theta*=1-i.dampingFactor,u.phi*=1-i.dampingFactor,m.multiplyScalar(1-i.dampingFactor)):(u.set(0,0,0),m.set(0,0,0)),d=1,!!(f||r.distanceToSquared(i.object.position)>s||8*(1-p.dot(i.object.quaternion))>s)&&(i.dispatchEvent(_s),r.copy(i.object.position),p.copy(i.object.quaternion),f=!1,!0)}}(),r.dispose=function(){i.domElement.removeEventListener("contextmenu",Y),i.domElement.removeEventListener("pointerdown",F),i.domElement.removeEventListener("pointercancel",K),i.domElement.removeEventListener("wheel",H),i.domElement.removeEventListener("pointermove",U),i.domElement.removeEventListener("pointerup",W),null!==i._domElementKeyEvents&&i._domElementKeyEvents.removeEventListener("keydown",Z)};var i=Object(Cs.a)(r),o={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},c=o.NONE,s=1e-6,l=new Is.w,u=new Is.w,d=1,m=new Is.C,f=!1,h=new Is.B,b=new Is.B,v=new Is.B,g=new Is.B,j=new Is.B,O=new Is.B,x=new Is.B,y=new Is.B,w=new Is.B,S=[],T={};function P(){return Math.pow(.95,i.zoomSpeed)}function k(e){u.theta-=e}function E(e){u.phi-=e}var C=function(){var e=new Is.C;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),m.add(e)}}(),I=function(){var e=new Is.C;return function(t,n){!0===i.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(i.object.up,e)),e.multiplyScalar(t),m.add(e)}}(),_=function(){var e=new Is.C;return function(t,n){var a=i.domElement;if(i.object.isPerspectiveCamera){var r=i.object.position;e.copy(r).sub(i.target);var o=e.length();o*=Math.tan(i.object.fov/2*Math.PI/180),C(2*t*o/a.clientHeight,i.object.matrix),I(2*n*o/a.clientHeight,i.object.matrix)}else i.object.isOrthographicCamera?(C(t*(i.object.right-i.object.left)/i.object.zoom/a.clientWidth,i.object.matrix),I(n*(i.object.top-i.object.bottom)/i.object.zoom/a.clientHeight,i.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),i.enablePan=!1)}}();function N(e){i.object.isPerspectiveCamera?d/=e:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom*e)),i.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function M(e){i.object.isPerspectiveCamera?d*=e:i.object.isOrthographicCamera?(i.object.zoom=Math.max(i.minZoom,Math.min(i.maxZoom,i.object.zoom/e)),i.object.updateProjectionMatrix(),f=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),i.enableZoom=!1)}function A(e){h.set(e.clientX,e.clientY)}function R(e){g.set(e.clientX,e.clientY)}function L(){if(1===S.length)h.set(S[0].pageX,S[0].pageY);else{var e=.5*(S[0].pageX+S[1].pageX),t=.5*(S[0].pageY+S[1].pageY);h.set(e,t)}}function D(){if(1===S.length)g.set(S[0].pageX,S[0].pageY);else{var e=.5*(S[0].pageX+S[1].pageX),t=.5*(S[0].pageY+S[1].pageY);g.set(e,t)}}function z(){var e=S[0].pageX-S[1].pageX,t=S[0].pageY-S[1].pageY,n=Math.sqrt(e*e+t*t);x.set(0,n)}function G(e){if(1===S.length)b.set(e.pageX,e.pageY);else{var t=J(e),n=.5*(e.pageX+t.x),a=.5*(e.pageY+t.y);b.set(n,a)}v.subVectors(b,h).multiplyScalar(i.rotateSpeed);var r=i.domElement;k(2*Math.PI*v.x/r.clientHeight),E(2*Math.PI*v.y/r.clientHeight),h.copy(b)}function B(e){if(1===S.length)j.set(e.pageX,e.pageY);else{var t=J(e),n=.5*(e.pageX+t.x),a=.5*(e.pageY+t.y);j.set(n,a)}O.subVectors(j,g).multiplyScalar(i.panSpeed),_(O.x,O.y),g.copy(j)}function V(e){var t=J(e),n=e.pageX-t.x,a=e.pageY-t.y,r=Math.sqrt(n*n+a*a);y.set(0,r),w.set(0,Math.pow(y.y/x.y,i.zoomSpeed)),N(w.y),x.copy(y)}function F(e){!1!==i.enabled&&(0===S.length&&(i.domElement.setPointerCapture(e.pointerId),i.domElement.addEventListener("pointermove",U),i.domElement.addEventListener("pointerup",W)),function(e){S.push(e)}(e),"touch"===e.pointerType?function(e){switch(X(e),S.length){case 1:switch(i.touches.ONE){case Is.x.ROTATE:if(!1===i.enableRotate)return;L(),c=o.TOUCH_ROTATE;break;case Is.x.PAN:if(!1===i.enablePan)return;D(),c=o.TOUCH_PAN;break;default:c=o.NONE}break;case 2:switch(i.touches.TWO){case Is.x.DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;i.enableZoom&&z(),i.enablePan&&D(),c=o.TOUCH_DOLLY_PAN;break;case Is.x.DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;i.enableZoom&&z(),i.enableRotate&&L(),c=o.TOUCH_DOLLY_ROTATE;break;default:c=o.NONE}break;default:c=o.NONE}c!==o.NONE&&i.dispatchEvent(Ns)}(e):function(e){var t;switch(e.button){case 0:t=i.mouseButtons.LEFT;break;case 1:t=i.mouseButtons.MIDDLE;break;case 2:t=i.mouseButtons.RIGHT;break;default:t=-1}switch(t){case Is.l.DOLLY:if(!1===i.enableZoom)return;!function(e){x.set(e.clientX,e.clientY)}(e),c=o.DOLLY;break;case Is.l.ROTATE:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===i.enablePan)return;R(e),c=o.PAN}else{if(!1===i.enableRotate)return;A(e),c=o.ROTATE}break;case Is.l.PAN:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===i.enableRotate)return;A(e),c=o.ROTATE}else{if(!1===i.enablePan)return;R(e),c=o.PAN}break;default:c=o.NONE}c!==o.NONE&&i.dispatchEvent(Ns)}(e))}function U(e){!1!==i.enabled&&("touch"===e.pointerType?function(e){switch(X(e),c){case o.TOUCH_ROTATE:if(!1===i.enableRotate)return;G(e),i.update();break;case o.TOUCH_PAN:if(!1===i.enablePan)return;B(e),i.update();break;case o.TOUCH_DOLLY_PAN:if(!1===i.enableZoom&&!1===i.enablePan)return;!function(e){i.enableZoom&&V(e),i.enablePan&&B(e)}(e),i.update();break;case o.TOUCH_DOLLY_ROTATE:if(!1===i.enableZoom&&!1===i.enableRotate)return;!function(e){i.enableZoom&&V(e),i.enableRotate&&G(e)}(e),i.update();break;default:c=o.NONE}}(e):function(e){switch(c){case o.ROTATE:if(!1===i.enableRotate)return;!function(e){b.set(e.clientX,e.clientY),v.subVectors(b,h).multiplyScalar(i.rotateSpeed);var t=i.domElement;k(2*Math.PI*v.x/t.clientHeight),E(2*Math.PI*v.y/t.clientHeight),h.copy(b),i.update()}(e);break;case o.DOLLY:if(!1===i.enableZoom)return;!function(e){y.set(e.clientX,e.clientY),w.subVectors(y,x),w.y>0?N(P()):w.y<0&&M(P()),x.copy(y),i.update()}(e);break;case o.PAN:if(!1===i.enablePan)return;!function(e){j.set(e.clientX,e.clientY),O.subVectors(j,g).multiplyScalar(i.panSpeed),_(O.x,O.y),g.copy(j),i.update()}(e)}}(e))}function W(e){q(e),0===S.length&&(i.domElement.releasePointerCapture(e.pointerId),i.domElement.removeEventListener("pointermove",U),i.domElement.removeEventListener("pointerup",W)),i.dispatchEvent(Ms),c=o.NONE}function K(e){q(e)}function H(e){!1!==i.enabled&&!1!==i.enableZoom&&c===o.NONE&&(e.preventDefault(),i.dispatchEvent(Ns),function(e){e.deltaY<0?M(P()):e.deltaY>0&&N(P()),i.update()}(e),i.dispatchEvent(Ms))}function Z(e){!1!==i.enabled&&!1!==i.enablePan&&function(e){var t=!1;switch(e.code){case i.keys.UP:_(0,i.keyPanSpeed),t=!0;break;case i.keys.BOTTOM:_(0,-i.keyPanSpeed),t=!0;break;case i.keys.LEFT:_(i.keyPanSpeed,0),t=!0;break;case i.keys.RIGHT:_(-i.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),i.update())}(e)}function Y(e){!1!==i.enabled&&e.preventDefault()}function q(e){delete T[e.pointerId];for(var t=0;t<S.length;t++)if(S[t].pointerId===e.pointerId)return void S.splice(t,1)}function X(e){var t=T[e.pointerId];void 0===t&&(t=new Is.B,T[e.pointerId]=t),t.set(e.pageX,e.pageY)}function J(e){var t=e.pointerId===S[0].pointerId?S[1]:S[0];return T[t.pointerId]}return i.domElement.addEventListener("contextmenu",Y),i.domElement.addEventListener("pointerdown",F),i.domElement.addEventListener("pointercancel",K),i.domElement.addEventListener("wheel",H,{passive:!1}),r.update(),r}return Object(m.a)(n)}(Is.g),Rs={uniforms:{u_size:{value:new Is.C(1,1,1)},u_renderstyle:{value:0},u_renderthreshold:{value:.5},u_clim:{value:new Is.B(0,1)},u_data:{value:null},u_cmdata:{value:null}},vertexShader:'\n\n        varying vec4 v_nearpos;\n        varying vec4 v_farpos;\n        varying vec3 v_position;\n\n        void main() {\n            // Prepare transforms to map to "camera view". See also:\n            // https://threejs.org/docs/#api/renderers/webgl/WebGLProgram\n            mat4 viewModelMatrix = inverse(modelViewMatrix);\n\n            // Project local vertex coordinate to camera position. Then do a step\n            // backward (in cam coords) to the near clipping plane, and project back. Do\n            // the same for the far clipping plane. This gives us all the information we\n            // need to calculate the ray and truncate it to the viewing cone.\n            vec4 position4 = vec4(position, 1.0);\n            vec4 pos_in_cam = modelViewMatrix * position4;\n\n            // Intersection of ray and near clipping plane (z = -1 in clip coords)\n            pos_in_cam.z = -pos_in_cam.w;\n            // pos_in_cam.w = 1.0;\n            // pos_in_cam.z = -1.0;\n            v_nearpos = viewModelMatrix * pos_in_cam;\n\n            // Intersection of ray and far clipping plane (z = +1 in clip coords)\n            pos_in_cam.z = pos_in_cam.w;\n            // pos_in_cam.z = 1.0;\n            v_farpos = viewModelMatrix * pos_in_cam;\n\n            // Set varyings and output pos\n            v_position = position;\n            gl_Position = projectionMatrix * viewMatrix * modelMatrix * position4;\n        }',fragmentShader:"\n\n        precision highp float;\n        precision mediump sampler3D;\n\n        uniform vec3 u_size;\n        uniform int u_renderstyle;\n        uniform float u_renderthreshold;\n        uniform vec2 u_clim;\n\n        uniform sampler3D u_data;\n        uniform sampler2D u_cmdata;\n\n        varying vec3 v_position;\n        varying vec4 v_nearpos;\n        varying vec4 v_farpos;\n\n        // The maximum distance through our rendering volume is sqrt(3).\n        const int MAX_STEPS = 2000; // 887; // 887 for 512^3, 1774 for 1024^3\n        const int REFINEMENT_STEPS = 8; // 4;\n        const float relative_step_size = 1.0;\n        const vec4 ambient_color = vec4(0.2, 0.4, 0.2, 1.0);\n        const vec4 diffuse_color = vec4(0.8, 0.2, 0.2, 1.0);\n        const vec4 specular_color = vec4(1.0, 1.0, 1.0, 1.0);\n        const float shininess = 40.0;\n\n        void cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);\n        void cast_aip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);\n        void cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray);\n\n        float sample1(vec3 texcoords);\n        vec4 apply_colormap(float val);\n        vec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray);\n\n        void main() {\n            // Normalize clipping plane info\n            vec3 farpos = v_farpos.xyz / v_farpos.w;\n            vec3 nearpos = v_nearpos.xyz / v_nearpos.w;\n\n            // Calculate unit vector pointing in the view direction through this fragment.\n            vec3 view_ray = normalize(nearpos.xyz - farpos.xyz);\n\n            // Compute the (negative) distance to the front surface or near clipping plane.\n            // v_position is the back face of the cuboid, so the initial distance calculated in the dot\n            // product below is the distance from near clip plane to the back of the cuboid\n            float distance = dot(nearpos - v_position, view_ray);\n            distance = max(distance, min((-0.5 - v_position.x) / view_ray.x,\n                                         (u_size.x - 0.5 - v_position.x) / view_ray.x));\n            distance = max(distance, min((-0.5 - v_position.y) / view_ray.y,\n                                         (u_size.y - 0.5 - v_position.y) / view_ray.y));\n            distance = max(distance, min((-0.5 - v_position.z) / view_ray.z,\n                                         (u_size.z - 0.5 - v_position.z) / view_ray.z));\n\n            // Now we have the starting position on the front surface\n            vec3 front = v_position + view_ray * distance;\n\n            // Decide how many steps to take\n            int nsteps = int(-distance / relative_step_size + 0.5);\n            if ( nsteps < 1 )\n                discard;\n\n            // Get starting location and step vector in texture coordinates\n            vec3 step = ((v_position - front) / u_size) / float(nsteps);\n            vec3 start_loc = front / u_size;\n\n            // For testing: show the number of steps. This helps to establish\n            // whether the rays are correctly oriented\n            //'gl_FragColor = vec4(0.0, float(nsteps) / 1.0 / u_size.x, 1.0, 1.0);\n            //'return;\n\n            if (u_renderstyle == 0)\n                cast_mip(start_loc, step, nsteps, view_ray);\n            else if (u_renderstyle == 1)\n                cast_aip(start_loc, step, nsteps, view_ray);\n            else if (u_renderstyle == 2)\n                cast_iso(start_loc, step, nsteps, view_ray);\n\n            if (gl_FragColor.a < 0.05)\n                discard;\n        }\n\n        float sample1(vec3 texcoords) {\n            /* Sample float value from a 3D texture. Assumes intensity data. */\n            return texture(u_data, texcoords.xyz).r;\n        }\n\n        vec4 apply_colormap(float val) {\n            val = (val - u_clim[0]) / (u_clim[1] - u_clim[0]);\n            return texture2D(u_cmdata, vec2(val, 0.5));\n        }\n\n        void cast_mip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {\n\n            float max_val = -1e6;\n            vec3 loc = start_loc;\n\n            // Enter the raycasting loop. In WebGL 1 the loop index cannot be compared with\n            // non-constant expression. So we use a hard-coded max, and an additional condition\n            // inside the loop.\n            for (int iter = 0; iter < MAX_STEPS; iter++) {\n                if (iter >= nsteps) {\n                    break;\n                }\n                // Sample from the 3D texture\n                float val = sample1(loc);\n                // Apply MIP operation\n                if (val > max_val) {\n                    max_val = val;\n                }\n                // Advance location deeper into the volume\n                loc += step;\n            }\n\n            // Resolve final color\n            gl_FragColor = apply_colormap(max_val);\n        }\n\n        void cast_aip(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {\n\n            float avg_val = 0.0;\n            int count = 0;\n            vec3 loc = start_loc;\n            float eps = 0.02;\n\n            // Enter the raycasting loop. In WebGL 1 the loop index cannot be compared with\n            // non-constant expression. So we use a hard-coded max, and an additional condition\n            // inside the loop.\n            for (int iter = 0; iter < MAX_STEPS; iter++) {\n                if (iter >= nsteps) {\n                    break;\n                }\n                // Sample from the 3D texture\n                float val = sample1(loc);\n                // Apply SUM operation   \n                if (abs(loc.x - 0.5) < eps \n                    || abs(loc.y - 0.5) < eps \n                    || abs(loc.z - 0.5) < eps) {\n                    avg_val += val;\n                    count += 1;\n                }          \n                // Advance location deeper into the volume\n                loc += step;\n            }\n\n            // Resolve final color\n            if (count > 0) {\n                gl_FragColor = apply_colormap(avg_val / float(count));\n            } else {\n                gl_FragColor = vec4(0.0);\n            }\n        }\n\n        void cast_iso(vec3 start_loc, vec3 step, int nsteps, vec3 view_ray) {\n\n            gl_FragColor = vec4(0.0);    // init transparent\n            vec4 color3 = vec4(0.0);    // final color\n            vec3 dstep = 1.5 / u_size;    // step to sample derivative\n            vec3 loc = start_loc;\n\n            float low_threshold = u_renderthreshold - 0.02 * (u_clim[1] - u_clim[0]);\n\n            // Enter the raycasting loop. In WebGL 1 the loop index cannot be compared with\n            // non-constant expression. So we use a hard-coded max, and an additional condition\n            // inside the loop.\n            for (int iter=0; iter<MAX_STEPS; iter++) {\n                if (iter >= nsteps)\n                    break;\n\n                // Sample from the 3D texture\n                float val = sample1(loc);\n\n                if (val > low_threshold) {\n                    // Take the last interval in smaller steps\n                    vec3 iloc = loc - 0.5 * step;\n                    vec3 istep = step / float(REFINEMENT_STEPS);\n                    for (int i=0; i<REFINEMENT_STEPS; i++) {\n                        val = sample1(iloc);\n                        if (val > u_renderthreshold) {\n                            gl_FragColor = add_lighting(val, iloc, dstep, view_ray);\n                            return;\n                        }\n                        iloc += istep;\n                    }\n                }\n\n                // Advance location deeper into the volume\n                loc += step;\n            }\n        }\n\n        vec4 add_lighting(float val, vec3 loc, vec3 step, vec3 view_ray) {\n            // Calculate color by incorporating lighting\n\n            // View direction\n            vec3 V = normalize(view_ray);\n\n            // calculate normal vector from gradient\n            vec3 N;\n            float val1, val2;\n            val1 = sample1(loc + vec3(-step[0], 0.0, 0.0));\n            val2 = sample1(loc + vec3(+step[0], 0.0, 0.0));\n            N[0] = val1 - val2;\n            val = max(max(val1, val2), val);\n            val1 = sample1(loc + vec3(0.0, -step[1], 0.0));\n            val2 = sample1(loc + vec3(0.0, +step[1], 0.0));\n            N[1] = val1 - val2;\n            val = max(max(val1, val2), val);\n            val1 = sample1(loc + vec3(0.0, 0.0, -step[2]));\n            val2 = sample1(loc + vec3(0.0, 0.0, +step[2]));\n            N[2] = val1 - val2;\n            val = max(max(val1, val2), val);\n\n            float gm = length(N); // gradient magnitude\n            N = normalize(N);\n\n            // Flip normal so it points towards viewer\n            float Nselect = float(dot(N, V) > 0.0);\n            N = (2.0 * Nselect - 1.0) * N;    // ==    Nselect * N - (1.0-Nselect)*N;\n\n            // Init colors\n            vec4 ambient_color = vec4(0.0, 0.0, 0.0, 0.0);\n            vec4 diffuse_color = vec4(0.0, 0.0, 0.0, 0.0);\n            vec4 specular_color = vec4(0.0, 0.0, 0.0, 0.0);\n\n            // note: could allow multiple lights\n            for (int i=0; i<1; i++) {\n                 // Get light direction (make sure to prevent zero devision)\n                vec3 L = normalize(view_ray);    //lightDirs[i];\n                float lightEnabled = float( length(L) > 0.0 );\n                L = normalize(L + (1.0 - lightEnabled));\n\n                // Calculate lighting properties\n                float lambertTerm = clamp(dot(N, L), 0.0, 1.0);\n                vec3 H = normalize(L+V); // Halfway vector\n                float specularTerm = pow(max(dot(H, N), 0.0), shininess);\n\n                // Calculate mask\n                float mask1 = lightEnabled;\n\n                // Calculate colors\n                ambient_color +=    mask1 * ambient_color;    // * gl_LightSource[i].ambient;\n                diffuse_color +=    mask1 * lambertTerm;\n                specular_color += mask1 * specularTerm * specular_color;\n            }\n\n            // Calculate final color by componing different components\n            vec4 final_color;\n            vec4 color = apply_colormap(val);\n            final_color = color * (ambient_color + diffuse_color) + specular_color;\n            final_color.a = color.a;\n            return final_color;\n        }"};var Ls=new(function(){function e(){Object(p.a)(this,e),this.textures=void 0,this.textures={}}return Object(m.a)(e,[{key:"get",value:function(e,t){var n=pn(e),a=this.textures[n];return a||(a=(new Is.z).load("data:image/png;base64,".concat(e.imageData),t),this.textures[n]=a),a}}]),e}()),Ds=function(){function e(t){if(Object(p.a)(this,e),this.canvas=void 0,this.camera=void 0,this.controls=void 0,this.renderer=void 0,this.scene=void 0,this.texture=void 0,this.material=void 0,!function(){try{var e=document.createElement("canvas");return!(!window.WebGL2RenderingContext||!e.getContext("webgl2"))}catch(t){return!1}}())throw new Error("Missing WebGL2");this.render=this.render.bind(this);var n=new Is.D({canvas:t});n.setPixelRatio(window.devicePixelRatio),n.setSize(t.clientWidth,t.clientHeight);var a=100,r=t.clientWidth/t.clientHeight,i=new Is.q(-a*r,a*r,a,-a,-1e3,1e3);i.position.set(0,0,100),i.up.set(0,1,0);var o=new As(i,n.domElement);o.target.set(100,50,0),o.minZoom=.1,o.maxZoom=500,o.enablePan=!0,o.update(),this.canvas=t,this.renderer=n,this.camera=i,this.controls=o,this.scene=null,this.texture=null,this.material=null,o.addEventListener("change",this.render),t.addEventListener("resize",this.onCanvasResize)}return Object(m.a)(e,[{key:"setVolume",value:function(e,t){var n=new Is.e(e.data,e.xLength,e.yLength,e.zLength);n.format=Is.t,n.type=Is.i,n.minFilter=n.magFilter=Is.j,n.unpackAlignment=1,n.needsUpdate=!0;var a=Rs,r=Is.A.clone(a.uniforms),i=Object(G.a)(e.spacing,3),o=i[0],c=i[1],s=i[2],l=Math.floor(o*e.xLength),u=Math.floor(c*e.yLength),d=Math.floor(s*e.zLength);r.u_data.value=n,r.u_size.value.set(l,u,d);var p=new Is.v({uniforms:r,vertexShader:a.vertexShader,fragmentShader:a.fragmentShader,side:Is.a}),m=new Is.b(l,u,d);m.translate(l/2,u/2,d/2);var f=new Is.o(m,p),h=new Is.u;h.add(f),h.add(new Is.c(f)),this.scene=h,this.material=p,this.texture=n,this.setVolumeOptions(t)}},{key:"setVolumeOptions",value:function(e){var t=this.material;if(null!==t){var n=e.value1,a=e.value2,r=e.isoThreshold,i=e.renderMode,o=e.colorBar,c=t.uniforms;c.u_clim.value.set(n,a),c.u_renderthreshold.value=r,c.u_renderstyle.value="mip"===i?0:"aip"===i?1:2,c.u_cmdata.value=Ls.get(o,this.render),this.render()}}},{key:"getMaterial",value:function(){if(null===this.material)throw new Error("Volume not set!");return this.material}},{key:"onCanvasResize",value:function(){console.warn("Alarm: Canvas resize!");var e=this.renderer.domElement;this.renderer.setSize(e.clientWidth,e.clientHeight);var t=e.clientWidth/e.clientHeight,n=this.camera.top-this.camera.bottom;this.camera.left=-n*t/2,this.camera.right=n*t/2,this.camera.updateProjectionMatrix(),this.render()}},{key:"render",value:function(){null!==this.scene&&this.renderer.render(this.scene,this.camera)}}]),e}(),zs=n(616),Gs=function(){function e(t,n,a){Object(p.a)(this,e);var r=this;this.volume=t,n=n||0,Object.defineProperty(this,"index",{get:function(){return n},set:function(e){return n=e,r.geometryNeedsUpdate=!0,n}}),this.axis=a||"z",this.canvas=document.createElement("canvas"),this.canvasBuffer=document.createElement("canvas"),this.updateGeometry();var i=new Is.y(this.canvas);i.minFilter=Is.j,i.wrapS=i.wrapT=Is.d;var o=new Is.p({map:i,side:Is.f,transparent:!0});this.mesh=new Is.o(this.geometry,o),this.mesh.matrixAutoUpdate=!1,this.geometryNeedsUpdate=!0,this.repaint()}return Object(m.a)(e,[{key:"repaint",value:function(){this.geometryNeedsUpdate&&this.updateGeometry();var e=this.iLength,t=this.jLength,n=this.sliceAccess,a=this.volume,r=this.canvasBuffer,i=this.ctxBuffer,o=i.getImageData(0,0,e,t),c=o.data,s=a.data,l=a.upperThreshold,u=a.lowerThreshold,d=a.windowLow,p=a.windowHigh,m=0;if("label"===a.dataType)for(var f=0;f<t;f++)for(var h=0;h<e;h++){var b=s[n(h,f)];b=b>=this.colorMap.length?b%this.colorMap.length+1:b;var v=this.colorMap[b];c[4*m]=v>>24&255,c[4*m+1]=v>>16&255,c[4*m+2]=v>>8&255,c[4*m+3]=255&v,m++}else for(var g=0;g<t;g++)for(var j=0;j<e;j++){var O=s[n(j,g)],x=255;x=l>=O&&u<=O?x:0,O=(O=Math.floor(255*(O-d)/(p-d)))>255?255:O<0?0:0|O,c[4*m]=O,c[4*m+1]=O,c[4*m+2]=O,c[4*m+3]=x,m++}i.putImageData(o,0,0),this.ctx.drawImage(r,0,0,e,t,0,0,this.canvas.width,this.canvas.height),this.mesh.material.map.needsUpdate=!0}},{key:"updateGeometry",value:function(){var e=this.volume.extractPerpendicularPlane(this.axis,this.index);this.sliceAccess=e.sliceAccess,this.jLength=e.jLength,this.iLength=e.iLength,this.matrix=e.matrix,this.canvas.width=e.planeWidth,this.canvas.height=e.planeHeight,this.canvasBuffer.width=this.iLength,this.canvasBuffer.height=this.jLength,this.ctx=this.canvas.getContext("2d"),this.ctxBuffer=this.canvasBuffer.getContext("2d"),this.geometry&&this.geometry.dispose(),this.geometry=new Is.r(e.planeWidth,e.planeHeight),this.mesh&&(this.mesh.geometry=this.geometry,this.mesh.matrix.identity(),this.mesh.applyMatrix4(this.matrix)),this.geometryNeedsUpdate=!1}}]),e}(),Bs=function(){function e(t,n,a,r,i){if(Object(p.a)(this,e),void 0!==t){switch(this.xLength=Number(t)||1,this.yLength=Number(n)||1,this.zLength=Number(a)||1,this.axisOrder=["x","y","z"],r){case"Uint8":case"uint8":case"uchar":case"unsigned char":case"uint8_t":default:this.data=new Uint8Array(i);break;case"Int8":case"int8":case"signed char":case"int8_t":this.data=new Int8Array(i);break;case"Int16":case"int16":case"short":case"short int":case"signed short":case"signed short int":case"int16_t":this.data=new Int16Array(i);break;case"Uint16":case"uint16":case"ushort":case"unsigned short":case"unsigned short int":case"uint16_t":this.data=new Uint16Array(i);break;case"Int32":case"int32":case"int":case"signed int":case"int32_t":this.data=new Int32Array(i);break;case"Uint32":case"uint32":case"uint":case"unsigned int":case"uint32_t":this.data=new Uint32Array(i);break;case"longlong":case"long long":case"long long int":case"signed long long":case"signed long long int":case"int64":case"int64_t":case"ulonglong":case"unsigned long long":case"unsigned long long int":case"uint64":case"uint64_t":throw new Error("Error in Volume constructor : this type is not supported in JavaScript");case"Float32":case"float32":case"float":this.data=new Float32Array(i);break;case"Float64":case"float64":case"double":this.data=new Float64Array(i)}if(this.data.length!==this.xLength*this.yLength*this.zLength)throw new Error("Error in Volume constructor, lengths are not matching arrayBuffer size")}this.spacing=[1,1,1],this.offset=[0,0,0],this.matrix=new Is.m,this.matrix.identity();var o=-1/0;Object.defineProperty(this,"lowerThreshold",{get:function(){return o},set:function(e){o=e,this.sliceList.forEach((function(e){e.geometryNeedsUpdate=!0}))}});var c=1/0;Object.defineProperty(this,"upperThreshold",{get:function(){return c},set:function(e){c=e,this.sliceList.forEach((function(e){e.geometryNeedsUpdate=!0}))}}),this.sliceList=[]}return Object(m.a)(e,[{key:"getData",value:function(e,t,n){return this.data[n*this.xLength*this.yLength+t*this.xLength+e]}},{key:"access",value:function(e,t,n){return n*this.xLength*this.yLength+t*this.xLength+e}},{key:"reverseAccess",value:function(e){var t=Math.floor(e/(this.yLength*this.xLength)),n=Math.floor((e-t*this.yLength*this.xLength)/this.xLength);return[e-t*this.yLength*this.xLength-n*this.xLength,n,t]}},{key:"map",value:function(e,t){var n=this.data.length;t=t||this;for(var a=0;a<n;a++)this.data[a]=e.call(t,this.data[a],a,this.data);return this}},{key:"extractPerpendicularPlane",value:function(e,t){var n,a,r,i,o=new Is.C,c=new Is.C,s=new Is.C,l=(new Is.n).identity(),u=this,d=new Is.C(this.xLength,this.yLength,this.zLength);switch(e){case"x":o.set(1,0,0),c.set(0,0,-1),s.set(0,-1,0),n=this.spacing[this.axisOrder.indexOf("z")],a=this.spacing[this.axisOrder.indexOf("y")],i=new Is.C(t,0,0),l.multiply((new Is.n).makeRotationY(Math.PI/2)),r=(u.RASDimensions[0]-1)/2,l.setPosition(new Is.C(t-r,0,0));break;case"y":o.set(0,1,0),c.set(1,0,0),s.set(0,0,1),n=this.spacing[this.axisOrder.indexOf("x")],a=this.spacing[this.axisOrder.indexOf("z")],i=new Is.C(0,t,0),l.multiply((new Is.n).makeRotationX(-Math.PI/2)),r=(u.RASDimensions[1]-1)/2,l.setPosition(new Is.C(0,t-r,0));break;default:o.set(0,0,1),c.set(1,0,0),s.set(0,-1,0),n=this.spacing[this.axisOrder.indexOf("x")],a=this.spacing[this.axisOrder.indexOf("y")],i=new Is.C(0,0,t),r=(u.RASDimensions[2]-1)/2,l.setPosition(new Is.C(0,0,t-r))}c.applyMatrix4(u.inverseMatrix).normalize(),c.arglet="i",s.applyMatrix4(u.inverseMatrix).normalize(),s.arglet="j",o.applyMatrix4(u.inverseMatrix).normalize();var p=Math.floor(Math.abs(c.dot(d))),m=Math.floor(Math.abs(s.dot(d))),f=Math.abs(p*n),h=Math.abs(m*a);i=Math.abs(Math.round(i.applyMatrix4(u.inverseMatrix).dot(o)));var b=[new Is.C(1,0,0),new Is.C(0,1,0),new Is.C(0,0,1)],v=[c,s,o].find((function(e){return Math.abs(e.dot(b[0]))>.9})),g=[c,s,o].find((function(e){return Math.abs(e.dot(b[1]))>.9})),j=[c,s,o].find((function(e){return Math.abs(e.dot(b[2]))>.9}));return{iLength:p,jLength:m,sliceAccess:function(e,t){var n=v===o?i:"i"===v.arglet?e:t,a=g===o?i:"i"===g.arglet?e:t,r=j===o?i:"i"===j.arglet?e:t,c=v.dot(b[0])>0?n:u.xLength-1-n,s=g.dot(b[1])>0?a:u.yLength-1-a,l=j.dot(b[2])>0?r:u.zLength-1-r;return u.access(c,s,l)},matrix:l,planeWidth:f,planeHeight:h}}},{key:"extractSlice",value:function(e,t){var n=new Gs(this,t,e);return this.sliceList.push(n),n}},{key:"repaintAllSlices",value:function(){return this.sliceList.forEach((function(e){e.repaint()})),this}},{key:"computeMinMax",value:function(){var e=1/0,t=-1/0,n=this.data.length,a=0;for(a=0;a<n;a++)if(!isNaN(this.data[a])){var r=this.data[a];e=Math.min(e,r),t=Math.max(t,r)}return this.min=e,this.max=t,[e,t]}}]),e}(),Vs=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){return Object(p.a)(this,n),t.call(this,e)}return Object(m.a)(n,[{key:"load",value:function(e,t,n,a){var r=this,i=new Is.h(r.manager);i.setPath(r.path),i.setResponseType("arraybuffer"),i.setRequestHeader(r.requestHeader),i.setWithCredentials(r.withCredentials),i.load(e,(function(n){try{t(r.parse(n))}catch(i){a?a(i):console.error(i),r.manager.itemError(e)}}),n,a)}},{key:"parse",value:function(e){var t=e,n=0,a=new Int8Array(new Int16Array([1]).buffer)[0]>0,r={};var i,o=function(e,r){void 0!==r&&null!==r||(r=1);var i=1,o=Uint8Array;switch(e){case"uchar":break;case"schar":o=Int8Array;break;case"ushort":o=Uint16Array,i=2;break;case"sshort":o=Int16Array,i=2;break;case"uint":o=Uint32Array,i=4;break;case"sint":o=Int32Array,i=4;break;case"float":o=Float32Array,i=4;break;case"complex":case"double":o=Float64Array,i=8}var c=new o(t.slice(n,n+=r*i));return true!==a&&(c=function(e,t){for(var n=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),a=0;a<e.byteLength;a+=t)for(var r=a+t-1,i=a;r>i;r--,i++){var o=n[i];n[i]=n[r],n[r]=o}return e}(c,i)),1===r?c[0]:c}("uchar",e.byteLength),c=o.length,s=null,l=0;for(i=1;i<c;i++)if(10===o[i-1]&&10===o[i]){s=this.parseChars(o,0,i-2),l=i+1;break}if(function(e){var t,n,a,i,o,c,s,l,u=e.split(/\r?\n/);for(s=0,l=u.length;s<l;s++)(o=u[s]).match(/NRRD\d+/)?r.isNrrd=!0:!o.match(/^#/)&&(c=o.match(/(.*):(.*)/))&&(n=c[1].trim(),t=c[2].trim(),(a=Fs[n])?a.call(r,t):r[n]=t);if(!r.isNrrd)throw new Error("Not an NRRD file");if("bz2"===r.encoding||"bzip2"===r.encoding)throw new Error("Bzip is not supported");if(!r.vectors&&(r.vectors=[],r.vectors.push([1,0,0]),r.vectors.push([0,1,0]),r.vectors.push([0,0,1]),r.spacings))for(i=0;i<=2;i++)if(!isNaN(r.spacings[i]))for(var d=0;d<=2;d++)r.vectors[i][d]*=r.spacings[i]}(s),t=o.subarray(l),"gz"===r.encoding.substring(0,2))t=zs.a(new Uint8Array(t));else if("ascii"===r.encoding||"text"===r.encoding||"txt"===r.encoding||"hex"===r.encoding)t=function(e,t,n){var a,i="";t=t||0,n=n||e.length;var o=r.sizes.reduce((function(e,t){return e*t}),1),c=10;"hex"===r.encoding&&(c=16);var s=new r.__array(o),l=0,u=parseInt;r.__array!==Float32Array&&r.__array!==Float64Array||(u=parseFloat);for(var d=t;d<n;d++)((a=e[d])<9||a>13)&&32!==a?i+=String.fromCharCode(a):(""!==i&&(s[l]=u(i,c),l++),i="");return""!==i&&(s[l]=u(i,c),l++),s}(t);else if("raw"===r.encoding){for(var u=new Uint8Array(t.length),d=0;d<t.length;d++)u[d]=t[d];t=u}t=t.buffer;var p=new Bs;p.header=r,p.data=new r.__array(t);var m=p.computeMinMax(),f=m[0],h=m[1];if(p.windowLow=f,p.windowHigh=h,p.dimensions=[r.sizes[0],r.sizes[1],r.sizes[2]],p.xLength=p.dimensions[0],p.yLength=p.dimensions[1],p.zLength=p.dimensions[2],r.vectors){var b=r.vectors.findIndex((function(e){return 0!==e[0]})),v=r.vectors.findIndex((function(e){return 0!==e[1]})),g=r.vectors.findIndex((function(e){return 0!==e[2]})),j=[];j[b]="x",j[v]="y",j[g]="z",p.axisOrder=j}else p.axisOrder=["x","y","z"];var O=(new Is.C).fromArray(r.vectors[0]).length(),x=(new Is.C).fromArray(r.vectors[1]).length(),y=(new Is.C).fromArray(r.vectors[2]).length();p.spacing=[O,x,y],p.matrix=new Is.n;var w=new Is.n;if("left-posterior-superior"===r.space?w.set(-1,0,0,0,0,-1,0,0,0,0,1,0,0,0,0,1):"left-anterior-superior"===r.space&&w.set(1,0,0,0,0,1,0,0,0,0,-1,0,0,0,0,1),r.vectors){var S=r.vectors,T=(new Is.n).set(S[0][0],S[1][0],S[2][0],0,S[0][1],S[1][1],S[2][1],0,S[0][2],S[1][2],S[2][2],0,0,0,0,1);p.matrix=(new Is.n).multiplyMatrices(T,w)}else p.matrix.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1);return p.inverseMatrix=new Is.n,p.inverseMatrix.copy(p.matrix).invert(),p.RASDimensions=new Is.C(p.xLength,p.yLength,p.zLength).applyMatrix4(p.matrix).round().toArray().map(Math.abs),p.lowerThreshold===-1/0&&(p.lowerThreshold=f),p.upperThreshold===1/0&&(p.upperThreshold=h),p}},{key:"parseChars",value:function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=e.length);var a,r="";for(a=t;a<n;++a)r+=String.fromCharCode(e[a]);return r}}]),n}(Is.k),Fs={type:function(e){switch(e){case"uchar":case"unsigned char":case"uint8":case"uint8_t":this.__array=Uint8Array;break;case"signed char":case"int8":case"int8_t":this.__array=Int8Array;break;case"short":case"short int":case"signed short":case"signed short int":case"int16":case"int16_t":this.__array=Int16Array;break;case"ushort":case"unsigned short":case"unsigned short int":case"uint16":case"uint16_t":this.__array=Uint16Array;break;case"int":case"signed int":case"int32":case"int32_t":this.__array=Int32Array;break;case"uint":case"unsigned int":case"uint32":case"uint32_t":this.__array=Uint32Array;break;case"float":this.__array=Float32Array;break;case"double":this.__array=Float64Array;break;default:throw new Error("Unsupported NRRD data type: "+e)}return this.type=e},endian:function(e){return this.endian=e},encoding:function(e){return this.encoding=e},dimension:function(e){return this.dim=parseInt(e,10)},sizes:function(e){var t;return this.sizes=function(){for(var n=e.split(/\s+/),a=[],r=0,i=n.length;r<i;r++)t=n[r],a.push(parseInt(t,10));return a}()},space:function(e){return this.space=e},"space origin":function(e){return this.space_origin=e.split("(")[1].split(")")[0].split(",")},"space directions":function(e){var t,n,a=e.match(/\(.*?\)/g);return this.vectors=function(){for(var e=[],r=0,i=a.length;r<i;r++)n=a[r],e.push(function(){for(var e=n.slice(1,-1).split(/,/),a=[],r=0,i=e.length;r<i;r++)t=e[r],a.push(parseFloat(t));return a}());return e}()},spacings:function(e){var t,n=e.split(/\s+/);return this.spacings=function(){for(var e=[],a=0,r=n.length;a<r;a++)t=n[a],e.push(parseFloat(t));return e}()}},Us=(n(958),{width:"100%",height:"680px"}),Ws={width:"100%",display:"flex",justifyContent:"center",margin:"1em",flexDirection:"column",alignItems:"center"},Ks=Object(He.jsx)(Kr.a,{variant:"body2",style:{color:"orange",position:"absolute",bottom:8,right:8,zIndex:10},className:"hint_wrap",children:"Press LMB to rotate, plus CTRL-key to shift."}),Hs={position:"relative"},Zs={},Ys=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).volumeScene=void 0,a.canvasRef=void 0,a.canvasRef=r.a.createRef(),a.volumeScene=null,a.handleLoadVolume=a.handleLoadVolume.bind(Object(Cs.a)(a)),a}return Object(m.a)(n,[{key:"componentDidMount",value:function(){this.updateVolumeScene()}},{key:"componentDidUpdate",value:function(e){this.updateVolumeScene()}},{key:"componentWillUnmount",value:function(){this.volumeScene=null}},{key:"handleLoadVolume",value:function(){var e=this,t=this.volumeScene;if(null!==t){var a=this.props,r=a.selectedDataset,i=a.selectedVariable,o=a.selectedPlaceInfo,c=a.volumeId,s=a.updateVolumeState;if(r&&i&&c){s(c,{status:"loading"});var l="";if(o){var d=null;if("Polygon"===o.place.geometry.type)d=qs(o.place.geometry.coordinates[0]);else if("MultiPolygon"===o.place.geometry.type){for(var p=[],m=0;m<o.place.geometry.coordinates.length;m++)p.push(qs(o.place.geometry.coordinates[m][0]));d=function(e){var t,n=Object(G.a)(e[0],4),a=n[0],r=n[1],i=n[2],o=n[3],c=Object(u.a)(e.slice(1));try{for(c.s();!(t=c.n()).done;){var s=t.value;a=Math.min(a,s[0]),r=Math.min(r,s[1]),i=Math.max(i,s[2]),o=Math.max(o,s[3])}}catch(l){c.e(l)}finally{c.f()}return[a,r,i,o]}(p)}null!==d&&(l="&bbox=".concat(d[0],",").concat(d[1],",").concat(d[2],",").concat(d[3]))}var f="dummy=".concat((new Date).toLocaleTimeString()),h="".concat(this.props.serverUrl,"/volumes/")+"".concat(r.id,"/").concat(i.name)+"?".concat(f).concat(l);(new Vs).load(h,(function(a){t.setVolume(a,n.getVolumeOptions(e.props)),Zs[c]=a,s(c,{status:"ok"})}),(function(){}),(function(e){e.response instanceof Response?e.response.json().then((function(t){var n=t.error,a=!!n&&n.message;n&&n.exception&&console.debug("exception:",n.exception),s(c,{status:"error",message:a||"".concat(e)})})):s(c,{status:"error",message:"".concat(e)})}))}}}},{key:"render",value:function(){var e,t,n=this.props.volumeId;if(n){var a=this.props.volumeStates[n];a&&"error"!==a.status&&Zs[n]||(t=[Object(He.jsx)(si.a,{onClick:this.handleLoadVolume,color:"primary",disabled:!!a&&"loading"===a.status,children:"Load Volume Data"},"load"),Object(He.jsx)(Kr.a,{variant:"body2",children:"Please note that the 3D volume rendering is still an experimental feature."},"note")]),a&&("loading"===a.status?e=Object(He.jsx)(li.a,{style:{margin:10}}):"error"===a.status&&(e=Object(He.jsx)(Kr.a,{variant:"body2",color:"red",children:"Failed loading volume: ".concat(a.message)})))}else e=[Object(He.jsx)(Kr.a,{variant:"subtitle2",children:"Cannot display 3D volume"},"subtitle2"),Object(He.jsx)(Kr.a,{variant:"body2",children:"To display a volume, a variable and a place that represents an area must be selected. Please note that the 3D volume rendering is still an experimental feature."},"body2")];return e&&(e=Object(He.jsx)("div",{style:Ws,children:e})),t&&(t=Object(He.jsx)("div",{style:Ws,children:t})),Object(He.jsxs)("div",{style:Hs,children:[t,e,Object(He.jsx)("canvas",{id:"VolumeCanvas-canvas",ref:this.canvasRef,style:Us}),!e&&!t&&Ks]})}},{key:"updateVolumeScene",value:function(){var e=this.canvasRef.current;if(null!==e){var t;this.props.volumeId&&(t=Zs[this.props.volumeId]);var a=!1;null!==this.volumeScene&&this.volumeScene.canvas===e||(this.volumeScene=new Ds(e),a=!0),a&&t?this.volumeScene.setVolume(t,n.getVolumeOptions(this.props)):this.volumeScene.setVolumeOptions(n.getVolumeOptions(this.props))}else this.volumeScene=null}}],[{key:"getVolumeOptions",value:function(e){var t=e.selectedVariable,n=e.variableColorBar,a=e.volumeIsoThreshold,r=e.volumeRenderMode;return{value1:t?t.colorBarMin:0,value2:t?t.colorBarMax:1,renderMode:r,isoThreshold:a,colorBar:n}}}]),n}(r.a.PureComponent);function qs(e){var t,n=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,o=Object(u.a)(e);try{for(o.s();!(t=o.n()).done;){var c=t.value,s=c[0],l=c[1];n=Math.min(n,s),a=Math.min(a,l),r=Math.max(r,s),i=Math.max(i,l)}}catch(d){o.e(d)}finally{o.f()}return[n,a,r,i]}var Xs=Object(Ci.a)((function(e){return Object(qr.a)({card:{maxWidth:"100%",marginBottom:e.spacing(1),marginRight:e.spacing(1)},info:{marginRight:e.spacing(1)},close:{marginLeft:"auto"},cardContent:{padding:8},isoEditor:{display:"flex",flexDirection:"row"},isoTextField:{minWidth:"16em",marginLeft:"1em"},isoSlider:{minWidth:200}})})),Js=function(e){var t=e.volumeCardOpen,n=e.showVolumeCard,a=e.selectedDataset,r=e.selectedVariable,i=e.selectedPlaceInfo,o=e.variableColorBar,c=e.volumeId,s=e.volumeRenderMode,l=e.setVolumeRenderMode,u=e.volumeStates,d=e.updateVolumeState,p=e.updateVariableVolume,m=e.serverUrl,f=Xs();if(!t)return null;var h=.5;r&&(h="number"===typeof r.volumeIsoThreshold?r.volumeIsoThreshold:.5*(r.colorBarMin+r.colorBarMax),"string"===typeof r.volumeRenderMode&&(s=r.volumeRenderMode));return Object(He.jsxs)(Ps.a,{className:f.card,children:[Object(He.jsxs)(ks.a,{disableSpacing:!0,children:[Object(He.jsx)(uc.a,{fontSize:"large",className:f.info}),r&&Object(He.jsxs)(He.Fragment,{children:[Object(He.jsxs)(Co.a,{size:"small",exclusive:!0,value:s,onChange:function(e,t){null!==t&&(l(t),r&&p(a.id,r.name,o,t,h))},children:[Object(He.jsx)(Eo.a,{value:"mip",children:Object(He.jsx)(Jr.a,{arrow:!0,title:"Maximum intensity projection",children:Object(He.jsx)("span",{children:"MIP"})})},"mip"),Object(He.jsx)(Eo.a,{value:"aip",children:Object(He.jsx)(Jr.a,{arrow:!0,title:"Average intensity projection",children:Object(He.jsx)("span",{children:"AIP"})})},"aip"),Object(He.jsx)(Eo.a,{value:"iso",children:Object(He.jsx)(Jr.a,{arrow:!0,title:"Iso-surface extraction",children:Object(He.jsx)("span",{children:"ISO"})})},"iso")]},0),"iso"===s&&Object(He.jsx)(Qs,{minValue:r.colorBarMin,maxValue:r.colorBarMax,value:h,setValue:function(e){p(a.id,r.name,o,s,e)}})]}),Object(He.jsx)(Hr.a,{onClick:function(){n(!1)},className:f.close,children:Object(He.jsx)(_i.a,{})},1)]}),Object(He.jsx)(Es.a,{className:f.cardContent,children:Object(He.jsx)(Ys,{selectedDataset:a,selectedVariable:r,selectedPlaceInfo:i,variableColorBar:o,volumeRenderMode:s,volumeIsoThreshold:h,volumeId:c,volumeStates:u,updateVolumeState:d,serverUrl:m})})]})},Qs=function(e){var t=e.value,n=e.minValue,a=e.maxValue,i=e.setValue,o=e.disabled,c=Xs(),s=r.a.useState(t),l=Object(G.a)(s,2),u=l[0],d=l[1],p=r.a.useState(""+t),m=Object(G.a)(p,2),f=m[0],h=m[1],b=r.a.useState(null),v=Object(G.a)(b,2),g=v[0],j=v[1];return Object(He.jsx)(Mo.a,{className:c.isoTextField,disabled:o,label:"Iso-Threshold",variant:"filled",size:"small",value:f,error:null!==g,onChange:function(e){var t=e.target.value||"";h(t);var r=parseFloat(t);Number.isNaN(r)?j("Not a number"):j(r<n||r>a?"Out of range":null)},onKeyPress:function(e){if("Enter"===e.key&&!g){var t=parseFloat(f);d(t),i(t)}},InputProps:{endAdornment:Object(He.jsx)(Bo.a,{size:"small",className:c.isoSlider,min:n,max:a,value:u,step:(a-n)/20,onChange:function(e,t){d(t),h(t.toFixed(2))},onChangeCommitted:function(e,t){i(t)}})}})},$s={showVolumeCard:jr,setVolumeRenderMode:function(e){return{type:Or,volumeRenderMode:e}},updateVolumeState:function(e,t){return{type:xr,volumeId:e,volumeState:t}},updateVariableVolume:function(e,t,n,a,r){return{type:Za,datasetId:e,variableName:t,variableColorBar:n,volumeRenderMode:a,volumeIsoThreshold:r}}},el=Object(o.b)((function(e){return{locale:e.controlState.locale,volumeCardOpen:e.controlState.volumeCardOpen,selectedDataset:wn(e),selectedVariable:Tn(e),selectedPlaceInfo:Fn(e),variableColorBar:Cn(e),volumeRenderMode:e.controlState.volumeRenderMode,volumeId:Un(e),volumeStates:e.controlState.volumeStates,serverUrl:na(e).url}}),$s)(Js),tl=n(1119),nl=n(1117),al=n(1118),rl=n(1090),il=n(1121),ol=n(1122),cl=n(1124),sl=n(1120),ll=n(1123),ul=n(622),dl=n.n(ul),pl=n(618),ml=n.n(pl),fl=n(621),hl=n.n(fl),bl=n(619),vl=n.n(bl),gl=n(620),jl=n.n(gl),Ol=n(617),xl=n.n(Ol),yl=n(362),wl=n(368),Sl=n(636),Tl=n.p+"static/media/python-bw.071ec04f.png",Pl=Object(Ci.a)((function(e){return Object(qr.a)({card:{maxWidth:"100%",marginBottom:e.spacing(1),marginRight:e.spacing(1)},info:{marginRight:e.spacing(1)},close:{marginLeft:"auto"},table:{},keyValueTableContainer:{background:e.palette.divider},variableHtmlReprContainer:{background:e.palette.divider,padding:e.spacing(1),marginTop:e.spacing(1),marginBottom:e.spacing(1)},media:{height:200},cardContent:{padding:8},code:{fontFamily:"Monospace"}})})),kl=function(e){var t=e.infoCardOpen,n=e.showInfoCard,a=e.visibleInfoCardElements,r=e.setVisibleInfoCardElements,i=e.infoCardElementViewModes,o=e.updateInfoCardElementViewMode,c=e.selectedDataset,s=e.selectedVariable,l=e.selectedPlaceInfo,u=e.selectedTime,d=e.serverConfig,p=e.allowViewModePython,m=Pl();if(!t)return null;var f,h,b;if(c){var g="dataset",j=i[g],O=a.includes(g);f=Object(He.jsx)(El,{isIn:O,viewMode:j,setViewMode:function(e){return o(g,e)},dataset:c,serverConfig:d,hasPython:p})}if(c&&s){var x="variable",y=i[x],w=a.includes(x);h=Object(He.jsx)(Cl,{isIn:w,viewMode:y,setViewMode:function(e){return o(x,e)},variable:s,time:u,serverConfig:d,hasPython:p})}if(l){var S="place",T=i[S],P=a.includes(S);b=Object(He.jsx)(Il,{isIn:P,viewMode:T,setViewMode:function(e){return o(S,e)},placeInfo:l})}return Object(He.jsxs)(Ps.a,{className:m.card,children:[Object(He.jsxs)(ks.a,{disableSpacing:!0,children:[Object(He.jsx)(sc.a,{fontSize:"large",className:m.info}),Object(He.jsxs)(Co.a,{size:"small",value:a,onChange:function(e,t){r(t)},children:[Object(He.jsx)(Eo.a,{value:"dataset",disabled:null===c,children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Dataset information"),children:Object(He.jsx)(xl.a,{})})},0),Object(He.jsx)(Eo.a,{value:"variable",disabled:null===s,children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Variable information"),children:Object(He.jsx)(ml.a,{})})},1),Object(He.jsx)(Eo.a,{value:"place",disabled:null===l,children:Object(He.jsx)(Jr.a,{arrow:!0,title:v.get("Place information"),children:Object(He.jsx)(vl.a,{})})},2)]},0),Object(He.jsx)(Hr.a,{onClick:function(){n(!1)},className:m.close,size:"large",children:Object(He.jsx)(_i.a,{})},1)]}),f,h,b]})},El=function(e){var t,n=e.isIn,a=e.viewMode,r=e.setViewMode,i=e.dataset,o=e.serverConfig,c=e.hasPython;if("code"===a){var s=Dl(i.dimensions,["name","size","dtype"]),l=Dl(i,["id","title","bbox","attrs"]);l.dimensions=s,t=Object(He.jsx)(Rl,{code:JSON.stringify(l,null,2)})}else if("list"===a)t=Object(He.jsx)(Ml,{children:Object(He.jsx)(Nl,{data:Object.getOwnPropertyNames(i.attrs||{}).map((function(e){return[e,i.attrs[e]]}))})});else if("text"===a){var u=[[v.get("Dimension names"),i.dimensions.map((function(e){return e.name})).join(", ")],[v.get("Dimension data types"),i.dimensions.map((function(e){return e.dtype})).join(", ")],[v.get("Dimension lengths"),i.dimensions.map((function(e){return e.size})).join(", ")],[v.get("Geographical extent")+" (x1, y1, x2, y2)",i.bbox.map((function(e){return e+""})).join(", ")],[v.get("Spatial reference system"),i.spatialRef]];t=Object(He.jsx)(Ml,{children:Object(He.jsx)(Nl,{data:u})})}else"python"===a&&(t=Object(He.jsx)(Ll,{code:zl(o,i)}));return Object(He.jsx)(_l,{title:i.title||"?",subheader:i.title&&"ID: ".concat(i.id),isIn:n,viewMode:a,setViewMode:r,hasPython:c,children:t})},Cl=function(e){var t,n,a=e.isIn,r=e.viewMode,i=e.setViewMode,o=e.variable,c=e.time,s=e.serverConfig,l=e.hasPython,u=Pl();if("code"===r){var d=Dl(o,["id","name","title","units","shape","dtype","shape","timeChunkSize","colorBarMin","colorBarMax","colorBarName","attrs"]);t=Object(He.jsx)(Rl,{code:JSON.stringify(d,null,2)})}else if("list"===r){if(t=Object(He.jsx)(Ml,{children:Object(He.jsx)(Nl,{data:Object.getOwnPropertyNames(o.attrs||{}).map((function(e){return[e,o.attrs[e]]}))})}),o.htmlRepr){n=Object(He.jsx)(Ml,{children:Object(He.jsx)(xi.a,{ref:function(e){e&&o.htmlRepr&&(e.innerHTML=o.htmlRepr)},className:u.variableHtmlReprContainer})})}}else if("text"===r){var p=[[v.get("Title"),o.title],[v.get("Name"),o.name],[v.get("Units"),o.units],[v.get("Data type"),o.dtype],[v.get("Dimension names"),o.dims.join(", ")],[v.get("Dimension lengths"),o.shape.map((function(e){return e+""})).join(", ")],[v.get("Time chunk size"),o.timeChunkSize]];t=Object(He.jsx)(Ml,{children:Object(He.jsx)(Nl,{data:p})})}else"python"===r&&(t=Object(He.jsx)(Ll,{code:Gl(s,o,c)}));return Object(He.jsxs)(_l,{title:o.title||o.name,subheader:"".concat(v.get("Name"),": ").concat(o.name),isIn:a,viewMode:r,setViewMode:i,hasPython:l,children:[n,t]})},Il=function(e){var t,n,a,r=e.isIn,i=e.viewMode,o=e.setViewMode,c=e.placeInfo,s=Pl(),l=c.place;if("code"===i)t=Object(He.jsx)(Rl,{code:JSON.stringify(l,null,2)});else if("list"===i)if(l.properties){var u=Object.getOwnPropertyNames(l.properties).map((function(e){return[e,l.properties[e]]}));t=Object(He.jsx)(Ml,{children:Object(He.jsx)(Nl,{data:u})})}else t=Object(He.jsx)(Ml,{children:Object(He.jsx)(Kr.a,{children:v.get("There is no information available for this location.")})});else c.image&&c.image.startsWith("http")&&(n=Object(He.jsx)(nl.a,{className:s.media,image:c.image,title:c.label})),c.description&&(a=Object(He.jsx)(Ml,{children:Object(He.jsx)(Kr.a,{children:c.description})}));return Object(He.jsxs)(_l,{title:c.label,subheader:"".concat(v.get("Geometry type"),": ").concat(v.get(l.geometry.type)),isIn:r,viewMode:i,setViewMode:o,children:[n,a,t]})},_l=function(e){var t=e.isIn,n=e.title,a=e.subheader,r=e.viewMode,i=e.setViewMode,o=e.hasPython,c=e.children;return Object(He.jsxs)(al.a,{in:t,timeout:"auto",unmountOnExit:!0,children:[Object(He.jsx)(tl.a,{title:n,subheader:a,action:Object(He.jsxs)(Co.a,{size:"small",value:r,exclusive:!0,onChange:function(e,t){i(t)},children:[Object(He.jsx)(Eo.a,{value:"text",children:Object(He.jsx)(jl.a,{})},0),Object(He.jsx)(Eo.a,{value:"list",children:Object(He.jsx)(hl.a,{})},1),Object(He.jsx)(Eo.a,{value:"code",children:Object(He.jsx)(dl.a,{})},2),o&&Object(He.jsx)(Eo.a,{value:"python",children:Object(He.jsx)("img",{src:Tl,width:24,alt:"python logo"})},3)]},0)}),c]})},Nl=function(e){var t=e.data,n=Pl();return Object(He.jsx)(sl.a,{component:xi.a,className:n.keyValueTableContainer,children:Object(He.jsx)(il.a,{className:n.table,size:"small",children:Object(He.jsx)(ol.a,{children:t.map((function(e,t){var n=Object(G.a)(e,2),a=n[0],r=n[1],i=r;return"string"===typeof r&&(r.startsWith("http://")||r.startsWith("https://"))?i=Object(He.jsx)(rl.a,{href:r,target:"_blank",rel:"noreferrer",children:r}):Array.isArray(r)&&(i="["+r.map((function(e){return e+""})).join(", ")+"]"),Object(He.jsxs)(ll.a,{children:[Object(He.jsx)(cl.a,{children:a}),Object(He.jsx)(cl.a,{align:"right",children:i})]},t)}))})})})},Ml=function(e){var t=e.children,n=Pl();return Object(He.jsx)(Es.a,{className:n.cardContent,children:t})},Al=function(e){var t=e.code,n=e.extension;return Object(He.jsx)(Ml,{children:Object(He.jsx)(yl.a,{theme:he.instance.branding.themeName||"light",height:"320px",extensions:[n],value:t,readOnly:!0})})},Rl=function(e){var t=e.code;return Object(He.jsx)(Al,{code:t,extension:Object(wl.a)()})},Ll=function(e){var t=e.code;return Object(He.jsx)(Al,{code:t,extension:Object(Sl.a)()})};function Dl(e,t){var n,a={},r=Object(u.a)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;i in e&&(a[i]=e[i])}}catch(o){r.e(o)}finally{r.f()}return a}function zl(e,t){var n=function(e){var t=e.lastIndexOf(".");return t>=0?[e.substring(0,t),e.substring(t)]:[e,""]}(t.id)[0]+".zarr";return["from xcube.core.store import new_data_store","","store = new_data_store(",'    "s3",','    root="datasets",  # can also use "pyramids" here',"    storage_options={",'        "anon": True,','        "client_kwargs": {','            "endpoint_url": "'.concat(e.url,'/s3"'),"        }","    }",")","# store.list_data_ids()",'dataset = store.open_data(data_id="'.concat(n,'")')].join("\n")}function Gl(e,t,n){var a=t.name,r=t.colorBarMin,i=t.colorBarMax,o=t.colorBarName,c="";return null!==n&&(c='.sel(time="'.concat(yt(n),'", method="nearest")')),["var = dataset.".concat(a).concat(c),"var.plot.imshow(vmin=".concat(r,", vmax=").concat(i,', cmap="').concat(o,'")')].join("\n")}var Bl={showInfoCard:wr,setVisibleInfoCardElements:function(e){return{type:Sr,visibleElements:e}},updateInfoCardElementViewMode:function(e,t){return{type:Tr,elementType:e,viewMode:t}}},Vl=Object(o.b)((function(e){return{locale:e.controlState.locale,infoCardOpen:e.controlState.infoCardOpen,visibleInfoCardElements:la(e),infoCardElementViewModes:ua(e),selectedDataset:wn(e),selectedVariable:Tn(e),selectedPlaceInfo:Fn(e),selectedTime:gn(e),serverConfig:na(e),allowViewModePython:he.instance.branding.allowViewModePython}}),Bl)(kl),Fl=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){var a;if(Object(p.a)(this,n),(a=t.call(this,e)).lastPosition=null,a.bodyEventListeners=void 0,!e.onChange)throw Error("onChange property must be provided");return a.onMouseDown=a.onMouseDown.bind(Object(Cs.a)(a)),a.bodyEventListeners=[["mousemove",a.onBodyMouseMove.bind(Object(Cs.a)(a))],["mouseup",a.onBodyMouseUp.bind(Object(Cs.a)(a))],["onmouseenter",a.onBodyMouseEnter.bind(Object(Cs.a)(a))],["onmouseleave",a.onBodyMouseLeave.bind(Object(Cs.a)(a))]],a}return Object(m.a)(n,[{key:"componentWillUnmount",value:function(){this.removeBodyMouseListeners()}},{key:"render",value:function(){return Object(He.jsx)("div",{className:"hor"===this.props.dir?this.props.classes.hor:this.props.classes.ver,onMouseDown:this.onMouseDown})}},{key:"onMouseDown",value:function(e){this.isButton1Pressed(e)?(this.lastPosition=this.getCurrentPosition(e),this.removeBodyMouseListeners(),this.addBodyMouseListeners()):this.lastPosition=null}},{key:"onBodyMouseMove",value:function(e){if(null!==this.lastPosition&&this.isButton1Pressed(e)){var t=this.getCurrentPosition(e),n=t-this.lastPosition;this.lastPosition=t,0!==n&&this.props.onChange(n)}}},{key:"onBodyMouseUp",value:function(e){this.endDragging()}},{key:"onBodyMouseEnter",value:function(e){this.endDragging()}},{key:"onBodyMouseLeave",value:function(e){this.endDragging()}},{key:"isButton1Pressed",value:function(e){return 0===e.button&&1===e.buttons}},{key:"getCurrentPosition",value:function(e){return"hor"===this.props.dir?e.screenX:e.screenY}},{key:"endDragging",value:function(){this.removeBodyMouseListeners(),this.lastPosition=null}},{key:"addBodyMouseListeners",value:function(){this.bodyEventListeners.forEach((function(e){return document.body.addEventListener(e[0],e[1])}))}},{key:"removeBodyMouseListeners",value:function(){this.bodyEventListeners.forEach((function(e){return document.body.removeEventListener(e[0],e[1])}))}}]),n}(a.PureComponent),Ul=Object(Xr.a)((function(e){return Object(qr.a)({hor:{flex:"none",border:"none",outline:"none",width:"8px",minHeight:"100%",maxHeight:"100%",cursor:"col-resize",backgroundColor:"dark"===e.palette.mode?"white":"black",opacity:0},ver:{flex:"none",border:"none",outline:"none",height:"8px",minWidth:"100%",maxWidth:"100%",cursor:"row-resize",backgroundColor:"dark"===e.palette.mode?"white":"black",opacity:0}})}))(Fl),Wl=function(e){Object(g.a)(n,e);var t=Object(j.a)(n);function n(e){var a;return Object(p.a)(this,n),(a=t.call(this,e)).handleSplitDelta=a.handleSplitDelta.bind(Object(Cs.a)(a)),a.state={size:e.initialSize||50},a}return Object(m.a)(n,[{key:"handleSplitDelta",value:function(e){var t=this;this.setState((function(n){var a=n.size,r=a+e;return t.props.onChange&&t.props.onChange(r,a),{size:r}}))}},{key:"render",value:function(){var e,t,n,a,r=this.props.children;if(!r||!Array.isArray(r))return r;if(1===r.length)return r[0];if(r.length>2)throw new Error("SplitPane expects not more than two children");if("hor"===this.props.dir){var i=this.state.size;e=this.props.classes.hor,t=this.props.classes.childVer,n=Object(P.a)({width:i},this.props.child1Style),a=this.props.child2Style}else{var o=this.state.size;e=this.props.classes.ver,t=this.props.classes.childVer,n=Object(P.a)({height:o},this.props.child1Style),a=this.props.child2Style}return Object(He.jsxs)("div",{id:"SplitPane",className:ii()(e,this.props.className),style:this.props.style,children:[Object(He.jsx)("div",{id:"SplitPane-Child-1",className:ii()(t,this.props.child1ClassName),style:n,children:r[0]}),Object(He.jsx)(Ul,{dir:this.props.dir,onChange:this.handleSplitDelta}),Object(He.jsx)("div",{id:"SplitPane-Child-2",className:ii()(t,this.props.child2ClassName),style:a,children:r[1]})]})}}]),n}(a.PureComponent),Kl=Object(Xr.a)((function(e){return Object(qr.a)({hor:{display:"flex",flexFlow:"row nowrap",flex:"auto"},ver:{height:"100%",display:"flex",flexFlow:"column nowrap",flex:"auto"},childHor:{flex:"none"},childVer:{flex:"none"}})}))(Wl),Hl={padding:0},Zl=function(){return window.innerWidth/window.innerHeight>=1?"hor":"ver"},Yl=Object(o.b)((function(e){var t=null!==e.controlState.selectedDatasetId&&e.dataState.datasets.length>0;return{hasInfoCard:e.controlState.infoCardOpen&&t,hasVolumeCard:e.controlState.volumeCardOpen&&t,hasTimeseries:e.dataState.timeSeriesGroups.length>0}}),{})(Object(Xr.a)((function(e){return Object(qr.a)({splitPaneHor:{flexGrow:1,overflow:"hidden"},splitPaneVer:{flexGrow:1,overflowX:"hidden",overflowY:"auto"},mapPaneHor:Object(P.a)({height:"100%",overflow:"hidden"},Hl),mapPaneVer:Object(P.a)({width:"100%",overflow:"hidden"},Hl),detailsPaneHor:{flex:"auto",overflowX:"hidden",overflowY:"auto"},detailsPaneVer:{width:"100%",overflow:"hidden"},viewerContainer:{overflow:"hidden",width:"100%",height:"100%"}})}))((function(e){var t=e.classes,n=e.hasInfoCard,r=e.hasVolumeCard,i=e.hasTimeseries,o=a.useState(null),c=Object(G.a)(o,2),s=c[0],l=c[1],u=a.useState(Zl()),d=Object(G.a)(u,2),p=d[0],m=d[1];a.useEffect((function(){f(),window.onresize=f}),[]);var f=function(){m(Zl())};if(n||r||i){var h="hor"===p?t.splitPaneHor:t.splitPaneVer,b="hor"===p?t.mapPaneHor:t.mapPaneVer,v="hor"===p?t.detailsPaneHor:t.detailsPaneVer;return Object(He.jsxs)(Kl,{dir:p,initialSize:Math.max(window.innerWidth,window.innerHeight)/2,onChange:function(e){s&&s.updateSize()},className:h,child1ClassName:b,child2ClassName:v,children:[Object(He.jsx)(Qc,{onMapRef:l}),Object(He.jsxs)("div",{children:[Object(He.jsx)(Vl,{}),Object(He.jsx)(el,{}),Object(He.jsx)(Ts,{})]})]})}return Object(He.jsx)("div",{className:t.viewerContainer,children:Object(He.jsx)(Qc,{onMapRef:l})})}))),ql=Object(o.b)((function(e){return{locale:e.controlState.locale,hasConsent:e.controlState.privacyNoticeAccepted,compact:he.instance.branding.compact}}),{})(Object(Xr.a)((function(e){return Object(qr.a)({main:Object(vt.a)({padding:0,width:"100vw",height:"100vh",overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"stretch"},e.breakpoints.up("md"),{overflow:"hidden"})})}))((function(e){var t=e.classes,n=e.hasConsent,a=e.compact;return Object(He.jsxs)("main",{className:t.main,children:[!a&&Object(He.jsx)(Wr.a,{variant:"dense"}),n&&Object(He.jsxs)(He.Fragment,{children:[Object(He.jsx)(bc,{}),Object(He.jsx)(Yl,{})]})]})}))),Xl=n(1125),Jl=n(623),Ql=n.n(Jl),$l=Object(Ci.a)((function(e){return{icon:{marginRight:e.spacing(2)}}}));var eu={updateSettings:Dr,syncWithServer:Wa},tu=Object(o.b)((function(e){return{open:!e.controlState.privacyNoticeAccepted,settings:e.controlState}}),eu)((function(e){var t=e.open,n=e.settings,r=e.updateSettings,i=e.syncWithServer,o=Object(a.useState)(null),c=Object(G.a)(o,2),s=c[0],l=c[1];Object(a.useEffect)((function(){var e=v.get("legal/privacy-note.en.md");fetch(e).then((function(e){return e.text()})).then((function(e){return l(e)}))}));var u=$l();return t?Object(He.jsxs)(ui.a,{open:t,disableEscapeKeyDown:!0,keepMounted:!0,scroll:"body",children:[Object(He.jsx)(mi.a,{children:v.get("Privacy Notice")}),Object(He.jsx)(pi.a,{children:Object(He.jsx)(Xl.a,{children:null===s?Object(He.jsx)(li.a,{}):Object(He.jsx)(Ei.a,{children:s,linkTarget:"_blank"})})}),Object(He.jsxs)(di.a,{children:[Object(He.jsxs)(si.a,{onClick:function(){r(Object(P.a)(Object(P.a)({},n),{},{privacyNoticeAccepted:!0})),i()},color:"primary",children:[Object(He.jsx)(Ql.a,{className:u.icon}),v.get("Accept and continue")]}),Object(He.jsx)(si.a,{onClick:function(){try{window.history.length>0?window.history.back():"function"===typeof window.home?window.home():window.location.href="about:home"}catch(e){console.error(e)}},children:v.get("Leave")})]})]}):null})),nu=Object(Xr.a)((function(e){return Object(qr.a)({progress:{margin:e.spacing(2)},message:{margin:e.spacing(1)},contentContainer:{margin:e.spacing(1),textAlign:"center",display:"flex",alignItems:"center",flexDirection:"column"}})}))((function(e){var t=e.classes,n=e.messages;return 0===n.length?null:Object(He.jsxs)(ui.a,{open:!0,"aria-labelledby":"loading",children:[Object(He.jsx)(mi.a,{id:"loading",children:v.get("Please wait...")}),Object(He.jsxs)("div",{className:t.contentContainer,children:[Object(He.jsx)(li.a,{className:t.progress}),n.map((function(e,n){return Object(He.jsx)(Kr.a,{component:"div",className:t.message,children:e},n)}))]})]})})),au=Object(o.b)((function(e){return{locale:e.controlState.locale,messages:da(e)}}),{})(nu),ru=n(1082),iu=n(1126),ou=n(626),cu=n.n(ou),su=n(625),lu=n.n(su),uu=n(624),du={success:n.n(uu).a,warning:lu.a,error:cu.a,info:sc.a},pu={vertical:"bottom",horizontal:"center"},mu=Object(Xr.a)((function(e){return Object(qr.a)({close:{padding:e.spacing(.5)},success:{color:e.palette.error.contrastText,backgroundColor:H.a[600]},error:{color:e.palette.error.contrastText,backgroundColor:e.palette.error.dark},info:{color:e.palette.error.contrastText,backgroundColor:e.palette.primary.dark},warning:{color:e.palette.error.contrastText,backgroundColor:ee.a[700]},icon:{fontSize:20},iconVariant:{opacity:.9,marginRight:e.spacing(1)},message:{display:"flex",alignItems:"center"}})}))((function(e){var t=e.classes,n=e.className,a=e.message,r=e.hideMessage,i=function(){r(a.id)};if(!a)return null;var o=du[a.type];return Object(He.jsx)(ru.a,{open:!0,anchorOrigin:pu,autoHideDuration:5e3,onClose:i,children:Object(He.jsx)(iu.a,{className:ii()(t[a.type],n),"aria-describedby":"client-snackbar",message:Object(He.jsxs)("span",{id:"client-snackbar",className:t.message,children:[Object(He.jsx)(o,{className:ii()(t.icon,t.iconVariant)}),a.text]}),action:[Object(He.jsx)(Hr.a,{"aria-label":"Close",color:"inherit",className:t.close,onClick:i,size:"large",children:Object(He.jsx)(_i.a,{className:t.icon})},"close")]})},a.type+":"+a.text)})),fu={hideMessage:function(e){return{type:va,messageId:e}}},hu=Object(o.b)((function(e){var t=e.messageLogState.newEntries;return{locale:e.controlState.locale,message:t.length>0?t[0]:null}}),fu)(mu),bu=function(e){var t=e.children,n=he.instance.authClient;if(!n)return Object(He.jsx)(He.Fragment,{children:t});var a=le.href;return Object(He.jsx)(jc,{children:Object(He.jsx)(oi.AuthProvider,Object(P.a)(Object(P.a)({},n),{},{loadUserInfo:!0,scope:"openid email profile",automaticSilentRenew:!0,redirect_uri:a,post_logout_redirect_uri:a,popup_post_logout_redirect_uri:a,onSigninCallback:function(e){console.info("handleSigninCallback:",e),window.history.replaceState({},document.title,window.location.pathname)},onRemoveUser:function(){console.info("handleRemoveUser"),window.location.pathname="/"},children:t}))})},vu=n(1113),gu=n(627),ju=n.n(gu),Ou=n(628),xu=n.n(Ou),yu=Object(Xr.a)((function(e){return Object(qr.a)({formControl:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:200},textField2:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:400},button:{margin:.1*e.spacing(1)}})}))((function(e){var t=e.classes,n=e.open,r=e.servers,i=e.selectedServer,o=e.closeDialog,c=e.configureServers,s=Object(a.useRef)(!1),l=Object(a.useState)(r),u=Object(G.a)(l,2),d=u[0],p=u[1],m=Object(a.useState)(i),f=Object(G.a)(m,2),h=f[0],b=f[1],g=Object(a.useState)("select"),j=Object(G.a)(g,2),O=j[0],x=j[1];Object(a.useEffect)((function(){s.current&&(p(r),b(i)),s.current=!0}),[r,i]);var y,w,S,T=function(){o("server")},E=function(){var e=h.id;return d.findIndex((function(t){return t.id===e}))},C=function(e,t){var n=Object(k.a)(d);n[e]=t,p(n),b(t),x("select")},I=function(e,t){p(e),b(t),x("select")},_=function(){var e=Object(P.a)(Object(P.a)({},h),{},{id:z("server-")}),t=[].concat(Object(k.a)(d),[e]);I(t,e)},N=function(){C(E(),Object(P.a)({},h))},M=function(){var e=E();C(E(),d[e])},A=function(){var e=Object(k.a)(d);if(e.length<2)throw new Error("internal error: server list cannot be emptied");var t=E(),n=e[t+(t>0?-1:1)];e.splice(t,1),I(e,n)},R=d.map((function(e,t){return Object(He.jsx)(Yr.a,{value:e.id,children:e.name},t)}));return y="add"===O?v.get("Add"):"edit"===O?v.get("Save"):v.get("OK"),w="add"===O?v.get("Add Server"):"edit"===O?v.get("Edit Server"):v.get("Select Server"),S="add"===O||"edit"===O?Object(He.jsxs)(pi.a,{dividers:!0,children:[Object(He.jsx)(Mo.a,{variant:"standard",required:!0,id:"server-name",label:"Name",className:t.textField,margin:"normal",value:h.name,onChange:function(e){var t=e.target.value,n=Object(P.a)(Object(P.a)({},h),{},{name:t});b(n)}}),Object(He.jsx)("br",{}),Object(He.jsx)(Mo.a,{variant:"standard",required:!0,id:"server-url",label:"URL",className:t.textField2,margin:"normal",value:h.url,onChange:function(e){var t=e.target.value,n=Object(P.a)(Object(P.a)({},h),{},{url:t});b(n)}})]}):Object(He.jsx)(pi.a,{dividers:!0,children:Object(He.jsxs)("div",{children:[Object(He.jsxs)(Fi.a,{variant:"standard",className:t.formControl,children:[Object(He.jsx)(Bi.a,{htmlFor:"server-name",children:"Name"}),Object(He.jsx)(Vi.a,{variant:"standard",value:h.id,onChange:function(e){var t=e.target.value,n=d.find((function(e){return e.id===t}));b(n)},inputProps:{name:"server-name",id:"server-name"},children:R}),Object(He.jsx)(vu.a,{children:h.url})]}),Object(He.jsx)(Hr.a,{className:t.button,"aria-label":"Add",color:"primary",onClick:function(){x("add")},size:"large",children:Object(He.jsx)(ju.a,{fontSize:"small"})}),Object(He.jsx)(Hr.a,{className:t.button,"aria-label":"Edit",onClick:function(){x("edit")},size:"large",children:Object(He.jsx)(oo.a,{fontSize:"small"})}),Object(He.jsx)(Hr.a,{className:t.button,"aria-label":"Delete",disabled:d.length<2,onClick:function(){A()},size:"large",children:Object(He.jsx)(xu.a,{fontSize:"small"})})]})}),Object(He.jsxs)(ui.a,{open:n,onClose:function(){T()},"aria-labelledby":"server-dialog-title",children:[Object(He.jsx)(mi.a,{id:"server-dialog-title",children:w}),S,Object(He.jsxs)(di.a,{children:[Object(He.jsx)(si.a,{onClick:function(){"select"===O?T():M()},children:v.get("Cancel")}),Object(He.jsx)(si.a,{onClick:function(){"select"===O?(o("server"),c(d,h.id)):"add"===O?_():"edit"===O&&N()},autoFocus:!0,color:"primary",children:y})]})]})})),wu={closeDialog:Rr,configureServers:function(e,t){return function(n,a){a().controlState.selectedServerId!==t?(n({type:Va}),n(Ua(e,t)),n(Wa())):a().dataState.userServers!==e&&n(Ua(e,t))}}},Su=Object(o.b)((function(e){return{open:!!e.controlState.dialogOpen.server,servers:kt(e),selectedServer:na(e)}}),wu)(yu),Tu=n(1127),Pu=n(961),ku=Object(Ci.a)((function(e){return{settingsPanelTitle:{marginBottom:e.spacing(1)},settingsPanelPaper:{backgroundColor:("dark"===e.palette.mode?Pu.e:Pu.b)(e.palette.background.paper,.1),marginBottom:e.spacing(2)},settingsPanelList:{margin:0}}})),Eu=function(e){var t=e.title,n=e.children,a=ku(),i=r.a.Children.count(n),o=[];return r.a.Children.forEach(n,(function(e,t){o.push(e),t<i-1&&o.push(Object(He.jsx)(bi.a,{variant:"fullWidth",component:"li"},i+t))})),Object(He.jsxs)(Ui.a,{children:[t&&""!==t&&Object(He.jsx)(Kr.a,{variant:"body1",className:a.settingsPanelTitle,children:t}),Object(He.jsx)(xi.a,{elevation:4,className:a.settingsPanelPaper,children:Object(He.jsx)(gi.a,{component:"nav",dense:!0,className:a.settingsPanelList,children:o})})]})},Cu=n(1095),Iu=function(e){var t,n=e.label,a=e.value,r=e.onClick,i=e.children;a||(t={marginBottom:10});var o,c=Object(He.jsx)(Oi.a,{primary:n,secondary:a});return i&&(o=Object(He.jsx)(Cu.a,{children:i})),r?Object(He.jsxs)(ji.a,{style:t,button:!0,onClick:r,children:[c,o]}):Object(He.jsxs)(ji.a,{style:t,children:[c,o]})},_u=function(e){var t=e.propertyName,n=e.settings,a=e.updateSettings,r=e.disabled;return Object(He.jsx)(eo.a,{checked:!!n[t],onChange:function(){return a(Object(P.a)(Object(P.a)({},n),{},Object(vt.a)({},t,!n[t])))},disabled:r})},Nu=n(1079),Mu=n(1091),Au=function(e){var t=e.propertyName,n=e.settings,a=e.updateSettings,r=e.options,i=e.disabled;return Object(He.jsx)(Mu.a,{row:!0,value:n[t],onChange:function(e,r){a(Object(P.a)(Object(P.a)({},n),{},Object(vt.a)({},t,r)))},children:r.map((function(e){var t=Object(G.a)(e,2),n=t[0],a=t[1];return Object(He.jsx)($i.a,{control:Object(He.jsx)(Nu.a,{}),value:a,label:n,disabled:i},n)}))})},Ru=Object(Ci.a)((function(e){return{textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),fontSize:e.typography.fontSize/2},intTextField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),fontSize:e.typography.fontSize/2,width:e.spacing(6)},localeAvatar:{margin:10}}})),Lu=function(e){var t=e.open,n=e.closeDialog,a=e.settings,i=e.selectedServer,o=e.updateSettings,c=e.changeLocale,s=e.openDialog,l=e.viewerVersion,u=e.serverInfo,d=r.a.useState(null),p=Object(G.a)(d,2),m=p[0],f=p[1],h=r.a.useState(null),b=Object(G.a)(h,2),g=b[0],j=b[1],O=r.a.useState(a.timeChunkSize+""),x=Object(G.a)(O,2),y=x[0],w=x[1],S=Ru();if(r.a.useEffect((function(){var e=parseInt(y);Number.isNaN(e)||e===a.timeChunkSize||o({timeChunkSize:e})}),[y,a,o]),!t)return null;var T=null;Boolean(m)&&(T=Object.getOwnPropertyNames(v.languages).map((function(e){var t=v.languages[e];return Object(He.jsx)(Yr.a,{selected:e===a.locale,onClick:function(){return c(e)},children:Object(He.jsx)(Oi.a,{primary:t})},e)})));var P=null;Boolean(g)&&(P=[],bt.forEach((function(e,t){P.push(Object(He.jsx)(Tu.a,{disableSticky:!0,children:e.name},t)),e.datasets.forEach((function(e,n){P.push(Object(He.jsx)(Yr.a,{selected:a.baseMapUrl===e.endpoint,onClick:function(){return o({baseMapUrl:e.endpoint})},children:Object(He.jsx)(Oi.a,{primary:e.name})},t+"."+n))}))})));var k=a.baseMapUrl;return bt.forEach((function(e){e.datasets.forEach((function(t){t.endpoint===a.baseMapUrl&&(k="".concat(e.name," / ").concat(t.name))}))})),Object(He.jsxs)("div",{children:[Object(He.jsxs)(ui.a,{open:t,fullWidth:!0,maxWidth:"sm",onClose:function(){n("settings")},scroll:"body",children:[Object(He.jsx)(mi.a,{children:v.get("Settings")}),Object(He.jsxs)(pi.a,{children:[Object(He.jsxs)(Eu,{title:v.get("General"),children:[Object(He.jsx)(Iu,{label:v.get("Server"),value:i.name,onClick:function(){s("server")}}),Object(He.jsx)(Iu,{label:v.get("Language"),value:v.languages[a.locale],onClick:function(e){f(e.currentTarget)}}),Object(He.jsx)(Iu,{label:v.get("Time interval of the player"),children:Object(He.jsx)(Mo.a,{variant:"standard",select:!0,className:S.textField,value:a.timeAnimationInterval,onChange:function(e){o({timeAnimationInterval:parseInt(e.target.value)})},margin:"normal",children:on.map((function(e,t){return Object(He.jsx)(Yr.a,{value:e,children:e+" ms"},t)}))})})]}),Object(He.jsxs)(Eu,{title:v.get("Time-Series"),children:[Object(He.jsx)(Iu,{label:v.get("Show graph after adding a place"),value:Du(a.autoShowTimeSeries),children:Object(He.jsx)(_u,{propertyName:"autoShowTimeSeries",settings:a,updateSettings:o})}),Object(He.jsx)(Iu,{label:v.get("Show dots only, hide lines"),value:Du(a.showTimeSeriesPointsOnly),children:Object(He.jsx)(_u,{propertyName:"showTimeSeriesPointsOnly",settings:a,updateSettings:o})}),Object(He.jsx)(Iu,{label:v.get("Show error bars"),value:Du(a.showTimeSeriesErrorBars),children:Object(He.jsx)(_u,{propertyName:"showTimeSeriesErrorBars",settings:a,updateSettings:o})}),Object(He.jsx)(Iu,{label:v.get("Show median instead of mean (disables error bars)"),value:Du(a.showTimeSeriesMedian),children:Object(He.jsx)(_u,{propertyName:"showTimeSeriesMedian",settings:a,updateSettings:o})}),Object(He.jsx)(Iu,{label:v.get("Minimal number of data points in a time series update"),children:Object(He.jsx)(Mo.a,{variant:"standard",className:S.intTextField,value:y,onChange:function(e){w(e.target.value)},margin:"normal",size:"small"})})]}),Object(He.jsxs)(Eu,{title:v.get("Map"),children:[Object(He.jsx)(Iu,{label:v.get("Base map"),value:k,onClick:function(e){j(e.currentTarget)}}),Object(He.jsx)(Iu,{label:v.get("Projection"),children:Object(He.jsx)(Au,{propertyName:"mapProjection",settings:a,updateSettings:o,options:[[v.get("Geographic"),$e],[v.get("Mercator"),et]]})}),Object(He.jsx)(Iu,{label:v.get("Image smoothing"),value:Du(a.imageSmoothingEnabled),children:Object(He.jsx)(_u,{propertyName:"imageSmoothingEnabled",settings:a,updateSettings:o})}),Object(He.jsx)(Iu,{label:v.get("Show dataset boundaries"),value:Du(a.showDatasetBoundaries),children:Object(He.jsx)(_u,{propertyName:"showDatasetBoundaries",settings:a,updateSettings:o})})]}),Object(He.jsx)(Eu,{title:v.get("Legal Agreement"),children:Object(He.jsx)(si.a,{onClick:function(){o({privacyNoticeAccepted:!1}),window.location.reload()},children:v.get("Revoke consent")})}),Object(He.jsxs)(Eu,{title:v.get("System Information"),children:[Object(He.jsx)(Iu,{label:"xcube Viewer ".concat(v.get("version")),value:l}),Object(He.jsx)(Iu,{label:"xcube Server ".concat(v.get("version")),value:u?u.version:v.get("Cannot reach server")})]})]})]}),Object(He.jsx)(Zr.a,{anchorEl:m,keepMounted:!0,open:Boolean(m),onClose:function(){f(null)},children:T}),Object(He.jsx)(Zr.a,{anchorEl:g,keepMounted:!0,open:Boolean(g),onClose:function(){j(null)},children:P})]})},Du=function(e){return e?v.get("On"):v.get("Off")},zu={closeDialog:Rr,updateSettings:Dr,changeLocale:_r,openDialog:Mr},Gu=Object(o.b)((function(e){return{locale:e.controlState.locale,open:e.controlState.dialogOpen.settings,settings:e.controlState,selectedServer:na(e),viewerVersion:"1.1.0",serverInfo:e.dataState.serverInfo}}),zu)(Lu),Bu=Object(Ci.a)((function(e){return{separatorTextField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),fontSize:e.typography.fontSize/2,maxWidth:"6em"},fileNameTextField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),fontSize:e.typography.fontSize/2}}})),Vu=function(e){var t=e.open,n=e.closeDialog,a=e.settings,r=e.updateSettings,i=e.downloadTimeSeries,o=Bu(),c=function(){n("export")};return Object(He.jsx)("div",{children:Object(He.jsxs)(ui.a,{open:t,fullWidth:!0,maxWidth:"xs",onClose:c,scroll:"body",children:[Object(He.jsx)(pi.a,{children:Object(He.jsxs)(Eu,{title:v.get("Export Settings"),children:[Object(He.jsx)(Iu,{label:v.get("Include time-series data")+" (*.txt)",value:Fu(a.exportTimeSeries),children:Object(He.jsx)(_u,{propertyName:"exportTimeSeries",settings:a,updateSettings:r})}),Object(He.jsx)(Iu,{label:v.get("Separator for time-series data"),children:Object(He.jsx)(Mo.a,{variant:"standard",className:o.separatorTextField,value:a.exportTimeSeriesSeparator,onChange:function(e){r({exportTimeSeriesSeparator:e.target.value})},disabled:!a.exportTimeSeries,margin:"normal",size:"small"})}),Object(He.jsx)(Iu,{label:v.get("Include places data")+" (*.geojson)",value:Fu(a.exportPlaces),children:Object(He.jsx)(_u,{propertyName:"exportPlaces",settings:a,updateSettings:r})}),Object(He.jsx)(Iu,{label:v.get("Combine place data in one file"),value:Fu(a.exportPlacesAsCollection),children:Object(He.jsx)(_u,{propertyName:"exportPlacesAsCollection",settings:a,updateSettings:r,disabled:!a.exportPlaces})}),Object(He.jsx)(Iu,{label:v.get("As ZIP archive"),value:Fu(a.exportZipArchive),children:Object(He.jsx)(_u,{propertyName:"exportZipArchive",settings:a,updateSettings:r})}),Object(He.jsx)(Iu,{label:v.get("File name"),children:Object(He.jsx)(Mo.a,{variant:"standard",className:o.fileNameTextField,value:a.exportFileName,onChange:function(e){r({exportFileName:e.target.value})},margin:"normal",size:"small"})})]})}),Object(He.jsx)(di.a,{children:Object(He.jsx)(si.a,{onClick:function(){c(),i()},color:"primary",disabled:!Uu(a),children:v.get("Download")})})]})})},Fu=function(e){return e?v.get("On"):v.get("Off")},Uu=function(e){return(e.exportTimeSeries||e.exportPlaces)&&(n=e.exportFileName,/^[0-9a-zA-Z_-]+$/.test(n))&&(!e.exportTimeSeries||("TAB"===(t=e.exportTimeSeriesSeparator).toUpperCase()||1===t.length));var t,n},Wu={closeDialog:Rr,updateSettings:Dr,downloadTimeSeries:function(){return function(e,t){var n=t().controlState,a=n.exportTimeSeries,r=n.exportTimeSeriesSeparator,i=n.exportPlaces,o=n.exportPlacesAsCollection,c=n.exportZipArchive,s=n.exportFileName,l=[];a?(l=[],St(t()).forEach((function(e){e.placeGroups&&(l=l.concat(e.placeGroups))})),l=[].concat(Object(k.a)(l),Object(k.a)(Pt(t())))):i&&(l=zn(t()));!function(e,t,n){var a,r,i=n.includeTimeSeries,o=n.separator,c=n.includePlaces,s=n.fileName,l=n.placesAsCollection,d=n.zip;"TAB"===(o=o||"TAB").toUpperCase()&&(o="\t");if(s=s||"export",!i&&!c)return;a=d?new qa("".concat(s,".zip")):new Xa;if(i){var p=function(e,t){var n,a=new Set,r=new Set,i={},o=Object(u.a)(e);try{for(o.s();!(n=o.n()).done;){var c,s=n.value,l=Object(u.a)(s.timeSeriesArray);try{var d=function(){var e=c.value,t=e.source,n=t.placeId,o=t.datasetId,s=t.variableName,l=t.valueDataKey,u=t.errorDataKey;null!==n&&r.add(n);var d="".concat(o,".").concat(s,".").concat(l);a.add(d);var p=null;Boolean(u)&&(p="".concat(o,".").concat(s,".").concat(u),a.add(p)),e.data.forEach((function(e){var t=yt(e.time),a="".concat(null!==n?n:o,"-").concat(t),r=i[a];i[a]=r?Object(P.a)(Object(P.a)({},r),{},Object(vt.a)({},d,e[l])):Object(vt.a)({placeId:n,time:t},d,e[l]),null!==p&&(i[a][p]=e[u])}))};for(l.s();!(c=l.n()).done;)d()}catch(h){l.e(h)}finally{l.f()}}}catch(h){o.e(h)}finally{o.f()}var p=["placeId","time"].concat(Array.from(a).sort()),m=[];Object.keys(i).forEach((function(e){var t=i[e],n=new Array(p.length);p.forEach((function(e,a){n[a]=t[e]})),m.push(n)})),m.sort((function(e,t){var n=e[1],a=t[1],r=n.localeCompare(a);if(0!==r)return r;var i=e[0],o=t[0];return i.localeCompare(o)}));var f={};return r.forEach((function(e){f[e]=De(t,e)})),{colNames:p,dataRows:m,referencedPlaces:f}}(e,t),m=p.colNames,f=p.dataRows,h=p.referencedPlaces,b={number:!0,string:!0},v=m.join(o),g=f.map((function(e){return e.map((function(e){return b[typeof e]?e+"":""})).join(o)})),j=[v].concat(g).join("\n");a.write("".concat(s,".txt"),j),r=h}else r={},t.forEach((function(e){e.features&&e.features.forEach((function(e){r[e.id]=e}))}));if(c)if(l){var O={type:"FeatureCollection",features:Object.keys(r).map((function(e){return r[e]}))};a.write("".concat(s,".geojson"),JSON.stringify(O,null,2))}else Object.keys(r).forEach((function(e){a.write("".concat(e,".geojson"),JSON.stringify(r[e],null,2))}));a.close()}(t().dataState.timeSeriesGroups,l,{includeTimeSeries:a,includePlaces:i,separator:r,placesAsCollection:o,zip:c,fileName:s})}}},Ku=Object(o.b)((function(e){return{locale:e.controlState.locale,open:Boolean(e.controlState.dialogOpen.export),settings:e.controlState}}),Wu)(Vu),Hu=n(630),Zu=n.n(Hu),Yu=n(629),qu=n.n(Yu),Xu=function(e){var t=e.title,n=e.accept,r=e.multiple,i=e.disabled,o=e.onSelect,c=e.className,s=a.useRef(null);return Object(He.jsxs)(He.Fragment,{children:[Object(He.jsx)("input",{type:"file",accept:n,multiple:r,ref:s,hidden:!0,onChange:function(e){if(null!==e.target.files&&e.target.files.length){for(var t=[],n=0;n<e.target.files.length;n++)t.push(e.target.files[n]);o(t)}},disabled:i}),Object(He.jsx)(si.a,{onClick:function(){null!==s.current&&s.current.click()},disabled:i,className:c,variant:"outlined",size:"small",children:t})]})},Ju=function(e){return e},Qu=function(e){return"string"===typeof e?e:"".concat(e)},$u=function(e){return!0};var ed=function(){return function(e){var t=e.options,n=e.updateOptions,a=e.optionKey,r=e.label,i=e.style,o=e.className,c=e.disabled,s=e.parse,l=e.format,u=e.validate,d=t[a];return Object(He.jsx)(Mo.a,{label:v.get(r),value:(l||Qu)(d),error:!(u||$u)(d),onChange:function(e){var t=e.target.value,r=(s||Ju)(t);n(Object(vt.a)({},a,r))},style:i,className:o,disabled:c,size:"small",variant:"standard"})}},td=ed(),nd=function(e){var t=e.options,n=e.updateOptions,a=e.className;return Object(He.jsx)("div",{className:a,children:Object(He.jsxs)("div",{style:{display:"grid",gap:12,paddingTop:12,gridTemplateColumns:"auto auto"},children:[Object(He.jsx)(td,{optionKey:"timeNames",label:"Time property names",options:t,updateOptions:n}),Object(He.jsx)("div",{id:"spareField"}),Object(He.jsx)(td,{label:"Group property names",optionKey:"groupNames",options:t,updateOptions:n}),Object(He.jsx)(td,{label:"Group prefix (used as fallback)",optionKey:"groupPrefix",options:t,updateOptions:n}),Object(He.jsx)(td,{label:"Label property names",optionKey:"labelNames",options:t,updateOptions:n}),Object(He.jsx)(td,{label:"Label prefix (used as fallback)",optionKey:"labelPrefix",options:t,updateOptions:n})]})})},ad=ed(),rd=function(e){var t=e.options,n=e.updateOptions,a=e.className,r=t.forceGeometry;return Object(He.jsxs)("div",{className:a,children:[Object(He.jsxs)("div",{style:{display:"grid",gap:12,paddingTop:12,gridTemplateColumns:"auto auto"},children:[Object(He.jsx)(ad,{optionKey:"xNames",label:"X/longitude column names",options:t,updateOptions:n,disabled:r}),Object(He.jsx)(ad,{optionKey:"yNames",label:"Y/latitude column names",options:t,updateOptions:n,disabled:r}),Object(He.jsxs)("span",{children:[Object(He.jsx)(ro.a,{checked:t.forceGeometry,onChange:function(e){return n({forceGeometry:e.target.checked})},size:"small"}),Object(He.jsx)("span",{children:"Use geometry column"})]}),Object(He.jsx)(ad,{optionKey:"geometryNames",label:"Geometry column names",options:t,updateOptions:n,disabled:!r}),Object(He.jsx)(ad,{optionKey:"timeNames",label:"Time column names",options:t,updateOptions:n}),Object(He.jsx)("div",{id:"spareField"}),Object(He.jsx)(ad,{optionKey:"groupNames",label:"Group column names",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"groupPrefix",label:"Group prefix (used as fallback)",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"labelNames",label:"Label column names",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"labelPrefix",label:"Label prefix (used as fallback)",options:t,updateOptions:n})]}),Object(He.jsxs)("div",{style:{display:"grid",gap:12,paddingTop:12,gridTemplateColumns:"auto auto auto"},children:[Object(He.jsx)(ad,{optionKey:"separator",label:"Separator character",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"comment",label:"Comment character",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"quote",label:"Quote character",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"escape",label:"Escape character",options:t,updateOptions:n}),Object(He.jsx)("div",{}),Object(He.jsxs)("span",{children:[Object(He.jsx)(ro.a,{checked:t.trim,onChange:function(e){return n({trim:e.target.checked})},size:"small"}),Object(He.jsx)("span",{children:"Remove whitespaces"})]}),Object(He.jsx)(ad,{optionKey:"nanToken",label:"Not-a-number token",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"trueToken",label:"True token",options:t,updateOptions:n}),Object(He.jsx)(ad,{optionKey:"falseToken",label:"False token",options:t,updateOptions:n})]})]})},id=ed(),od=function(e){var t=e.options,n=e.updateOptions,a=e.className;return Object(He.jsx)("div",{className:a,children:Object(He.jsxs)("div",{style:{display:"grid",gap:12,paddingTop:12,gridTemplateColumns:"auto auto"},children:[Object(He.jsx)(id,{optionKey:"time",label:"Time (UTC, ISO-format)",options:t,updateOptions:n}),Object(He.jsx)("div",{id:"spareField"}),Object(He.jsx)(id,{label:"Group",options:t,optionKey:"group",updateOptions:n}),Object(He.jsx)(id,{label:"Group prefix (used as fallback)",optionKey:"groupPrefix",options:t,updateOptions:n,disabled:""!==t.group.trim()}),Object(He.jsx)(id,{label:"Label",optionKey:"label",options:t,updateOptions:n}),Object(He.jsx)(id,{label:"Label prefix (used as fallback)",optionKey:"labelPrefix",options:t,updateOptions:n,disabled:""!==t.label.trim()})]})})},cd={csv:Object(P.a)(Object(P.a)({},Wt),{},{codeExt:[]}),geojson:Object(P.a)(Object(P.a)({},Xt),{},{codeExt:[Object(wl.a)()]}),wkt:Object(P.a)(Object(P.a)({},tn),{},{codeExt:[]})},sd=Object(Ci.a)((function(e){return{spacer:{flexGrow:1},actionBox:{paddingTop:e.spacing(.5),display:"flex",flexDirection:"row",alignItems:"center"},optionsBox:{paddingTop:e.spacing(2)},actionButton:{marginRight:e.spacing(1)},error:{fontSize:"small"}}})),ld=function(e){var t=e.open,n=e.closeDialog,r=e.userPlacesFormatName,i=e.userPlacesFormatOptions,o=e.updateSettings,c=e.addUserPlacesFromText,s=e.nextMapInteraction,l=e.setMapInteraction,u=a.useState(""),d=Object(G.a)(u,2),p=d[0],m=d[1],f=a.useState(null),h=Object(G.a)(f,2),b=h[0],g=h[1],j=a.useState(!1),O=Object(G.a)(j,2),x=O[0],y=O[1],w=a.useState(!1),S=Object(G.a)(w,2),T=S[0],k=S[1],E=a.useState(r),C=Object(G.a)(E,2),I=C[0],_=C[1],N=a.useState(i),M=Object(G.a)(N,2),A=M[0],R=M[1],L=sd();if(a.useEffect((function(){_(r)}),[r]),a.useEffect((function(){R(i)}),[i]),!t)return null;var D,z=function(){l(s),n("addUserPlacesFromText")},B=function(){console.info("PASTE!",p)};return D="csv"===I?Object(He.jsx)(rd,{options:A.csv,updateOptions:function(e){R(Object(P.a)(Object(P.a)({},A),{},{csv:Object(P.a)(Object(P.a)({},A.csv),e)}))},className:L.optionsBox}):"geojson"===I?Object(He.jsx)(nd,{options:A.geojson,updateOptions:function(e){R(Object(P.a)(Object(P.a)({},A),{},{geojson:Object(P.a)(Object(P.a)({},A.geojson),e)}))},className:L.optionsBox}):Object(He.jsx)(od,{options:A.wkt,updateOptions:function(e){R(Object(P.a)(Object(P.a)({},A),{},{wkt:Object(P.a)(Object(P.a)({},A.wkt),e)}))},className:L.optionsBox}),Object(He.jsxs)(ui.a,{fullWidth:!0,open:t,onClose:z,"aria-labelledby":"server-dialog-title",children:[Object(He.jsx)(mi.a,{id:"server-dialog-title",children:v.get("Import places")}),Object(He.jsxs)(pi.a,{dividers:!0,children:[Object(He.jsxs)(Mu.a,{row:!0,value:I,onChange:function(e){return function(e){_(e.target.value)}(e)},children:[Object(He.jsx)($i.a,{value:"csv",label:v.get(Wt.name),control:Object(He.jsx)(Nu.a,{})},"csv"),Object(He.jsx)($i.a,{value:"geojson",label:v.get(Xt.name),control:Object(He.jsx)(Nu.a,{})},"geojson"),Object(He.jsx)($i.a,{value:"wkt",label:v.get(tn.name),control:Object(He.jsx)(Nu.a,{})},"wkt")]}),Object(He.jsx)(yl.a,{theme:he.instance.branding.themeName||"light",placeholder:v.get("Enter text or drag & drop a text file."),autoFocus:!0,height:"400px",extensions:cd[I].codeExt,value:p,onChange:function(e){var t=I;""===p&&e.length>10&&(t=zt(e),_(t)),m(e),g(cd[t].checkError(e))},onDrop:function(){m("")},onPaste:B,onPasteCapture:B}),b&&Object(He.jsx)(Kr.a,{color:"error",className:L.error,children:b}),Object(He.jsxs)("div",{className:L.actionBox,children:[Object(He.jsx)(Xu,{title:v.get("From File")+"...",accept:cd[I].fileExt,multiple:!1,onSelect:function(e){var t=e[0];y(!0);var n=new FileReader;n.onloadend=function(){var e=n.result;_(zt(e)),m(e),y(!1)},n.onabort=n.onerror=function(){y(!1)},n.readAsText(t,"UTF-8")},disabled:x,className:L.actionButton}),Object(He.jsx)(si.a,{onClick:function(){m("")},disabled:""===p.trim()||x,className:L.actionButton,variant:"outlined",size:"small",children:v.get("Clear")}),Object(He.jsx)(Ui.a,{className:L.spacer}),Object(He.jsx)(si.a,{onClick:function(){return k(!T)},endIcon:T?Object(He.jsx)(qu.a,{}):Object(He.jsx)(Zu.a,{}),variant:"outlined",size:"small",children:v.get("Options")})]}),Object(He.jsx)(al.a,{in:T,timeout:"auto",unmountOnExit:!0,children:D})]}),Object(He.jsxs)(di.a,{children:[Object(He.jsx)(si.a,{onClick:z,variant:"text",children:v.get("Cancel")}),Object(He.jsx)(si.a,{onClick:function(){l("Select"),n("addUserPlacesFromText"),o({userPlacesFormatName:I,userPlacesFormatOptions:A}),c(p)},disabled:""===p.trim()||null!==b||x,color:"primary",variant:"text",children:v.get("OK")})]})]})},ud={closeDialog:Rr,updateSettings:Dr,setMapInteraction:vr,addUserPlacesFromText:Ia},dd=Object(o.b)((function(e){return{open:!!e.controlState.dialogOpen.addUserPlacesFromText,userPlacesFormatName:e.controlState.userPlacesFormatName,userPlacesFormatOptions:e.controlState.userPlacesFormatOptions,nextMapInteraction:e.controlState.lastMapInteraction}}),ud)(ld),pd=Object(o.b)((function(e){return{compact:he.instance.branding.compact}}),{})((function(e){var t=e.compact;return Object(He.jsx)(bu,{children:Object(He.jsx)(Br.a,{injectFirst:!0,children:Object(He.jsxs)(Vr.a,{theme:Object(zr.a)(Object(Gr.a)({typography:{fontSize:12,htmlFontSize:14},palette:{mode:he.instance.branding.themeName,primary:he.instance.branding.primaryColor,secondary:he.instance.branding.secondaryColor}})),children:[Object(He.jsx)(Fr.a,{}),!t&&Object(He.jsx)(Di,{}),Object(He.jsx)(ql,{}),Object(He.jsxs)(He.Fragment,{children:[Object(He.jsx)(au,{}),Object(He.jsx)(Su,{}),Object(He.jsx)(Gu,{}),Object(He.jsx)(Ku,{}),Object(He.jsx)(dd,{}),Object(He.jsx)(tu,{}),Object(He.jsx)(hu,{})]})]})})})}));function md(){var e=function(){var e=It(he.instance.name);if(e)try{return e.getObjectItem("userServers",[])}catch(t){console.warn("failed to load user servers: ".concat(t))}return[]}(),t=[Object(P.a)({},he.instance.server)];return e.forEach((function(e){t.find((function(t){return t.id===e.id}))||t.push(e)})),{serverInfo:null,datasets:[],colorBars:null,timeSeriesGroups:[],userPlaceGroups:[],userServers:t}}function fd(e,t){switch(void 0===e&&(e=md()),t.type){case Oa:return Object(P.a)(Object(P.a)({},e),{},{serverInfo:t.serverInfo});case Sa:return Object(P.a)(Object(P.a)({},e),{},{datasets:t.datasets});case Ha:var n=t.datasetId,a=t.variableName,r=t.colorBarMinMax,i=t.colorBarName,o=t.opacity;return hd(e,n,a,{colorBarMin:r[0],colorBarMax:r[1],colorBarName:i,opacity:o});case Za:return hd(e,t.datasetId,t.variableName,{volumeRenderMode:t.volumeRenderMode,volumeIsoThreshold:t.volumeIsoThreshold});case ka:var c=t.placeGroup,s=e.datasets.map((function(e){if(e.placeGroups){var t=e.placeGroups.findIndex((function(e){return e.id===c.id}));if(t>=0){var n=Object(k.a)(e.placeGroups);return n[t]=c,Object(P.a)(Object(P.a)({},e),{},{placeGroups:n})}}return e}));return Object(P.a)(Object(P.a)({},e),{},{datasets:s});case Ea:var l=t.placeGroupTitle,u={type:"Feature",id:t.id,properties:t.properties,geometry:t.geometry},d=e.userPlaceGroups,p=d.findIndex((function(e){return e.id===we}));if(p>=0){var m=d[p];return Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[].concat(Object(k.a)(d.slice(0,p)),[Object(P.a)(Object(P.a)({},m),{},{features:[].concat(Object(k.a)(m.features),[u])})],Object(k.a)(d.slice(p+1)))})}var f=Boolean(l)&&""!==l?l:v.get("My places");return Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[{type:"FeatureCollection",id:we,title:f,features:[u]}].concat(Object(k.a)(d))});case Ca:var h=t.placeGroups;return Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[].concat(Object(k.a)(e.userPlaceGroups),Object(k.a)(h))});case _a:var b=t.placeGroupId,g=t.newName,j=e.userPlaceGroups,O=j.findIndex((function(e){return e.id===b}));if(O>=0){var x=j[O];return Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[].concat(Object(k.a)(j.slice(0,O)),[Object(P.a)(Object(P.a)({},x),{},{title:g})],Object(k.a)(j.slice(O+1)))})}return e;case Na:var y=t.placeGroupId,w=t.placeId,S=t.newName,T=e.userPlaceGroups,E=T.findIndex((function(e){return e.id===y}));if(E>=0){var C=T[E],I=C.features,_=I.findIndex((function(e){return e.id===w}));if(_>=0){var N=I[_];return Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[].concat(Object(k.a)(T.slice(0,E)),[Object(P.a)(Object(P.a)({},C),{},{features:[].concat(Object(k.a)(I.slice(0,_)),[Object(P.a)(Object(P.a)({},N),{},{properties:Object(P.a)(Object(P.a)({},N.properties),{},{label:S})})],Object(k.a)(I.slice(_+1)))})],Object(k.a)(T.slice(E+1)))})}}return e;case Ma:var M=t.placeGroupId,A=t.placeId,R=e.userPlaceGroups,L=R.findIndex((function(e){return e.id===M}));if(L>=0){var D=R[L],z=D.features.findIndex((function(e){return e.id===A}));if(z>=0){var G=vd(e.timeSeriesGroups,[A]),B=e.timeSeriesGroups;return G.forEach((function(e){B=bd(B,e,"remove","append")})),Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[].concat(Object(k.a)(R.slice(0,L)),[Object(P.a)(Object(P.a)({},D),{},{features:[].concat(Object(k.a)(D.features.slice(0,z)),Object(k.a)(D.features.slice(z+1)))})],Object(k.a)(R.slice(L+1))),timeSeriesGroups:B})}}return e;case Aa:var V=t.placeGroupId,F=e.userPlaceGroups,U=F.findIndex((function(e){return e.id===V}));if(U>=0){var W=F[U].features.map((function(e){return e.id})),K=vd(e.timeSeriesGroups,W),H=e.timeSeriesGroups;return K.forEach((function(e){H=bd(H,e,"remove","append")})),Object(P.a)(Object(P.a)({},e),{},{userPlaceGroups:[].concat(Object(k.a)(F.slice(0,U)),Object(k.a)(F.slice(U+1))),timeSeriesGroups:H})}return e;case Ka:return Object(P.a)(Object(P.a)({},e),{},{colorBars:t.colorBars});case za:var Z=t.timeSeriesGroupId,Y=t.timeSeries,q=e.timeSeriesGroups,X=q.findIndex((function(e){return e.id===Z})),J=q[X],Q=Object(k.a)(q);return Q[X]=Object(P.a)(Object(P.a)({},J),{},{timeSeriesArray:[].concat(Object(k.a)(J.timeSeriesArray),[Y])}),Object(P.a)(Object(P.a)({},e),{},{timeSeriesGroups:Q});case Da:var $=t.timeSeries,ee=t.updateMode,te=t.dataMode,ne=bd(e.timeSeriesGroups,$,ee,te);return ne!==e.timeSeriesGroups?Object(P.a)(Object(P.a)({},e),{},{timeSeriesGroups:ne}):e;case Ga:var ae=e.timeSeriesGroups.findIndex((function(e){return e.id===t.groupId}));if(ae>=0){var re=Object(k.a)(e.timeSeriesGroups),ie=Object(P.a)({},re[ae]),oe=Object(k.a)(ie.timeSeriesArray);return oe.splice(t.index,1),ie.timeSeriesArray=oe,re[ae]=ie,Object(P.a)(Object(P.a)({},e),{},{timeSeriesGroups:re})}return e;case Ba:var ce=e.timeSeriesGroups.findIndex((function(e){return e.id===t.id}));if(ce>=0){var se=Object(k.a)(e.timeSeriesGroups);return se.splice(ce,1),Object(P.a)(Object(P.a)({},e),{},{timeSeriesGroups:se})}return e;case Va:return Object(P.a)(Object(P.a)({},e),{},{timeSeriesGroups:[]});case Fa:return e.userServers!==t.servers?(function(e){var t=It(he.instance.name);if(t)try{t.setObjectItem("userServers",e)}catch(n){console.warn("failed to store user servers: ".concat(n))}}(t.servers),Object(P.a)(Object(P.a)({},e),{},{userServers:t.servers})):e}return e}function hd(e,t,n,a){var r=e.datasets.findIndex((function(e){return e.id===t}));if(r>=0){var i=e.datasets[r],o=i.variables.findIndex((function(e){return e.name===n}));if(o>=0){var c=i.variables[o],s=e.datasets.slice(),l=i.variables.slice();return l[o]=Object(P.a)(Object(P.a)({},c),a),s[r]=Object(P.a)(Object(P.a)({},i),{},{variables:l}),Object(P.a)(Object(P.a)({},e),{},{datasets:s})}}return e}function bd(e,t,n,a){var r,i=t,o=e.findIndex((function(e){return e.variableUnits===i.source.variableUnits}));if(o>=0){var c,s=e[o],l=s.timeSeriesArray,u=l.findIndex((function(e){return e.source.datasetId===i.source.datasetId&&e.source.variableName===i.source.variableName&&e.source.placeId===i.source.placeId}));if(u>=0){var d=l[u];"append"===a&&(i=Object(P.a)(Object(P.a)({},i),{},{data:[].concat(Object(k.a)(i.data),Object(k.a)(d.data))})),"replace"===n?c=[i]:"add"===n?(c=l.slice())[u]=i:(c=l.slice()).splice(u,1)}else c="replace"===n?[i]:"add"===n?[i].concat(Object(k.a)(l)):l;"replace"===n?r=[Object(P.a)(Object(P.a)({},s),{},{timeSeriesArray:c})]:"add"===n||c.length>=0?(r=e.slice())[o]=Object(P.a)(Object(P.a)({},s),{},{timeSeriesArray:c}):(r=e.slice()).splice(o,1)}else{if("replace"===n)r=[{id:z("ts-"),variableUnits:i.source.variableUnits,timeSeriesArray:[i]}];else if("add"===n){r=[{id:z("ts-"),variableUnits:i.source.variableUnits,timeSeriesArray:[i]}].concat(Object(k.a)(e))}else r=e}return r}function vd(e,t){var n=[];return e.forEach((function(e){e.timeSeriesArray.forEach((function(e){t.forEach((function(t){e.source.placeId===t&&n.push(e)}))}))})),n}function gd(e,t,n){switch(void 0===e&&(e=cn()),t.type){case Lr:var a=Object(P.a)(Object(P.a)({},e),t.settings);return At(a),a;case Sa:var r=e.selectedDatasetId||fe.get("dataset"),i=e.selectedVariableName||fe.get("variable"),o=e.mapInteraction,c=M(t.datasets,r),s=c&&A(c,i)||null;return c?s||(i=c.variables.length?c.variables[0].name:null):(r=null,i=null,(c=t.datasets.length?t.datasets[0]:null)&&(r=c.id,c.variables.length>0&&(i=c.variables[0].name))),r||(o="Select"),Object(P.a)(Object(P.a)({},e),{},{selectedDatasetId:r,selectedVariableName:i,mapInteraction:o});case Ja:var l=e.selectedVariableName,u=M(t.datasets,t.selectedDatasetId);!A(u,l)&&u.variables.length>0&&(l=u.variables[0].name);var d=t.selectedDatasetId,p=L(u),m=p?p[1]:null;return Object(P.a)(Object(P.a)({},e),{},{selectedDatasetId:d,selectedVariableName:l,selectedTimeRange:p,selectedTime:m});case nr:var f=t.location;return e.flyTo!==f?Object(P.a)(Object(P.a)({},e),{},{flyTo:f}):e;case rr:var h=t.selectedPlaceGroupIds;return Object(P.a)(Object(P.a)({},e),{},{selectedPlaceGroupIds:h,selectedPlaceId:null});case ir:var b=t.placeId;return Object(P.a)(Object(P.a)({},e),{},{selectedPlaceId:b});case sr:return Object(P.a)(Object(P.a)({},e),{},{selectedVariableName:t.selectedVariableName});case cr:return Object(P.a)(Object(P.a)({},e),{},{showRgbLayer:t.showRgbLayer});case lr:var g=t.selectedTime;if(null!==g&&n){var j=Jn(n),O=j?ht(j,g):-1;O>=0&&(g=j[O])}return e.selectedTime!==g?Object(P.a)(Object(P.a)({},e),{},{selectedTime:g}):e;case dr:if(n){var x=Qn(n);if(x>=0){var y=Jn(n);(x+=t.increment)<0&&(x=y.length-1),x>y.length-1&&(x=0);var w=y[x],S=e.selectedTimeRange;if(null!==S&&(w<S[0]&&(w=S[0]),w>S[1]&&(w=S[1])),e.selectedTime!==w)return Object(P.a)(Object(P.a)({},e),{},{selectedTime:w})}}return e;case pr:return Object(P.a)(Object(P.a)({},e),{},{selectedTimeRange:t.selectedTimeRange});case fr:return Object(P.a)(Object(P.a)({},e),{},{timeSeriesUpdateMode:t.timeSeriesUpdateMode});case hr:return Object(P.a)(Object(P.a)({},e),{},{timeAnimationActive:t.timeAnimationActive,timeAnimationInterval:t.timeAnimationInterval});case Ea:var T=t.id;return t.selected?function(e,t,n){var a=e.selectedPlaceGroupIds;e.selectedPlaceGroupIds&&0!==e.selectedPlaceGroupIds.length?e.selectedPlaceGroupIds.find((function(e){return e===t}))||(a=[].concat(Object(k.a)(e.selectedPlaceGroupIds),[t])):a=[t];return Object(P.a)(Object(P.a)({},e),{},{selectedPlaceGroupIds:a,selectedPlaceId:n})}(e,we,T):e;case Ca:var E=t.placeGroups;return E.length>0?Object(P.a)(Object(P.a)({},e),{},{selectedPlaceGroupIds:[].concat(Object(k.a)(e.selectedPlaceGroupIds||[]),[E[0].id])}):e;case _a:var C=t.placeGroupId,I=t.newName;return C===we?Object(P.a)(Object(P.a)({},e),{},{userDrawnPlaceGroupName:I}):e;case Ma:var _=t.placeId,N=t.places;if(_===e.selectedPlaceId){var R=null,D=N.findIndex((function(e){return e.id===_}));return D>=0&&(D<N.length-1?R=N[D+1].id:D>0&&(R=N[D-1].id)),Object(P.a)(Object(P.a)({},e),{},{selectedPlaceId:R})}return e;case br:var z=Object(P.a)(Object(P.a)({},e),{},{mapInteraction:t.mapInteraction,lastMapInteraction:e.mapInteraction});return"Geometry"===t.mapInteraction&&(z=Object(P.a)(Object(P.a)({},z),{},{dialogOpen:Object(P.a)(Object(P.a)({},e.dialogOpen),{},{addUserPlacesFromText:!0})})),z;case gr:return At(e=Object(P.a)(Object(P.a)({},e),{},{volumeCardOpen:t.volumeCardOpen})),e;case Or:return At(e=Object(P.a)(Object(P.a)({},e),{},{volumeRenderMode:t.volumeRenderMode})),e;case xr:var G=t.volumeId,B=t.volumeState;return e=Object(P.a)(Object(P.a)({},e),{},{volumeStates:Object(P.a)(Object(P.a)({},e.volumeStates),{},Object(vt.a)({},G,B))});case yr:return At(e=Object(P.a)(Object(P.a)({},e),{},{infoCardOpen:t.infoCardOpen})),e;case Sr:var V=Object(P.a)({},e.infoCardElementStates);return Object.getOwnPropertyNames(V).forEach((function(e){V[e]=Object(P.a)(Object(P.a)({},V[e]),{},{visible:t.visibleElements.includes(e)})})),At(e=Object(P.a)(Object(P.a)({},e),{},{infoCardElementStates:V})),e;case Tr:var F=t.elementType,U=t.viewMode,W=Object(P.a)(Object(P.a)({},e),{},{infoCardElementStates:Object(P.a)(Object(P.a)({},e.infoCardElementStates),{},Object(vt.a)({},F,Object(P.a)(Object(P.a)({},e.infoCardElementStates[F]),{},{viewMode:U})))});return At(W),W;case Pr:return Object(P.a)(Object(P.a)({},e),{},{activities:Object(P.a)(Object(P.a)({},e.activities),{},Object(vt.a)({},t.id,t.message))});case Er:var K=Object(P.a)({},e.activities);return delete K[t.id],Object(P.a)(Object(P.a)({},e),{},{activities:K});case Ir:var H=t.locale;return v.locale=H,H!==e.locale&&At(e=Object(P.a)(Object(P.a)({},e),{},{locale:H})),e;case Nr:var Z=t.dialogId;return Object(P.a)(Object(P.a)({},e),{},{dialogOpen:Object(P.a)(Object(P.a)({},e.dialogOpen),{},Object(vt.a)({},Z,!0))});case Ar:var Y=t.dialogId;return Object(P.a)(Object(P.a)({},e),{},{dialogOpen:Object(P.a)(Object(P.a)({},e.dialogOpen),{},Object(vt.a)({},Y,!1))});case Fa:if(e.selectedServerId!==t.selectedServerId)return Object(P.a)(Object(P.a)({},e),{},{selectedServerId:t.selectedServerId})}return e}var jd=0;function Od(e,t){void 0===e&&(e={newEntries:[],oldEntries:[]});var n=e.newEntries;switch(t.type){case ha:var a=t.messageType,r=t.messageText,i=n.length?n[0]:null;return i&&a===i.type&&r===i.text?e:(i={id:++jd,type:a,text:r},Object(P.a)(Object(P.a)({},e),{},{newEntries:[i].concat(Object(k.a)(n))}));case va:var o=n.findIndex((function(e){return e.id===t.messageId}));if(o>=0){var c=n[o],s=Object(k.a)(n);s.splice(o,1);var l=[c].concat(Object(k.a)(e.oldEntries));return Object(P.a)(Object(P.a)({},e),{},{newEntries:s,oldEntries:l})}}return e}function xd(e,t){return void 0===e&&(e={accessToken:null}),t.type===Ti?Object(P.a)(Object(P.a)({},e),{},{accessToken:t.accessToken}):e}function yd(e,t){return{dataState:fd(e&&e.dataState,t),controlState:gd(e&&e.controlState,t,e),messageLogState:Od(e&&e.messageLogState,t),userAuthState:xd(e&&e.userAuthState,t)}}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));he.load().then((function(){var e=s.createLogger({collapsed:!0,diff:!1}),t=c.b(yd,c.a(l.a,e));t.dispatch(_r(t.getState().controlState.locale)),t.getState().controlState.privacyNoticeAccepted&&t.dispatch(Wa()),i.render(Object(He.jsx)(o.a,{store:t,children:Object(He.jsx)(pd,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}))}},[[959,1,2]]]);
//# sourceMappingURL=main.fb983784.chunk.js.map